2025-12-19 00:00:01.240 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=icisa13w
2025-12-19 00:00:01.240 [clientInboundChannel-33] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-usericisa13w subscriptionId=sub-0 session=icisa13w user=87d918942a5a4ef2a79e4cd41d36154b payload=byte[0]
2025-12-19 00:00:03.741 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:08.745 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:13.754 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:14.003 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=l14xeid2] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:00:14.003 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=icisa13w] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:00:14.003 [clientInboundChannel-38] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=l14xeid2
2025-12-19 00:00:14.005 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session l14xeid2
2025-12-19 00:00:14.005 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session icisa13w
2025-12-19 00:00:14.005 [clientInboundChannel-41] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=icisa13w
2025-12-19 00:00:14.005 [clientInboundChannel-13] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=icisa13w
2025-12-19 00:00:14.005 [clientOutboundChannel-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpHeartbeat=[J@a04aa40, simpUser=02c321239f6b48199fa6e8ac1abb6c17, simpSessionId=l14xeid2}], simpUser=02c321239f6b48199fa6e8ac1abb6c17, simpSessionId=l14xeid2}]
2025-12-19 00:00:14.006 [clientInboundChannel-44] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=l14xeid2
2025-12-19 00:00:14.006 [clientOutboundChannel-10] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpHeartbeat=[J@3bfe0e3c, simpUser=87d918942a5a4ef2a79e4cd41d36154b, simpSessionId=icisa13w}], simpUser=87d918942a5a4ef2a79e4cd41d36154b, simpSessionId=icisa13w}]
2025-12-19 00:00:14.007 [clientOutboundChannel-11] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=87d918942a5a4ef2a79e4cd41d36154b, simpSessionId=icisa13w}], simpUser=87d918942a5a4ef2a79e4cd41d36154b, simpSessionId=icisa13w}]
2025-12-19 00:00:14.007 [clientOutboundChannel-12] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=02c321239f6b48199fa6e8ac1abb6c17, simpSessionId=l14xeid2}], simpUser=02c321239f6b48199fa6e8ac1abb6c17, simpSessionId=l14xeid2}]
2025-12-19 00:00:18.774 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:22.446 [MessageBroker-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [icisa13w, l14xeid2]
2025-12-19 00:00:23.788 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:28.806 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:33.810 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:38.828 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:43.843 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:48.849 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:53.856 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:00:58.860 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:01:03.869 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:04:41.438 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 38388 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:04:41.453 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:04:41.454 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:04:42.356 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:04:42.360 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:04:42.390 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 12 ms. Found 0 Redis repository interfaces.
2025-12-19 00:04:43.025 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:04:43.038 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:04:43.039 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:04:43.040 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:04:43.201 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:04:43.201 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1640 ms
2025-12-19 00:04:44.351 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:04:44.475 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:04:44.480 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:04:44.481 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:04:44.487 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:04:44.733 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:04:45.393 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:04:45.437 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:04:45.440 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:04:45.440 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:04:45.441 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:04:45.441 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@166ce247]
2025-12-19 00:04:45.441 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@166ce247]
2025-12-19 00:04:45.442 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@166ce247]]
2025-12-19 00:04:45.443 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:04:45.443 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:04:45.443 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:04:45.549 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 00:04:45.549 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 00:04:45.550 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 00:04:46.270 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:04:48.968 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1118d539
2025-12-19 00:04:48.972 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:04:48.991 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1118d539
2025-12-19 00:04:48.994 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/732/1bxsdo3t/websocket
2025-12-19 00:04:49.001 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: f9ae42dbd5534c5f90533968df742dfd
2025-12-19 00:04:49.073 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=1bxsdo3t]
2025-12-19 00:04:49.124 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=f9ae42dbd5534c5f90533968df742dfd session=1bxsdo3t
2025-12-19 00:04:50.450 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 00:04:50.524 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#486e9d1d:0/SimpleConnection@467af68c [delegate=amqp://guest@127.0.0.1:5672/, localPort= 60231]
2025-12-19 00:04:50.622 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 9.735 seconds (JVM running for 10.193)
2025-12-19 00:04:51.152 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1118d539
2025-12-19 00:04:51.153 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:04:51.160 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1118d539
2025-12-19 00:04:51.161 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/603/3z05fbnz/websocket
2025-12-19 00:04:51.162 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: a9271ae341d34dee8ddca9fc0c34563f
2025-12-19 00:04:51.165 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=3z05fbnz]
2025-12-19 00:04:51.168 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=a9271ae341d34dee8ddca9fc0c34563f session=3z05fbnz
2025-12-19 00:04:51.286 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:04:53.190 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=3z05fbnz
2025-12-19 00:04:53.192 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-user3z05fbnz subscriptionId=sub-0 session=3z05fbnz user=a9271ae341d34dee8ddca9fc0c34563f payload=byte[0]
2025-12-19 00:04:56.318 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:01.340 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:05.951 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=1bxsdo3t] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:05:05.951 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=1bxsdo3t
2025-12-19 00:05:05.951 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=3z05fbnz] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:05:05.952 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=3z05fbnz
2025-12-19 00:05:05.952 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 1bxsdo3t
2025-12-19 00:05:05.952 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 3z05fbnz
2025-12-19 00:05:05.953 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@53813bbe, simpUser=f9ae42dbd5534c5f90533968df742dfd, simpSessionId=1bxsdo3t}], simpUser=f9ae42dbd5534c5f90533968df742dfd, simpSessionId=1bxsdo3t}]
2025-12-19 00:05:05.953 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@5447f969, simpUser=a9271ae341d34dee8ddca9fc0c34563f, simpSessionId=3z05fbnz}], simpUser=a9271ae341d34dee8ddca9fc0c34563f, simpSessionId=3z05fbnz}]
2025-12-19 00:05:05.954 [clientInboundChannel-22] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=3z05fbnz
2025-12-19 00:05:05.954 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=1bxsdo3t
2025-12-19 00:05:05.955 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=f9ae42dbd5534c5f90533968df742dfd, simpSessionId=1bxsdo3t}], simpUser=f9ae42dbd5534c5f90533968df742dfd, simpSessionId=1bxsdo3t}]
2025-12-19 00:05:05.955 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=a9271ae341d34dee8ddca9fc0c34563f, simpSessionId=3z05fbnz}], simpUser=a9271ae341d34dee8ddca9fc0c34563f, simpSessionId=3z05fbnz}]
2025-12-19 00:05:06.359 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:11.372 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:13.998 [MessageBroker-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [3z05fbnz, 1bxsdo3t]
2025-12-19 00:05:16.392 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:21.412 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:26.438 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:31.450 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:36.466 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:41.479 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:44.377 [MessageBroker-11] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 12]
2025-12-19 00:05:46.501 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:51.519 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:05:56.539 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:01.562 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:06.570 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:11.586 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:16.601 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:21.620 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:26.630 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:31.640 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:36.649 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:41.662 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:46.680 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:51.692 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:06:56.701 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:01.714 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:06.722 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:11.734 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:16.740 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:21.755 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:26.763 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:31.783 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:36.787 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:41.801 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:46.817 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:51.829 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:07:56.836 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:01.842 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:06.849 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:11.862 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:16.878 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:21.893 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:26.902 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:31.914 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:36.930 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:41.940 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:46.960 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:51.979 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:08:56.989 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:09:02.002 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:09:07.014 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:09:12.022 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:09:17.036 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:09:22.045 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:09:27.057 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:11:49.522 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 45984 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:11:49.533 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:11:49.533 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:11:50.361 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:11:50.364 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:11:50.401 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2025-12-19 00:11:50.955 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:11:50.963 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:11:50.964 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:11:50.964 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:11:51.030 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:11:51.030 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1341 ms
2025-12-19 00:11:51.898 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:11:51.992 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:11:51.995 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:11:51.996 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:11:52.000 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:11:52.023 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 00:11:52.142 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:11:52.606 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:11:52.635 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:11:52.638 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:11:52.639 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:11:52.639 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:11:52.640 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@cdbe995]
2025-12-19 00:11:52.640 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@cdbe995]
2025-12-19 00:11:52.641 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@cdbe995]]
2025-12-19 00:11:52.641 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:11:52.641 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:11:52.641 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:11:53.174 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:11:54.362 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 00:11:54.363 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 00:11:54.364 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 00:11:57.646 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 00:11:57.726 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6aa5974e:0/SimpleConnection@65e620b0 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 49766]
2025-12-19 00:11:57.824 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 8.86 seconds (JVM running for 9.279)
2025-12-19 00:11:58.199 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:12:03.224 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:12:08.246 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:12:13.272 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:12:18.298 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:12:23.323 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:12:28.337 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:12:33.350 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:12:38.375 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:12:43.383 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:13:25.067 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 29004 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:13:25.076 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:13:25.076 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:13:25.568 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:13:25.571 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:13:25.588 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-12-19 00:13:26.025 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:13:26.036 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:13:26.037 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:13:26.037 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:13:26.103 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:13:26.104 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 967 ms
2025-12-19 00:13:26.695 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:13:26.764 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:13:26.766 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:13:26.766 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:13:26.770 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:13:26.787 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 00:13:26.872 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:13:27.166 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:13:27.186 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:13:27.187 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:13:27.187 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:13:27.187 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:13:27.187 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@cdbe995]
2025-12-19 00:13:27.189 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@cdbe995]
2025-12-19 00:13:27.189 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@cdbe995]]
2025-12-19 00:13:27.189 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:13:27.189 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:13:27.189 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:13:27.439 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 00:13:27.439 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 00:13:27.440 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 00:13:27.539 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:13:32.205 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 00:13:32.246 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6aa5974e:0/SimpleConnection@65e620b0 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 62714]
2025-12-19 00:13:32.305 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.667 seconds (JVM running for 7.967)
2025-12-19 00:13:32.556 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:13:35.374 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@601d6622
2025-12-19 00:13:35.379 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:13:35.394 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@601d6622
2025-12-19 00:13:35.396 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/901/21kpjasu/websocket
2025-12-19 00:13:35.399 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 48557a70ca934ea7914156da717ef7d9
2025-12-19 00:13:35.478 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=21kpjasu]
2025-12-19 00:13:35.523 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=48557a70ca934ea7914156da717ef7d9 session=21kpjasu
2025-12-19 00:13:37.563 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@601d6622
2025-12-19 00:13:37.565 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:13:37.596 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@601d6622
2025-12-19 00:13:37.598 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/635/thtk3t1h/websocket
2025-12-19 00:13:37.599 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 8bd78f96c3124b8ab09fffed4d06f6bd
2025-12-19 00:13:37.608 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:13:37.612 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=thtk3t1h]
2025-12-19 00:13:37.616 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=8bd78f96c3124b8ab09fffed4d06f6bd session=thtk3t1h
2025-12-19 00:13:39.645 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=thtk3t1h
2025-12-19 00:13:39.646 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userthtk3t1h subscriptionId=sub-0 session=thtk3t1h user=8bd78f96c3124b8ab09fffed4d06f6bd payload=byte[0]
2025-12-19 00:13:42.623 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:13:47.637 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:13:52.657 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:13:55.428 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=21kpjasu] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:13:55.428 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=21kpjasu
2025-12-19 00:13:55.428 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=thtk3t1h] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:13:55.428 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 21kpjasu
2025-12-19 00:13:55.429 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=thtk3t1h
2025-12-19 00:13:55.429 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session thtk3t1h
2025-12-19 00:13:55.429 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@5447f969, simpUser=48557a70ca934ea7914156da717ef7d9, simpSessionId=21kpjasu}], simpUser=48557a70ca934ea7914156da717ef7d9, simpSessionId=21kpjasu}]
2025-12-19 00:13:55.429 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@2282af81, simpUser=8bd78f96c3124b8ab09fffed4d06f6bd, simpSessionId=thtk3t1h}], simpUser=8bd78f96c3124b8ab09fffed4d06f6bd, simpSessionId=thtk3t1h}]
2025-12-19 00:13:55.430 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=21kpjasu
2025-12-19 00:13:55.430 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=thtk3t1h
2025-12-19 00:13:55.430 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=48557a70ca934ea7914156da717ef7d9, simpSessionId=21kpjasu}], simpUser=48557a70ca934ea7914156da717ef7d9, simpSessionId=21kpjasu}]
2025-12-19 00:13:55.431 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=8bd78f96c3124b8ab09fffed4d06f6bd, simpSessionId=thtk3t1h}], simpUser=8bd78f96c3124b8ab09fffed4d06f6bd, simpSessionId=thtk3t1h}]
2025-12-19 00:13:57.674 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:14:02.686 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:14:05.398 [MessageBroker-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [21kpjasu, thtk3t1h]
2025-12-19 00:14:07.708 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:14:12.730 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:14:17.752 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:14:22.759 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:14:26.705 [MessageBroker-8] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 11]
2025-12-19 00:14:27.770 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:14:32.781 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:14:37.796 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:14:42.813 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:14:47.828 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:15:17.700 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 6088 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:15:17.712 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:15:17.712 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:15:18.462 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:15:18.473 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:15:18.516 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
2025-12-19 00:15:19.287 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:15:19.297 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:15:19.298 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:15:19.299 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:15:19.396 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:15:19.397 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1585 ms
2025-12-19 00:15:20.693 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:15:20.927 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:15:20.930 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:15:20.931 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:15:20.940 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:15:20.987 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 00:15:21.207 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:15:22.069 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:15:22.108 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:15:22.110 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:15:22.112 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:15:22.112 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:15:22.113 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@726a8729]
2025-12-19 00:15:22.113 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@726a8729]
2025-12-19 00:15:22.113 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@726a8729]]
2025-12-19 00:15:22.114 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:15:22.114 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:15:22.114 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:15:22.973 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:15:24.294 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 00:15:24.295 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 00:15:24.297 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 00:15:27.117 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 00:15:27.198 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#402f8592:0/SimpleConnection@7ea3839e [delegate=amqp://guest@127.0.0.1:5672/, localPort= 59292]
2025-12-19 00:15:27.276 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 10.19 seconds (JVM running for 10.749)
2025-12-19 00:15:27.996 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:15:32.866 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 00:15:32.870 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:15:32.884 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 00:15:32.885 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/502/l0favmtx/websocket
2025-12-19 00:15:32.891 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 30d5f60a058b4d22ac73087b0fc51431
2025-12-19 00:15:32.954 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=l0favmtx]
2025-12-19 00:15:32.991 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:15:32.992 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:15:32.992 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:15:32.993 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: l0favmtx
2025-12-19 00:15:32.993 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 30d5f60a058b4d22ac73087b0fc51431
2025-12-19 00:15:32.995 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=30d5f60a058b4d22ac73087b0fc51431 session=l0favmtx
2025-12-19 00:15:33.010 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:15:35.036 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 00:15:35.037 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:15:35.044 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 00:15:35.045 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/688/llwiug04/websocket
2025-12-19 00:15:35.045 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 91b86ed5c4d943729cc64c9df74f2a5b
2025-12-19 00:15:35.048 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=llwiug04]
2025-12-19 00:15:35.052 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:15:35.053 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:15:35.053 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:15:35.053 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: llwiug04
2025-12-19 00:15:35.054 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 91b86ed5c4d943729cc64c9df74f2a5b
2025-12-19 00:15:35.055 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=91b86ed5c4d943729cc64c9df74f2a5b session=llwiug04
2025-12-19 00:15:37.084 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:15:37.086 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 00:15:37.086 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 00:15:37.086 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: llwiug04
2025-12-19 00:15:37.086 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 91b86ed5c4d943729cc64c9df74f2a5b
2025-12-19 00:15:37.086 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=llwiug04
2025-12-19 00:15:37.088 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userllwiug04 subscriptionId=sub-0 session=llwiug04 user=91b86ed5c4d943729cc64c9df74f2a5b payload=byte[0]
2025-12-19 00:15:38.026 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:15:40.632 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:15:40.633 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 00:15:40.633 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 00:15:40.633 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: l0favmtx
2025-12-19 00:15:40.634 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 30d5f60a058b4d22ac73087b0fc51431
2025-12-19 00:15:40.634 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 50, 58, 49, 53, 58, 52, 48, 34, 44, 34, 105, 100, 34, 58, 34, 57, 49, 98, 56, 54, 101, 100, 53, 99, 52, 100, 57, 52, 51, 55, 50, 57, 99, 99, 54, 52, 99, 57, 100, 102, 55, 52, 102, 50, 97, 53, 98, 34, 125]
2025-12-19 00:15:40.635 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[83]}, simpSessionAttributes={}, simpHeartbeat=[J@2794f433, simpUser=30d5f60a058b4d22ac73087b0fc51431, simpSessionId=l0favmtx, simpDestination=/ws/privateMessage}
2025-12-19 00:15:43.044 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:15:48.056 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:15:52.828 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:15:52.828 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:15:52.829 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:15:52.829 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:15:52.830 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: l0favmtx
2025-12-19 00:15:52.830 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 30d5f60a058b4d22ac73087b0fc51431
2025-12-19 00:15:52.830 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:15:52.831 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:15:52.831 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: llwiug04
2025-12-19 00:15:52.831 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 91b86ed5c4d943729cc64c9df74f2a5b
2025-12-19 00:15:52.831 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=l0favmtx
2025-12-19 00:15:52.832 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=llwiug04] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:15:52.832 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=l0favmtx] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:15:52.833 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session l0favmtx
2025-12-19 00:15:52.833 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session llwiug04
2025-12-19 00:15:52.833 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:15:52.834 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:15:52.834 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@1ef20600, simpUser=30d5f60a058b4d22ac73087b0fc51431, simpSessionId=l0favmtx}], simpUser=30d5f60a058b4d22ac73087b0fc51431, simpSessionId=l0favmtx}]
2025-12-19 00:15:52.833 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=llwiug04
2025-12-19 00:15:52.833 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:15:52.834 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:15:52.835 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:15:52.835 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: llwiug04
2025-12-19 00:15:52.834 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:15:52.835 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 91b86ed5c4d943729cc64c9df74f2a5b
2025-12-19 00:15:52.835 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: l0favmtx
2025-12-19 00:15:52.835 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@649a7078, simpUser=91b86ed5c4d943729cc64c9df74f2a5b, simpSessionId=llwiug04}], simpUser=91b86ed5c4d943729cc64c9df74f2a5b, simpSessionId=llwiug04}]
2025-12-19 00:15:52.835 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 30d5f60a058b4d22ac73087b0fc51431
2025-12-19 00:15:52.836 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=llwiug04
2025-12-19 00:15:52.836 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=l0favmtx
2025-12-19 00:15:52.837 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=91b86ed5c4d943729cc64c9df74f2a5b, simpSessionId=llwiug04}], simpUser=91b86ed5c4d943729cc64c9df74f2a5b, simpSessionId=llwiug04}]
2025-12-19 00:15:52.837 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=30d5f60a058b4d22ac73087b0fc51431, simpSessionId=l0favmtx}], simpUser=30d5f60a058b4d22ac73087b0fc51431, simpSessionId=l0favmtx}]
2025-12-19 00:15:53.071 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:15:57.901 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [llwiug04, l0favmtx]
2025-12-19 00:15:58.093 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:16:03.104 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:16:08.126 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:16:13.136 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:16:18.153 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:16:20.728 [MessageBroker-11] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 10]
2025-12-19 00:16:23.179 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:16:28.195 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:16:33.211 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:16:38.226 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:16:43.237 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:16:48.255 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:17:13.380 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 46880 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:17:13.394 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:17:13.394 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:17:14.369 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:17:14.373 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:17:14.416 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2025-12-19 00:17:15.355 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:17:15.373 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:17:15.374 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:17:15.374 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:17:15.514 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:17:15.514 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2018 ms
2025-12-19 00:17:16.594 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:17:16.773 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:17:16.776 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:17:16.776 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:17:16.784 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:17:16.817 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 00:17:17.009 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:17:17.800 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:17:17.839 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:17:17.841 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:17:17.842 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:17:17.843 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:17:17.843 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]
2025-12-19 00:17:17.843 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]
2025-12-19 00:17:17.844 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]]
2025-12-19 00:17:17.844 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:17:17.844 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:17:17.845 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:17:18.587 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:17:20.520 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 00:17:20.521 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 00:17:20.523 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-12-19 00:17:22.851 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 00:17:22.958 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#61b65d54:0/SimpleConnection@16b76858 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 65302]
2025-12-19 00:17:23.066 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 10.378 seconds (JVM running for 11.006)
2025-12-19 00:17:23.599 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:17:25.907 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 00:17:25.911 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:17:25.928 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 00:17:25.934 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/321/5dywnndd/websocket
2025-12-19 00:17:25.945 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 1ae577eb2c65410a8a33de6c3ab50753
2025-12-19 00:17:26.034 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=5dywnndd]
2025-12-19 00:17:26.080 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:17:26.080 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:17:26.081 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:17:26.081 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 5dywnndd
2025-12-19 00:17:26.081 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 1ae577eb2c65410a8a33de6c3ab50753
2025-12-19 00:17:26.085 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=1ae577eb2c65410a8a33de6c3ab50753 session=5dywnndd
2025-12-19 00:17:28.118 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 00:17:28.118 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:17:28.124 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 00:17:28.125 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/129/zw2sld5w/websocket
2025-12-19 00:17:28.125 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: cc52ff783b7d4602b7ed7a1208d7178f
2025-12-19 00:17:28.128 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=zw2sld5w]
2025-12-19 00:17:28.131 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:17:28.131 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:17:28.132 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:17:28.132 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: zw2sld5w
2025-12-19 00:17:28.132 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: cc52ff783b7d4602b7ed7a1208d7178f
2025-12-19 00:17:28.133 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=cc52ff783b7d4602b7ed7a1208d7178f session=zw2sld5w
2025-12-19 00:17:28.615 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:17:30.161 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:17:30.164 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 00:17:30.166 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 00:17:30.166 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: zw2sld5w
2025-12-19 00:17:30.166 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: cc52ff783b7d4602b7ed7a1208d7178f
2025-12-19 00:17:30.167 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=zw2sld5w
2025-12-19 00:17:30.169 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userzw2sld5w subscriptionId=sub-0 session=zw2sld5w user=cc52ff783b7d4602b7ed7a1208d7178f payload=byte[0]
2025-12-19 00:17:33.629 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:17:33.714 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:17:33.715 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 00:17:33.718 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 00:17:33.718 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 5dywnndd
2025-12-19 00:17:33.719 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 1ae577eb2c65410a8a33de6c3ab50753
2025-12-19 00:17:33.719 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 50, 58, 49, 55, 58, 51, 51, 34, 44, 34, 105, 100, 34, 58, 34, 99, 99, 53, 50, 102, 102, 55, 56, 51, 98, 55, 100, 52, 54, 48, 50, 98, 55, 101, 100, 55, 97, 49, 50, 48, 56, 100, 55, 49, 55, 56, 102, 34, 125]
2025-12-19 00:17:33.720 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[83]}, simpSessionAttributes={}, simpHeartbeat=[J@59faaf3b, simpUser=1ae577eb2c65410a8a33de6c3ab50753, simpSessionId=5dywnndd, simpDestination=/ws/privateMessage}
2025-12-19 00:17:38.644 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:17:43.656 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:17:45.944 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:17:45.945 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:17:45.945 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:17:45.946 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:17:45.946 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:17:45.947 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:17:45.947 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: zw2sld5w
2025-12-19 00:17:45.947 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 5dywnndd
2025-12-19 00:17:45.947 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: cc52ff783b7d4602b7ed7a1208d7178f
2025-12-19 00:17:45.947 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 1ae577eb2c65410a8a33de6c3ab50753
2025-12-19 00:17:45.949 [clientInboundChannel-16] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=5dywnndd
2025-12-19 00:17:45.950 [clientInboundChannel-15] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=zw2sld5w
2025-12-19 00:17:45.952 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=5dywnndd]
java.net.SocketException: Connection reset
	at java.base/sun.nio.ch.SocketChannelImpl.throwConnectionReset(SocketChannelImpl.java:394)
	at java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:426)
	at org.apache.tomcat.util.net.NioChannel.read(NioChannel.java:160)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1316)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1206)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:75)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:183)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:162)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:157)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:59)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:895)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1722)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 00:17:45.952 [clientOutboundChannel-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=5dywnndd]
java.io.IOException: java.io.IOException: Connection reset by peer
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:327)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:262)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:816)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:704)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:325)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:254)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:227)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:49)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:215)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:106)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:224)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:326)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:213)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:170)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.io.IOException: Connection reset by peer
	at java.base/sun.nio.ch.SocketDispatcher.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:58)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:217)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:153)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:563)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:147)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1614)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:1061)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1480)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1406)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1377)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:93)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:512)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	... 18 common frames omitted
2025-12-19 00:17:45.953 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=zw2sld5w]
java.io.IOException: java.io.IOException: Connection reset by peer
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:327)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:262)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:816)
	at org.apache.tomcat.websocket.WsSession.onClose(WsSession.java:739)
	at org.apache.tomcat.websocket.WsFrameBase.processDataControl(WsFrameBase.java:367)
	at org.apache.tomcat.websocket.WsFrameBase.processData(WsFrameBase.java:296)
	at org.apache.tomcat.websocket.WsFrameBase.processInputBuffer(WsFrameBase.java:133)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:85)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:183)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:162)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:157)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:59)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:895)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1722)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.io.IOException: Connection reset by peer
	at java.base/sun.nio.ch.SocketDispatcher.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:58)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:217)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:153)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:563)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:147)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1614)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:1061)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1480)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1406)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1377)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:93)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:512)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	... 19 common frames omitted
2025-12-19 00:17:45.954 [clientOutboundChannel-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=5dywnndd] closed with CloseStatus[code=1006, reason=Connection reset by peer]
2025-12-19 00:17:45.955 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=zw2sld5w] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:17:45.956 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 5dywnndd
2025-12-19 00:17:45.956 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session zw2sld5w
2025-12-19 00:17:45.956 [clientOutboundChannel-4] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Terminating connection after failure to send message to client
java.lang.IllegalStateException: Message will not be sent because the WebSocket session has been closed
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:442)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:254)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:227)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:49)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:215)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:106)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:224)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:326)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:213)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:170)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 00:17:45.957 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:17:45.957 [clientOutboundChannel-4] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session zw2sld5w
org.springframework.web.socket.sockjs.SockJsTransportFailureException: Failed to write SockJsFrame content='a["ERROR\nmessage:Session closed.\ncontent-length:0\n\n\u0000"]'; nested exception is java.lang.IllegalStateException: Message will not be sent because the WebSocket session has been closed
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:343)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:213)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:170)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.IllegalStateException: Message will not be sent because the WebSocket session has been closed
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:442)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:254)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:227)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:49)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:215)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:106)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:224)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:326)
	... 11 common frames omitted
2025-12-19 00:17:45.957 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:17:45.957 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:17:45.957 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:17:45.957 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:17:45.957 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: zw2sld5w
2025-12-19 00:17:45.957 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:17:45.957 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: cc52ff783b7d4602b7ed7a1208d7178f
2025-12-19 00:17:45.957 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 5dywnndd
2025-12-19 00:17:45.958 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 1ae577eb2c65410a8a33de6c3ab50753
2025-12-19 00:17:45.958 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=zw2sld5w
2025-12-19 00:17:45.959 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=5dywnndd
2025-12-19 00:17:45.960 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=cc52ff783b7d4602b7ed7a1208d7178f, simpSessionId=zw2sld5w}], simpUser=cc52ff783b7d4602b7ed7a1208d7178f, simpSessionId=zw2sld5w}]
2025-12-19 00:17:45.960 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=1ae577eb2c65410a8a33de6c3ab50753, simpSessionId=5dywnndd}], simpUser=1ae577eb2c65410a8a33de6c3ab50753, simpSessionId=5dywnndd}]
2025-12-19 00:17:45.960 [clientOutboundChannel-3] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Terminating connection after failure to send message to client
java.io.IOException: java.io.IOException: Connection reset by peer
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:327)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:254)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:227)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:49)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:215)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:106)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:224)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:326)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:213)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:170)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.io.IOException: Connection reset by peer
	at java.base/sun.nio.ch.SocketDispatcher.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:58)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:217)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:153)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:563)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:147)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1614)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:1061)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1480)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1406)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1377)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:93)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:512)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	... 18 common frames omitted
2025-12-19 00:17:45.961 [clientOutboundChannel-3] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session 5dywnndd
org.springframework.web.socket.sockjs.SockJsTransportFailureException: Failed to write SockJsFrame content='a["ERROR\nmessage:Session closed.\ncontent-length:0\n\n\u0000"]'; nested exception is java.io.IOException: java.io.IOException: Connection reset by peer
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:343)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:213)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:170)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.io.IOException: java.io.IOException: Connection reset by peer
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:327)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:254)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:227)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:49)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:215)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:106)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:224)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:326)
	... 11 common frames omitted
Caused by: java.io.IOException: Connection reset by peer
	at java.base/sun.nio.ch.SocketDispatcher.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:58)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:217)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:153)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:563)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:147)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1614)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:1061)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1480)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1406)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1377)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:93)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:512)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	... 18 common frames omitted
2025-12-19 00:17:48.672 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:17:53.689 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:17:55.954 [MessageBroker-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [5dywnndd, zw2sld5w]
2025-12-19 00:17:58.704 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:18:03.713 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:18:08.738 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:18:13.750 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:18:16.623 [MessageBroker-5] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 3 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 11]
2025-12-19 00:18:18.760 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:18:23.771 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:18:28.779 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:18:33.793 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:18:38.803 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:18:43.819 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:19:39.751 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 46084 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:19:39.763 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:19:39.763 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:19:40.657 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:19:40.663 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:19:40.707 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 21 ms. Found 0 Redis repository interfaces.
2025-12-19 00:19:41.216 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:19:41.228 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:19:41.229 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:19:41.230 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:19:41.305 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:19:41.305 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1442 ms
2025-12-19 00:19:41.940 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:19:42.020 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:19:42.024 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:19:42.024 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:19:42.027 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:19:42.057 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 00:19:42.180 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:19:42.670 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:19:42.692 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:19:42.694 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:19:42.694 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:19:42.694 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:19:42.695 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]
2025-12-19 00:19:42.696 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]
2025-12-19 00:19:42.696 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]]
2025-12-19 00:19:42.697 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:19:42.697 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:19:42.697 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:19:43.214 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:19:46.610 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 00:19:46.610 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 00:19:46.611 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-12-19 00:19:47.710 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 00:19:47.744 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#61b65d54:0/SimpleConnection@16b76858 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 51437]
2025-12-19 00:19:47.789 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 8.706 seconds (JVM running for 9.109)
2025-12-19 00:19:48.226 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:19:49.840 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 00:19:49.842 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:19:49.855 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 00:19:49.856 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/901/mnzjxtbr/websocket
2025-12-19 00:19:49.858 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 79cc52cbaff5452f8ab815808e88c339
2025-12-19 00:19:49.892 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=mnzjxtbr]
2025-12-19 00:19:49.917 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:19:49.918 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:19:49.918 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:19:49.919 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: mnzjxtbr
2025-12-19 00:19:49.919 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 79cc52cbaff5452f8ab815808e88c339
2025-12-19 00:19:49.921 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=79cc52cbaff5452f8ab815808e88c339 session=mnzjxtbr
2025-12-19 00:19:51.951 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 00:19:51.952 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:19:51.954 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 00:19:51.955 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/819/pecmsvsh/websocket
2025-12-19 00:19:51.955 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: d9d2137ea59b4ba68957386c7630a755
2025-12-19 00:19:51.957 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=pecmsvsh]
2025-12-19 00:19:51.958 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:19:51.958 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:19:51.959 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:19:51.959 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: pecmsvsh
2025-12-19 00:19:51.959 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d9d2137ea59b4ba68957386c7630a755
2025-12-19 00:19:51.959 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=d9d2137ea59b4ba68957386c7630a755 session=pecmsvsh
2025-12-19 00:19:53.243 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:19:53.985 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:19:53.985 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 00:19:53.986 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 00:19:53.986 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: pecmsvsh
2025-12-19 00:19:53.986 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d9d2137ea59b4ba68957386c7630a755
2025-12-19 00:19:53.987 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=pecmsvsh
2025-12-19 00:19:53.988 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userpecmsvsh subscriptionId=sub-0 session=pecmsvsh user=d9d2137ea59b4ba68957386c7630a755 payload=byte[0]
2025-12-19 00:19:57.542 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:19:57.543 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 00:19:57.543 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 00:19:57.543 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: mnzjxtbr
2025-12-19 00:19:57.543 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 79cc52cbaff5452f8ab815808e88c339
2025-12-19 00:19:57.543 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 50, 58, 49, 57, 58, 53, 55, 34, 44, 34, 105, 100, 34, 58, 34, 100, 57, 100, 50, 49, 51, 55, 101, 97, 53, 57, 98, 52, 98, 97, 54, 56, 57, 53, 55, 51, 56, 54, 99, 55, 54, 51, 48, 97, 55, 53, 53, 34, 125]
2025-12-19 00:19:57.544 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[83]}, simpSessionAttributes={}, simpHeartbeat=[J@2ade24c2, simpUser=79cc52cbaff5452f8ab815808e88c339, simpSessionId=mnzjxtbr, simpDestination=/ws/privateMessage}
2025-12-19 00:19:58.254 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:03.269 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:08.288 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:09.749 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:20:09.750 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:20:09.750 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:20:09.750 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:20:09.750 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:20:09.750 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: mnzjxtbr
2025-12-19 00:20:09.751 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:20:09.751 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 79cc52cbaff5452f8ab815808e88c339
2025-12-19 00:20:09.751 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: pecmsvsh
2025-12-19 00:20:09.752 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d9d2137ea59b4ba68957386c7630a755
2025-12-19 00:20:09.752 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=mnzjxtbr
2025-12-19 00:20:09.758 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=pecmsvsh
2025-12-19 00:20:09.758 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=mnzjxtbr] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:20:09.758 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=pecmsvsh] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:20:09.758 [http-nio-8080-exec-10] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session mnzjxtbr
2025-12-19 00:20:09.758 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session pecmsvsh
2025-12-19 00:20:09.759 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:20:09.759 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:20:09.759 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@4022ab3e, simpUser=d9d2137ea59b4ba68957386c7630a755, simpSessionId=pecmsvsh}], simpUser=d9d2137ea59b4ba68957386c7630a755, simpSessionId=pecmsvsh}]
2025-12-19 00:20:09.759 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:20:09.759 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:20:09.760 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:20:09.760 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:20:09.760 [clientOutboundChannel-3] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session mnzjxtbr
java.lang.IllegalStateException: Cannot send a message when session is closed
	at org.springframework.util.Assert.state(Assert.java:76)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:168)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 00:20:09.760 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: mnzjxtbr
2025-12-19 00:20:09.760 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: pecmsvsh
2025-12-19 00:20:09.760 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 79cc52cbaff5452f8ab815808e88c339
2025-12-19 00:20:09.760 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d9d2137ea59b4ba68957386c7630a755
2025-12-19 00:20:09.761 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=mnzjxtbr
2025-12-19 00:20:09.762 [clientInboundChannel-22] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=pecmsvsh
2025-12-19 00:20:09.762 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=79cc52cbaff5452f8ab815808e88c339, simpSessionId=mnzjxtbr}], simpUser=79cc52cbaff5452f8ab815808e88c339, simpSessionId=mnzjxtbr}]
2025-12-19 00:20:09.762 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=d9d2137ea59b4ba68957386c7630a755, simpSessionId=pecmsvsh}], simpUser=d9d2137ea59b4ba68957386c7630a755, simpSessionId=pecmsvsh}]
2025-12-19 00:20:13.304 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:14.872 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [mnzjxtbr, pecmsvsh]
2025-12-19 00:20:18.323 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:23.333 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:28.351 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:33.369 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:38.378 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:41.954 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 11]
2025-12-19 00:20:43.390 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:48.399 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:53.406 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:20:58.424 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:21:03.433 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:21:08.436 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:21:13.451 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:21:18.455 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:26:17.824 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 41784 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:26:17.833 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:26:17.834 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:26:18.482 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:26:18.484 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:26:18.508 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2025-12-19 00:26:19.093 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:26:19.101 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:26:19.102 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:26:19.103 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:26:19.182 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:26:19.182 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1283 ms
2025-12-19 00:26:19.735 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:26:19.826 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:26:19.828 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:26:19.830 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:26:19.834 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:26:19.866 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 00:26:19.982 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:26:20.527 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:26:20.553 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:26:20.555 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:26:20.555 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:26:20.555 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:26:20.556 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]
2025-12-19 00:26:20.556 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]
2025-12-19 00:26:20.557 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]]
2025-12-19 00:26:20.557 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:26:20.557 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:26:20.558 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:26:20.987 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:26:21.081 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 00:26:21.082 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 00:26:21.083 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 00:26:25.569 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 00:26:25.611 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7f2c57fe:0/SimpleConnection@16b76858 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 60627]
2025-12-19 00:26:25.664 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 8.331 seconds (JVM running for 8.76)
2025-12-19 00:26:26.001 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:26:31.027 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:26:31.428 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@75882261
2025-12-19 00:26:31.432 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:26:31.453 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@75882261
2025-12-19 00:26:31.454 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/218/qxip0eb0/websocket
2025-12-19 00:26:31.466 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 85700bddcc2345c19680b59e95155162
2025-12-19 00:26:31.553 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=qxip0eb0]
2025-12-19 00:26:31.604 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:26:31.604 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:26:31.605 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:26:31.605 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: qxip0eb0
2025-12-19 00:26:31.606 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 85700bddcc2345c19680b59e95155162
2025-12-19 00:26:31.611 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=85700bddcc2345c19680b59e95155162 session=qxip0eb0
2025-12-19 00:26:33.649 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@75882261
2025-12-19 00:26:33.650 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:26:33.653 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@75882261
2025-12-19 00:26:33.654 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/083/bsygmbw2/websocket
2025-12-19 00:26:33.654 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: f498229649db4c55959b9054edcaa610
2025-12-19 00:26:33.658 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=bsygmbw2]
2025-12-19 00:26:33.660 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:26:33.660 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:26:33.660 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:26:33.660 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: bsygmbw2
2025-12-19 00:26:33.661 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f498229649db4c55959b9054edcaa610
2025-12-19 00:26:33.662 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=f498229649db4c55959b9054edcaa610 session=bsygmbw2
2025-12-19 00:26:35.685 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:26:35.685 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 00:26:35.686 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 00:26:35.686 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: bsygmbw2
2025-12-19 00:26:35.686 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f498229649db4c55959b9054edcaa610
2025-12-19 00:26:35.686 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=bsygmbw2
2025-12-19 00:26:35.687 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userbsygmbw2 subscriptionId=sub-0 session=bsygmbw2 user=f498229649db4c55959b9054edcaa610 payload=byte[0]
2025-12-19 00:26:36.036 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:26:39.243 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:26:39.243 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 00:26:39.244 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 00:26:39.244 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: qxip0eb0
2025-12-19 00:26:39.244 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 85700bddcc2345c19680b59e95155162
2025-12-19 00:26:39.244 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 00:26:39.244 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 50, 58, 50, 54, 58, 51, 57, 34, 44, 34, 105, 100, 34, 58, 34, 102, 52, 57, 56, 50, 50, 57, 54, 52, 57, 100, 98, 52, 99, 53, 53, 57, 53, 57, 98, 57, 48, 53, 52, 101, 100, 99, 97, 97, 54, 49, 48, 34, 125]
2025-12-19 00:26:39.250 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[83]}, simpSessionAttributes={}, simpHeartbeat=[J@1ef20600, simpUser=85700bddcc2345c19680b59e95155162, simpSessionId=qxip0eb0, simpDestination=/ws/privateMessage}
2025-12-19 00:26:39.251 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午12:26:39","id":"f498229649db4c55959b9054edcaa610"}
2025-12-19 00:26:39.251 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 00:26:39.251 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: //privateMessage
2025-12-19 00:26:41.046 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:26:46.067 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:26:51.079 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:26:51.492 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:26:51.494 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:26:51.494 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:26:51.494 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: qxip0eb0
2025-12-19 00:26:51.495 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 85700bddcc2345c19680b59e95155162
2025-12-19 00:26:51.495 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=qxip0eb0] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:26:51.495 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=qxip0eb0
2025-12-19 00:26:51.495 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session qxip0eb0
2025-12-19 00:26:51.495 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:26:51.496 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:26:51.497 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:26:51.497 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:26:51.497 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@15320ea5, simpUser=85700bddcc2345c19680b59e95155162, simpSessionId=qxip0eb0}], simpUser=85700bddcc2345c19680b59e95155162, simpSessionId=qxip0eb0}]
2025-12-19 00:26:51.497 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:26:51.497 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: bsygmbw2
2025-12-19 00:26:51.497 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:26:51.497 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f498229649db4c55959b9054edcaa610
2025-12-19 00:26:51.497 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: qxip0eb0
2025-12-19 00:26:51.498 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 85700bddcc2345c19680b59e95155162
2025-12-19 00:26:51.498 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=bsygmbw2] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:26:51.498 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session bsygmbw2
2025-12-19 00:26:51.498 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:26:51.498 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=bsygmbw2
2025-12-19 00:26:51.498 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:26:51.498 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=qxip0eb0
2025-12-19 00:26:51.499 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:26:51.499 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: bsygmbw2
2025-12-19 00:26:51.499 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f498229649db4c55959b9054edcaa610
2025-12-19 00:26:51.499 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=85700bddcc2345c19680b59e95155162, simpSessionId=qxip0eb0}], simpUser=85700bddcc2345c19680b59e95155162, simpSessionId=qxip0eb0}]
2025-12-19 00:26:51.499 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@6ec10c9e, simpUser=f498229649db4c55959b9054edcaa610, simpSessionId=bsygmbw2}], simpUser=f498229649db4c55959b9054edcaa610, simpSessionId=bsygmbw2}]
2025-12-19 00:26:51.500 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=bsygmbw2
2025-12-19 00:26:51.502 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=f498229649db4c55959b9054edcaa610, simpSessionId=bsygmbw2}], simpUser=f498229649db4c55959b9054edcaa610, simpSessionId=bsygmbw2}]
2025-12-19 00:26:56.096 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:01.104 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:01.470 [MessageBroker-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [bsygmbw2, qxip0eb0]
2025-12-19 00:27:06.117 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:11.126 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:16.142 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:19.760 [MessageBroker-7] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 10]
2025-12-19 00:27:21.149 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:26.164 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:31.176 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:36.190 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:41.194 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:46.203 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:51.209 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:27:56.213 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:28:01.221 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:28:06.233 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:28:11.242 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:28:16.254 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:28:21.258 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:28:26.276 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:28:31.281 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:28:36.290 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:28:41.293 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:28:46.311 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:29:13.603 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 46488 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:29:13.612 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:29:13.613 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:29:14.357 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:29:14.360 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:29:14.383 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-12-19 00:29:14.869 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:29:14.881 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:29:14.881 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:29:14.881 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:29:14.968 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:29:14.968 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1285 ms
2025-12-19 00:29:15.630 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:29:15.748 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:29:15.751 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:29:15.751 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:29:15.757 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:29:15.781 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 00:29:15.962 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:29:16.340 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:29:16.361 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:29:16.362 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:29:16.363 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:29:16.363 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:29:16.363 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]
2025-12-19 00:29:16.363 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]
2025-12-19 00:29:16.364 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]]
2025-12-19 00:29:16.364 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:29:16.364 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:29:16.364 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:29:16.816 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:29:19.829 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 00:29:19.830 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 00:29:19.831 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 00:29:21.372 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 00:29:21.409 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#7f2c57fe:0/SimpleConnection@16b76858 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 50578]
2025-12-19 00:29:21.460 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 8.382 seconds (JVM running for 8.778)
2025-12-19 00:29:21.830 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:29:23.112 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@75882261
2025-12-19 00:29:23.115 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:29:23.128 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@75882261
2025-12-19 00:29:23.129 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/120/eiakecpj/websocket
2025-12-19 00:29:23.132 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 6d1228d8a325463ab2f819ec44f4539a
2025-12-19 00:29:23.192 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=eiakecpj]
2025-12-19 00:29:23.226 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:29:23.226 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:29:23.227 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:29:23.227 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: eiakecpj
2025-12-19 00:29:23.227 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6d1228d8a325463ab2f819ec44f4539a
2025-12-19 00:29:23.229 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=6d1228d8a325463ab2f819ec44f4539a session=eiakecpj
2025-12-19 00:29:25.263 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@75882261
2025-12-19 00:29:25.263 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:29:25.267 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@75882261
2025-12-19 00:29:25.268 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/463/fj4dxlqv/websocket
2025-12-19 00:29:25.268 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 8ef9243828d34f098b5ee5c1ba5365f1
2025-12-19 00:29:25.271 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=fj4dxlqv]
2025-12-19 00:29:25.272 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:29:25.273 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:29:25.273 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:29:25.273 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: fj4dxlqv
2025-12-19 00:29:25.273 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 8ef9243828d34f098b5ee5c1ba5365f1
2025-12-19 00:29:25.274 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=8ef9243828d34f098b5ee5c1ba5365f1 session=fj4dxlqv
2025-12-19 00:29:26.841 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:29:27.299 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:29:27.299 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 00:29:27.300 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 00:29:27.300 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: fj4dxlqv
2025-12-19 00:29:27.300 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 8ef9243828d34f098b5ee5c1ba5365f1
2025-12-19 00:29:27.301 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=fj4dxlqv
2025-12-19 00:29:27.302 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userfj4dxlqv subscriptionId=sub-0 session=fj4dxlqv user=8ef9243828d34f098b5ee5c1ba5365f1 payload=byte[0]
2025-12-19 00:29:30.839 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:29:30.839 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 00:29:30.840 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 00:29:30.840 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: eiakecpj
2025-12-19 00:29:30.840 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6d1228d8a325463ab2f819ec44f4539a
2025-12-19 00:29:30.840 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 00:29:30.841 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 50, 58, 50, 57, 58, 51, 48, 34, 44, 34, 105, 100, 34, 58, 34, 56, 101, 102, 57, 50, 52, 51, 56, 50, 56, 100, 51, 52, 102, 48, 57, 56, 98, 53, 101, 101, 53, 99, 49, 98, 97, 53, 51, 54, 53, 102, 49, 34, 125]
2025-12-19 00:29:30.841 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[83]}, simpSessionAttributes={}, simpHeartbeat=[J@59faaf3b, simpUser=6d1228d8a325463ab2f819ec44f4539a, simpSessionId=eiakecpj, simpDestination=/ws/privateMessage}
2025-12-19 00:29:30.841 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午12:29:30","id":"8ef9243828d34f098b5ee5c1ba5365f1"}
2025-12-19 00:29:30.841 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 00:29:30.841 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 00:29:30.841 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 00:29:31.850 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:29:36.859 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:29:41.877 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:29:43.057 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:29:43.058 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:29:43.058 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:29:43.059 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: eiakecpj
2025-12-19 00:29:43.059 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6d1228d8a325463ab2f819ec44f4539a
2025-12-19 00:29:43.059 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:29:43.059 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:29:43.060 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:29:43.060 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=eiakecpj] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:29:43.060 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: fj4dxlqv
2025-12-19 00:29:43.060 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session eiakecpj
2025-12-19 00:29:43.060 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 8ef9243828d34f098b5ee5c1ba5365f1
2025-12-19 00:29:43.060 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=eiakecpj
2025-12-19 00:29:43.061 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:29:43.061 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:29:43.061 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:29:43.061 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: eiakecpj
2025-12-19 00:29:43.061 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=fj4dxlqv
2025-12-19 00:29:43.061 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@5d4dc089, simpUser=6d1228d8a325463ab2f819ec44f4539a, simpSessionId=eiakecpj}], simpUser=6d1228d8a325463ab2f819ec44f4539a, simpSessionId=eiakecpj}]
2025-12-19 00:29:43.062 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6d1228d8a325463ab2f819ec44f4539a
2025-12-19 00:29:43.062 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=fj4dxlqv] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:29:43.062 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session fj4dxlqv
2025-12-19 00:29:43.062 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:29:43.062 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:29:43.062 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=eiakecpj
2025-12-19 00:29:43.062 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:29:43.063 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: fj4dxlqv
2025-12-19 00:29:43.063 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=6d1228d8a325463ab2f819ec44f4539a, simpSessionId=eiakecpj}], simpUser=6d1228d8a325463ab2f819ec44f4539a, simpSessionId=eiakecpj}]
2025-12-19 00:29:43.063 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 8ef9243828d34f098b5ee5c1ba5365f1
2025-12-19 00:29:43.063 [clientOutboundChannel-4] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session fj4dxlqv
java.lang.IllegalStateException: Cannot send a message when session is closed
	at org.springframework.util.Assert.state(Assert.java:76)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:168)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 00:29:43.064 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=fj4dxlqv
2025-12-19 00:29:43.064 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=8ef9243828d34f098b5ee5c1ba5365f1, simpSessionId=fj4dxlqv}], simpUser=8ef9243828d34f098b5ee5c1ba5365f1, simpSessionId=fj4dxlqv}]
2025-12-19 00:29:46.899 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:29:48.138 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [eiakecpj, fj4dxlqv]
2025-12-19 00:29:51.909 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:29:56.929 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:30:01.946 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:30:06.960 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:30:11.974 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:30:15.647 [MessageBroker-5] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 11]
2025-12-19 00:30:16.994 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:30:22.013 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:30:27.028 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:30:32.068 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:30:37.082 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:30:42.091 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:31:05.435 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 47308 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:31:05.455 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:31:05.457 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:31:06.459 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:31:06.464 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:31:06.497 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
2025-12-19 00:31:07.110 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:31:07.122 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:31:07.123 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:31:07.123 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:31:07.282 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:31:07.284 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1721 ms
2025-12-19 00:31:08.822 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:31:08.923 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@455b6df1, started on Fri Dec 19 00:31:05 GMT+08:00 2025
2025-12-19 00:31:09.052 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:31:09.058 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:31:09.058 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:31:09.066 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:31:09.128 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 00:31:09.410 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:31:09.997 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:31:10.023 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:31:10.024 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:31:10.025 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:31:10.025 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:31:10.026 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1584c019]
2025-12-19 00:31:10.026 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1584c019]
2025-12-19 00:31:10.026 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1584c019]]
2025-12-19 00:31:10.027 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:31:10.027 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:31:10.027 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:31:10.204 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 00:31:10.204 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 00:31:10.206 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 00:31:10.417 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:31:13.528 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@6d69a0d3
2025-12-19 00:31:13.531 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:31:13.544 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@6d69a0d3
2025-12-19 00:31:13.544 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/498/0dsclryv/websocket
2025-12-19 00:31:13.549 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 0ca679d4cdcf4c00a27232a5d6f05751
2025-12-19 00:31:13.588 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=0dsclryv]
2025-12-19 00:31:13.615 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=0ca679d4cdcf4c00a27232a5d6f05751 session=0dsclryv
2025-12-19 00:31:13.617 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:31:13.618 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:31:13.618 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:31:13.618 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 0dsclryv
2025-12-19 00:31:13.619 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0ca679d4cdcf4c00a27232a5d6f05751
2025-12-19 00:31:13.621 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=0ca679d4cdcf4c00a27232a5d6f05751 session=0dsclryv
2025-12-19 00:31:15.028 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 00:31:15.073 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#72fbf94d:0/SimpleConnection@606d6d2c [delegate=amqp://guest@127.0.0.1:5672/, localPort= 49706]
2025-12-19 00:31:15.125 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 10.721 seconds (JVM running for 11.396)
2025-12-19 00:31:15.438 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:31:15.652 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@6d69a0d3
2025-12-19 00:31:15.652 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:31:15.657 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@6d69a0d3
2025-12-19 00:31:15.658 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/180/tvnvemxu/websocket
2025-12-19 00:31:15.658 [http-nio-8080-exec-7] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: d828183335b34c90a0153e42f97795e8
2025-12-19 00:31:15.660 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=tvnvemxu]
2025-12-19 00:31:15.661 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=d828183335b34c90a0153e42f97795e8 session=tvnvemxu
2025-12-19 00:31:15.661 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:31:15.662 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:31:15.662 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:31:15.662 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: tvnvemxu
2025-12-19 00:31:15.662 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d828183335b34c90a0153e42f97795e8
2025-12-19 00:31:15.662 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=d828183335b34c90a0153e42f97795e8 session=tvnvemxu
2025-12-19 00:31:17.683 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=tvnvemxu
2025-12-19 00:31:17.683 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:31:17.683 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 00:31:17.683 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 00:31:17.685 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: tvnvemxu
2025-12-19 00:31:17.685 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d828183335b34c90a0153e42f97795e8
2025-12-19 00:31:17.686 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=tvnvemxu
2025-12-19 00:31:17.686 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-usertvnvemxu subscriptionId=sub-0 session=tvnvemxu user=d828183335b34c90a0153e42f97795e8 payload=byte[0]
2025-12-19 00:31:20.455 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:31:21.242 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=0dsclryv
2025-12-19 00:31:21.243 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:31:21.243 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 00:31:21.243 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 00:31:21.244 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 0dsclryv
2025-12-19 00:31:21.244 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0ca679d4cdcf4c00a27232a5d6f05751
2025-12-19 00:31:21.244 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 00:31:21.244 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 50, 58, 51, 49, 58, 50, 49, 34, 44, 34, 105, 100, 34, 58, 34, 100, 56, 50, 56, 49, 56, 51, 51, 51, 53, 98, 51, 52, 99, 57, 48, 97, 48, 49, 53, 51, 101, 52, 50, 102, 57, 55, 55, 57, 53, 101, 56, 34, 125]
2025-12-19 00:31:21.245 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[83]}, simpSessionAttributes={}, simpHeartbeat=[J@da916f5, simpUser=0ca679d4cdcf4c00a27232a5d6f05751, simpSessionId=0dsclryv, simpDestination=/ws/privateMessage}
2025-12-19 00:31:21.245 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午12:31:21","id":"d828183335b34c90a0153e42f97795e8"}
2025-12-19 00:31:21.245 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 00:31:21.246 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 00:31:21.246 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 00:31:25.479 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:31:30.497 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:31:33.472 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=0dsclryv
2025-12-19 00:31:33.473 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:31:33.473 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:31:33.474 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:31:33.474 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 0dsclryv
2025-12-19 00:31:33.474 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0ca679d4cdcf4c00a27232a5d6f05751
2025-12-19 00:31:33.474 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=tvnvemxu
2025-12-19 00:31:33.475 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:31:33.475 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:31:33.476 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=0dsclryv
2025-12-19 00:31:33.476 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:31:33.476 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: tvnvemxu
2025-12-19 00:31:33.476 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d828183335b34c90a0153e42f97795e8
2025-12-19 00:31:33.476 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=0dsclryv] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:31:33.476 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 0dsclryv
2025-12-19 00:31:33.477 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=tvnvemxu
2025-12-19 00:31:33.477 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=tvnvemxu] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:31:33.477 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:31:33.477 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session tvnvemxu
2025-12-19 00:31:33.477 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:31:33.477 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:31:33.477 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:31:33.478 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:31:33.478 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 0dsclryv
2025-12-19 00:31:33.478 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:31:33.478 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0ca679d4cdcf4c00a27232a5d6f05751
2025-12-19 00:31:33.478 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: tvnvemxu
2025-12-19 00:31:33.478 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@22334216, simpUser=d828183335b34c90a0153e42f97795e8, simpSessionId=tvnvemxu}], simpUser=d828183335b34c90a0153e42f97795e8, simpSessionId=tvnvemxu}]
2025-12-19 00:31:33.479 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d828183335b34c90a0153e42f97795e8
2025-12-19 00:31:33.479 [clientOutboundChannel-3] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session 0dsclryv
java.lang.IllegalStateException: Cannot send a message when session is closed
	at org.springframework.util.Assert.state(Assert.java:76)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:168)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 00:31:33.479 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=0dsclryv
2025-12-19 00:31:33.479 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=tvnvemxu
2025-12-19 00:31:33.480 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=0ca679d4cdcf4c00a27232a5d6f05751, simpSessionId=0dsclryv}], simpUser=0ca679d4cdcf4c00a27232a5d6f05751, simpSessionId=0dsclryv}]
2025-12-19 00:31:33.480 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=d828183335b34c90a0153e42f97795e8, simpSessionId=tvnvemxu}], simpUser=d828183335b34c90a0153e42f97795e8, simpSessionId=tvnvemxu}]
2025-12-19 00:31:35.507 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:31:38.559 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [tvnvemxu, 0dsclryv]
2025-12-19 00:31:40.516 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:31:45.528 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:31:50.552 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:31:55.570 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:00.593 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:05.613 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:08.859 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 12]
2025-12-19 00:32:10.628 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:15.651 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:20.671 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:25.691 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:30.706 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:35.709 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:40.722 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:45.726 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:50.735 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:32:55.744 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:00.755 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:05.760 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:10.765 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:15.771 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:20.782 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:25.793 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:30.804 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:35.808 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:40.814 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:45.828 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:50.840 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:33:55.846 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:34:00.861 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:34:05.869 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:34:10.887 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:34:29.838 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 49236 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:34:29.847 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:34:29.848 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:34:30.774 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:34:30.781 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:34:30.846 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 29 ms. Found 0 Redis repository interfaces.
2025-12-19 00:34:31.830 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:34:31.847 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:34:31.851 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:34:31.851 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:34:31.959 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:34:31.960 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1966 ms
2025-12-19 00:34:32.994 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:34:33.086 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@455b6df1, started on Fri Dec 19 00:34:29 GMT+08:00 2025
2025-12-19 00:34:33.190 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:34:33.195 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:34:33.196 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:34:33.212 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:34:33.260 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 00:34:33.493 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:34:34.207 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:34:34.237 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:34:34.239 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:34:34.239 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:34:34.240 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:34:34.240 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@7dd91ffc]
2025-12-19 00:34:34.240 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@7dd91ffc]
2025-12-19 00:34:34.241 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@7dd91ffc]]
2025-12-19 00:34:34.241 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:34:34.242 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:34:34.242 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:34:34.637 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 00:34:34.637 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 00:34:34.639 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 00:34:34.880 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:34:38.169 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3b088163
2025-12-19 00:34:38.171 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:34:38.183 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3b088163
2025-12-19 00:34:38.185 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/641/nbmkmwfh/websocket
2025-12-19 00:34:38.189 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: c7fe205e6437433080d631470d70a64c
2025-12-19 00:34:38.229 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=nbmkmwfh]
2025-12-19 00:34:38.260 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=c7fe205e6437433080d631470d70a64c session=nbmkmwfh
2025-12-19 00:34:38.262 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:34:38.262 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:34:38.262 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:34:38.262 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: nbmkmwfh
2025-12-19 00:34:38.263 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: c7fe205e6437433080d631470d70a64c
2025-12-19 00:34:38.263 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 00:34:38.264 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=c7fe205e6437433080d631470d70a64c session=nbmkmwfh
2025-12-19 00:34:39.255 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 00:34:39.304 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#b2c4a8b:0/SimpleConnection@d3cce46 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 49686]
2025-12-19 00:34:39.363 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 10.414 seconds (JVM running for 11.171)
2025-12-19 00:34:39.897 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:34:40.285 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3b088163
2025-12-19 00:34:40.286 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 00:34:40.292 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@3b088163
2025-12-19 00:34:40.294 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/497/iaznxnzh/websocket
2025-12-19 00:34:40.294 [http-nio-8080-exec-7] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 82737d83f0ef4802b1d2dcae35beceb9
2025-12-19 00:34:40.296 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=iaznxnzh]
2025-12-19 00:34:40.300 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=82737d83f0ef4802b1d2dcae35beceb9 session=iaznxnzh
2025-12-19 00:34:40.301 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:34:40.302 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 00:34:40.302 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:34:40.302 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: iaznxnzh
2025-12-19 00:34:40.304 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 82737d83f0ef4802b1d2dcae35beceb9
2025-12-19 00:34:40.305 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 00:34:40.306 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=82737d83f0ef4802b1d2dcae35beceb9 session=iaznxnzh
2025-12-19 00:34:42.326 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=iaznxnzh
2025-12-19 00:34:42.326 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:34:42.327 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 00:34:42.327 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 00:34:42.327 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: iaznxnzh
2025-12-19 00:34:42.327 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 82737d83f0ef4802b1d2dcae35beceb9
2025-12-19 00:34:42.327 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 00:34:42.328 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=iaznxnzh
2025-12-19 00:34:42.329 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-useriaznxnzh subscriptionId=sub-0 session=iaznxnzh user=82737d83f0ef4802b1d2dcae35beceb9 payload=byte[0]
2025-12-19 00:34:44.913 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:34:45.878 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=nbmkmwfh
2025-12-19 00:34:45.878 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:34:45.878 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 00:34:45.878 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 00:34:45.878 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: nbmkmwfh
2025-12-19 00:34:45.878 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: c7fe205e6437433080d631470d70a64c
2025-12-19 00:34:45.880 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 00:34:45.880 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 00:34:45.880 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 50, 58, 51, 52, 58, 52, 53, 34, 44, 34, 105, 100, 34, 58, 34, 56, 50, 55, 51, 55, 100, 56, 51, 102, 48, 101, 102, 52, 56, 48, 50, 98, 49, 100, 50, 100, 99, 97, 101, 51, 53, 98, 101, 99, 101, 98, 57, 34, 125]
2025-12-19 00:34:45.881 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[83]}, simpSessionAttributes={}, simpHeartbeat=[J@798a68bf, simpUser=c7fe205e6437433080d631470d70a64c, simpSessionId=nbmkmwfh, simpDestination=/ws/privateMessage}
2025-12-19 00:34:45.882 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午12:34:45","id":"82737d83f0ef4802b1d2dcae35beceb9"}
2025-12-19 00:34:45.882 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 00:34:45.883 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 00:34:45.883 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 00:34:45.883 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 00:34:45.883 [http-nio-8080-exec-1] WARN  c.h.s.config.WebSocketInterceptor - ⚠ 訊息通道不是 clientInboundChannel: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 00:34:49.928 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:34:54.949 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:34:58.115 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=nbmkmwfh
2025-12-19 00:34:58.116 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:34:58.117 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:34:58.117 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:34:58.118 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: nbmkmwfh
2025-12-19 00:34:58.119 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: c7fe205e6437433080d631470d70a64c
2025-12-19 00:34:58.119 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=iaznxnzh
2025-12-19 00:34:58.119 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 00:34:58.119 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:34:58.119 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:34:58.120 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:34:58.121 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: iaznxnzh
2025-12-19 00:34:58.121 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=nbmkmwfh
2025-12-19 00:34:58.121 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 82737d83f0ef4802b1d2dcae35beceb9
2025-12-19 00:34:58.121 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 00:34:58.121 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=nbmkmwfh] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:34:58.121 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session nbmkmwfh
2025-12-19 00:34:58.122 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:34:58.122 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=iaznxnzh] closed with CloseStatus[code=1000, reason=null]
2025-12-19 00:34:58.122 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=iaznxnzh
2025-12-19 00:34:58.123 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@67d16379, simpUser=c7fe205e6437433080d631470d70a64c, simpSessionId=nbmkmwfh}], simpUser=c7fe205e6437433080d631470d70a64c, simpSessionId=nbmkmwfh}]
2025-12-19 00:34:58.123 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:34:58.123 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session iaznxnzh
2025-12-19 00:34:58.123 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:34:58.123 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: nbmkmwfh
2025-12-19 00:34:58.123 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 00:34:58.124 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: c7fe205e6437433080d631470d70a64c
2025-12-19 00:34:58.124 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 00:34:58.124 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 00:34:58.124 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 00:34:58.124 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@1b3bc437, simpUser=82737d83f0ef4802b1d2dcae35beceb9, simpSessionId=iaznxnzh}], simpUser=82737d83f0ef4802b1d2dcae35beceb9, simpSessionId=iaznxnzh}]
2025-12-19 00:34:58.124 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: iaznxnzh
2025-12-19 00:34:58.125 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 82737d83f0ef4802b1d2dcae35beceb9
2025-12-19 00:34:58.125 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 00:34:58.126 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=nbmkmwfh
2025-12-19 00:34:58.127 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=iaznxnzh
2025-12-19 00:34:58.127 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=c7fe205e6437433080d631470d70a64c, simpSessionId=nbmkmwfh}], simpUser=c7fe205e6437433080d631470d70a64c, simpSessionId=nbmkmwfh}]
2025-12-19 00:34:58.127 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=82737d83f0ef4802b1d2dcae35beceb9, simpSessionId=iaznxnzh}], simpUser=82737d83f0ef4802b1d2dcae35beceb9, simpSessionId=iaznxnzh}]
2025-12-19 00:34:59.969 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:03.199 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [nbmkmwfh, iaznxnzh]
2025-12-19 00:35:04.980 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:09.999 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:15.011 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:20.034 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:25.055 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:30.074 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:33.025 [MessageBroker-5] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 11]
2025-12-19 00:35:35.097 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:40.109 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:45.126 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:50.140 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:35:55.143 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:00.156 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:05.172 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:10.176 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:15.191 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:20.196 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:25.211 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:30.221 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:35.224 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:40.240 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:45.256 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:50.273 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:36:55.286 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:00.290 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:05.292 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:10.307 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:15.320 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:20.329 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:25.356 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:30.367 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:35.383 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:40.402 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:45.414 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:50.429 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:37:55.442 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:38:00.451 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:38:05.455 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:38:10.469 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:38:15.481 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:38:20.485 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 00:59:55.200 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 50820 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 00:59:55.211 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 00:59:55.211 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 00:59:55.910 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 00:59:55.913 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 00:59:55.936 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2025-12-19 00:59:56.480 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 00:59:56.489 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 00:59:56.490 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 00:59:56.490 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 00:59:56.568 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 00:59:56.568 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1280 ms
2025-12-19 00:59:57.288 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 00:59:57.345 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@1ab06251, started on Fri Dec 19 00:59:55 GMT+08:00 2025
2025-12-19 00:59:57.448 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 00:59:57.451 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 00:59:57.452 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 00:59:57.456 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 00:59:57.490 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 00:59:57.621 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 00:59:58.066 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 00:59:58.091 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 00:59:58.094 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 00:59:58.094 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 00:59:58.094 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 00:59:58.094 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@19faedcc]
2025-12-19 00:59:58.096 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@19faedcc]
2025-12-19 00:59:58.096 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@19faedcc]]
2025-12-19 00:59:58.097 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 00:59:58.097 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:59:58.097 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 00:59:58.586 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:03.111 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:00:03.156 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#101cf747:0/SimpleConnection@7f6b57f2 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 50864]
2025-12-19 01:00:03.222 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 8.479 seconds (JVM running for 8.826)
2025-12-19 01:00:03.600 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:07.555 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:00:07.556 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:00:07.557 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 01:00:08.623 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:12.864 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@615efd1c
2025-12-19 01:00:12.867 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:00:12.877 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@615efd1c
2025-12-19 01:00:12.878 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/478/cgqfj3tt/websocket
2025-12-19 01:00:12.882 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: f96fa843eac94e248f04dc3674b7f81f
2025-12-19 01:00:12.913 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=cgqfj3tt]
2025-12-19 01:00:12.936 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:00:12.937 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=f96fa843eac94e248f04dc3674b7f81f session=cgqfj3tt
2025-12-19 01:00:12.938 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:00:12.938 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:00:12.938 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:00:12.938 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: cgqfj3tt
2025-12-19 01:00:12.938 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f96fa843eac94e248f04dc3674b7f81f
2025-12-19 01:00:12.939 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:00:12.939 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:00:12.940 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=f96fa843eac94e248f04dc3674b7f81f session=cgqfj3tt
2025-12-19 01:00:12.944 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[f96fa843eac94e248f04dc3674b7f81f]}
2025-12-19 01:00:13.636 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:14.972 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@615efd1c
2025-12-19 01:00:14.972 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:00:14.980 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@615efd1c
2025-12-19 01:00:14.980 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/969/lgkpyhpk/websocket
2025-12-19 01:00:14.980 [http-nio-8080-exec-7] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: ed9a11427f1144788ae61c56dae7d04b
2025-12-19 01:00:14.988 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=lgkpyhpk]
2025-12-19 01:00:14.990 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:00:14.991 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=ed9a11427f1144788ae61c56dae7d04b session=lgkpyhpk
2025-12-19 01:00:14.991 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:00:14.991 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:00:14.991 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:00:14.992 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: lgkpyhpk
2025-12-19 01:00:14.992 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: ed9a11427f1144788ae61c56dae7d04b
2025-12-19 01:00:14.993 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:00:14.993 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:00:14.994 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=ed9a11427f1144788ae61c56dae7d04b session=lgkpyhpk
2025-12-19 01:00:14.995 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[ed9a11427f1144788ae61c56dae7d04b]}
2025-12-19 01:00:17.029 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:00:17.030 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=lgkpyhpk
2025-12-19 01:00:17.030 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:00:17.031 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:00:17.031 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:00:17.031 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: lgkpyhpk
2025-12-19 01:00:17.031 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: ed9a11427f1144788ae61c56dae7d04b
2025-12-19 01:00:17.031 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:00:17.031 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:00:17.033 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=lgkpyhpk
2025-12-19 01:00:17.034 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userlgkpyhpk]
2025-12-19 01:00:17.035 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userlgkpyhpk subscriptionId=sub-0 session=lgkpyhpk user=ed9a11427f1144788ae61c56dae7d04b payload=byte[0]
2025-12-19 01:00:18.656 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:20.596 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:00:20.596 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=cgqfj3tt
2025-12-19 01:00:20.597 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:00:20.597 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:00:20.597 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:00:20.598 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: cgqfj3tt
2025-12-19 01:00:20.598 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f96fa843eac94e248f04dc3674b7f81f
2025-12-19 01:00:20.598 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:00:20.598 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:00:20.599 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:00:20.599 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 48, 48, 58, 50, 48, 34, 44, 34, 105, 100, 34, 58, 34, 101, 100, 57, 97, 49, 49, 52, 50, 55, 102, 49, 49, 52, 52, 55, 56, 56, 97, 101, 54, 49, 99, 53, 54, 100, 97, 101, 55, 100, 48, 52, 98, 34, 125]
2025-12-19 01:00:20.599 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@2b9fd048, simpUser=f96fa843eac94e248f04dc3674b7f81f, simpSessionId=cgqfj3tt, simpDestination=/ws/privateMessage}
2025-12-19 01:00:20.600 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:00:20","id":"ed9a11427f1144788ae61c56dae7d04b"}
2025-12-19 01:00:20.600 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:00:20.600 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:00:20.600 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:00:20.600 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:00:20.600 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:00:20.601 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:00:20.601 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@2b9fd048, simpUser=f96fa843eac94e248f04dc3674b7f81f, simpSessionId=cgqfj3tt, simpDestination=/ws/privateMessage}
2025-12-19 01:00:23.674 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:28.686 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:32.821 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:00:32.822 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=cgqfj3tt
2025-12-19 01:00:32.822 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:00:32.823 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:00:32.823 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:00:32.823 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=lgkpyhpk
2025-12-19 01:00:32.823 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:00:32.823 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:00:32.823 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: cgqfj3tt
2025-12-19 01:00:32.824 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:00:32.824 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f96fa843eac94e248f04dc3674b7f81f
2025-12-19 01:00:32.824 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:00:32.825 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:00:32.825 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: lgkpyhpk
2025-12-19 01:00:32.825 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:00:32.826 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: ed9a11427f1144788ae61c56dae7d04b
2025-12-19 01:00:32.826 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:00:32.826 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:00:32.827 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=cgqfj3tt
2025-12-19 01:00:32.827 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=cgqfj3tt] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:00:32.827 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=lgkpyhpk] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:00:32.827 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session cgqfj3tt
2025-12-19 01:00:32.827 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session lgkpyhpk
2025-12-19 01:00:32.827 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=lgkpyhpk
2025-12-19 01:00:32.828 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:00:32.828 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:00:32.829 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@d0d736e, simpUser=f96fa843eac94e248f04dc3674b7f81f, simpSessionId=cgqfj3tt}], simpUser=f96fa843eac94e248f04dc3674b7f81f, simpSessionId=cgqfj3tt}]
2025-12-19 01:00:32.829 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:00:32.829 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:00:32.829 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:00:32.829 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:00:32.829 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: cgqfj3tt
2025-12-19 01:00:32.829 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@6ec10c9e, simpUser=ed9a11427f1144788ae61c56dae7d04b, simpSessionId=lgkpyhpk}], simpUser=ed9a11427f1144788ae61c56dae7d04b, simpSessionId=lgkpyhpk}]
2025-12-19 01:00:32.829 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: lgkpyhpk
2025-12-19 01:00:32.830 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f96fa843eac94e248f04dc3674b7f81f
2025-12-19 01:00:32.830 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: ed9a11427f1144788ae61c56dae7d04b
2025-12-19 01:00:32.830 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:00:32.830 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:00:32.830 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:00:32.830 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:00:32.831 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=lgkpyhpk
2025-12-19 01:00:32.831 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=cgqfj3tt
2025-12-19 01:00:32.831 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=ed9a11427f1144788ae61c56dae7d04b, simpSessionId=lgkpyhpk}], simpUser=ed9a11427f1144788ae61c56dae7d04b, simpSessionId=lgkpyhpk}]
2025-12-19 01:00:32.833 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=f96fa843eac94e248f04dc3674b7f81f, simpSessionId=cgqfj3tt}], simpUser=f96fa843eac94e248f04dc3674b7f81f, simpSessionId=cgqfj3tt}]
2025-12-19 01:00:33.696 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:37.889 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [lgkpyhpk, cgqfj3tt]
2025-12-19 01:00:38.708 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:43.726 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:48.738 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:53.751 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:00:57.313 [MessageBroker-5] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 15, active threads = 1, queued tasks = 1, completed tasks = 9]
2025-12-19 01:00:58.768 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:03.793 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:08.813 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:13.833 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:18.846 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:23.852 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:28.860 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:33.867 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:38.886 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:43.890 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:48.904 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:53.922 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:01:58.934 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:02:03.954 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:02:08.959 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:02:13.969 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:02:35.480 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 50532 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 01:02:35.495 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 01:02:35.497 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 01:02:36.470 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 01:02:36.474 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 01:02:36.506 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
2025-12-19 01:02:37.957 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 01:02:38.082 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 01:02:38.099 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 01:02:38.116 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 01:02:38.570 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 01:02:38.572 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2983 ms
2025-12-19 01:02:40.973 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 01:02:41.131 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@1ab06251, started on Fri Dec 19 01:02:35 GMT+08:00 2025
2025-12-19 01:02:41.247 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 01:02:41.256 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 01:02:41.261 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 01:02:41.270 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 01:02:41.349 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 01:02:41.670 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 01:02:43.387 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 01:02:43.498 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 01:02:43.517 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 01:02:43.529 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 01:02:43.538 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 01:02:43.551 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2c6927f0]
2025-12-19 01:02:43.553 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2c6927f0]
2025-12-19 01:02:43.554 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2c6927f0]]
2025-12-19 01:02:43.554 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 01:02:43.555 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:02:43.556 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:02:43.739 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:02:43.749 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:02:43.763 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 8 ms
2025-12-19 01:02:44.898 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:02:48.578 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:02:48.675 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#3dbd7107:0/SimpleConnection@144ee8a7 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 55904]
2025-12-19 01:02:48.820 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 14.117 seconds (JVM running for 14.531)
2025-12-19 01:02:49.480 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2322e56f
2025-12-19 01:02:49.482 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:02:49.496 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2322e56f
2025-12-19 01:02:49.497 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/455/zcv1j2fq/websocket
2025-12-19 01:02:49.501 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 0d542dcb65c74a64838f34a17b1665d5
2025-12-19 01:02:49.554 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=zcv1j2fq]
2025-12-19 01:02:49.606 [http-nio-8080-exec-4] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:02:49.610 [http-nio-8080-exec-4] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=0d542dcb65c74a64838f34a17b1665d5 session=zcv1j2fq
2025-12-19 01:02:49.613 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:02:49.614 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:02:49.614 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:02:49.615 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: zcv1j2fq
2025-12-19 01:02:49.615 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0d542dcb65c74a64838f34a17b1665d5
2025-12-19 01:02:49.616 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:02:49.617 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:02:49.619 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=0d542dcb65c74a64838f34a17b1665d5 session=zcv1j2fq
2025-12-19 01:02:49.630 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[0d542dcb65c74a64838f34a17b1665d5]}
2025-12-19 01:02:49.921 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:02:51.661 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2322e56f
2025-12-19 01:02:51.663 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:02:51.668 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2322e56f
2025-12-19 01:02:51.669 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/700/yp0lplrt/websocket
2025-12-19 01:02:51.669 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: f61f4b8710464a86983f86027962fe49
2025-12-19 01:02:51.674 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=yp0lplrt]
2025-12-19 01:02:51.679 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:02:51.680 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=f61f4b8710464a86983f86027962fe49 session=yp0lplrt
2025-12-19 01:02:51.680 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:02:51.680 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:02:51.681 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:02:51.682 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: yp0lplrt
2025-12-19 01:02:51.682 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f61f4b8710464a86983f86027962fe49
2025-12-19 01:02:51.682 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:02:51.683 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:02:51.684 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=f61f4b8710464a86983f86027962fe49 session=yp0lplrt
2025-12-19 01:02:51.684 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[f61f4b8710464a86983f86027962fe49]}
2025-12-19 01:02:53.717 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:02:53.718 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=yp0lplrt
2025-12-19 01:02:53.718 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:02:53.718 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:02:53.719 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:02:53.719 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: yp0lplrt
2025-12-19 01:02:53.719 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f61f4b8710464a86983f86027962fe49
2025-12-19 01:02:53.719 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:02:53.720 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:02:53.720 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=yp0lplrt
2025-12-19 01:02:53.721 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-useryp0lplrt]
2025-12-19 01:02:53.721 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-useryp0lplrt subscriptionId=sub-0 session=yp0lplrt user=f61f4b8710464a86983f86027962fe49 payload=byte[0]
2025-12-19 01:02:54.938 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:02:57.279 [http-nio-8080-exec-10] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:02:57.280 [http-nio-8080-exec-10] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=zcv1j2fq
2025-12-19 01:02:57.280 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:02:57.280 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:02:57.280 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:02:57.282 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: zcv1j2fq
2025-12-19 01:02:57.282 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0d542dcb65c74a64838f34a17b1665d5
2025-12-19 01:02:57.282 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:02:57.283 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:02:57.283 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:02:57.283 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 48, 50, 58, 53, 55, 34, 44, 34, 105, 100, 34, 58, 34, 102, 54, 49, 102, 52, 98, 56, 55, 49, 48, 52, 54, 52, 97, 56, 54, 57, 56, 51, 102, 56, 54, 48, 50, 55, 57, 54, 50, 102, 101, 52, 57, 34, 125]
2025-12-19 01:02:57.284 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@1ef20600, simpUser=0d542dcb65c74a64838f34a17b1665d5, simpSessionId=zcv1j2fq, simpDestination=/ws/privateMessage}
2025-12-19 01:02:57.284 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:02:57","id":"f61f4b8710464a86983f86027962fe49"}
2025-12-19 01:02:57.284 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:02:57.284 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:02:57.284 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:02:57.285 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:02:57.285 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:02:57.285 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:02:57.285 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@1ef20600, simpUser=0d542dcb65c74a64838f34a17b1665d5, simpSessionId=zcv1j2fq, simpDestination=/ws/privateMessage}
2025-12-19 01:02:59.985 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:05.006 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:09.492 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:03:09.493 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=zcv1j2fq
2025-12-19 01:03:09.493 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:03:09.493 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:03:09.494 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:03:09.494 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:03:09.494 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: zcv1j2fq
2025-12-19 01:03:09.494 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=yp0lplrt
2025-12-19 01:03:09.494 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0d542dcb65c74a64838f34a17b1665d5
2025-12-19 01:03:09.495 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:03:09.495 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:03:09.495 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:03:09.495 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:03:09.495 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:03:09.496 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: yp0lplrt
2025-12-19 01:03:09.496 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f61f4b8710464a86983f86027962fe49
2025-12-19 01:03:09.496 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:03:09.496 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=zcv1j2fq
2025-12-19 01:03:09.497 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:03:09.497 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=zcv1j2fq] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:03:09.497 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session zcv1j2fq
2025-12-19 01:03:09.499 [clientOutboundChannel-3] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP ERROR, headers={message=[Session closed.]}
2025-12-19 01:03:09.499 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=yp0lplrt
2025-12-19 01:03:09.499 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:03:09.499 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=yp0lplrt] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:03:09.500 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:03:09.500 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session yp0lplrt
2025-12-19 01:03:09.500 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:03:09.500 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:03:09.501 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: zcv1j2fq
2025-12-19 01:03:09.501 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:03:09.501 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0d542dcb65c74a64838f34a17b1665d5
2025-12-19 01:03:09.501 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@20ffac82, simpUser=f61f4b8710464a86983f86027962fe49, simpSessionId=yp0lplrt}], simpUser=f61f4b8710464a86983f86027962fe49, simpSessionId=yp0lplrt}]
2025-12-19 01:03:09.501 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:03:09.501 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:03:09.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: yp0lplrt
2025-12-19 01:03:09.502 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:03:09.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f61f4b8710464a86983f86027962fe49
2025-12-19 01:03:09.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:03:09.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:03:09.504 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=zcv1j2fq
2025-12-19 01:03:09.504 [clientOutboundChannel-3] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session zcv1j2fq
java.lang.IllegalStateException: Cannot send a message when session is closed
	at org.springframework.util.Assert.state(Assert.java:76)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:168)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 01:03:09.504 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=yp0lplrt
2025-12-19 01:03:09.505 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=0d542dcb65c74a64838f34a17b1665d5, simpSessionId=zcv1j2fq}], simpUser=0d542dcb65c74a64838f34a17b1665d5, simpSessionId=zcv1j2fq}]
2025-12-19 01:03:09.506 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=f61f4b8710464a86983f86027962fe49, simpSessionId=yp0lplrt}], simpUser=f61f4b8710464a86983f86027962fe49, simpSessionId=yp0lplrt}]
2025-12-19 01:03:10.030 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:14.499 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [zcv1j2fq]
2025-12-19 01:03:15.058 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:19.500 [MessageBroker-2] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [yp0lplrt]
2025-12-19 01:03:20.065 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:25.076 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:30.099 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:35.117 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:40.131 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:41.041 [MessageBroker-3] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 11]
2025-12-19 01:03:45.144 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:50.158 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:03:55.175 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:04:19.537 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 51004 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 01:04:19.558 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 01:04:19.561 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 01:04:20.891 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 01:04:20.897 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 01:04:20.945 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 23 ms. Found 0 Redis repository interfaces.
2025-12-19 01:04:21.718 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 01:04:21.731 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 01:04:21.732 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 01:04:21.733 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 01:04:21.851 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 01:04:21.851 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2141 ms
2025-12-19 01:04:23.265 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 01:04:23.326 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@14bee915, started on Fri Dec 19 01:04:19 GMT+08:00 2025
2025-12-19 01:04:23.415 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 01:04:23.420 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 01:04:23.421 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 01:04:23.431 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 01:04:23.468 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 01:04:23.686 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 01:04:24.310 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 01:04:24.345 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 01:04:24.347 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 01:04:24.348 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 01:04:24.348 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 01:04:24.349 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]
2025-12-19 01:04:24.349 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]
2025-12-19 01:04:24.349 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]]
2025-12-19 01:04:24.349 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 01:04:24.350 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:04:24.350 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:04:24.820 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:04:24.821 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:04:24.824 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-12-19 01:04:25.151 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:04:29.359 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:04:29.463 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@52b32b70 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 60253]
2025-12-19 01:04:29.545 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 11.229 seconds (JVM running for 12.094)
2025-12-19 01:04:30.167 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:04:30.215 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:04:30.219 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:04:30.232 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:04:30.232 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/349/4ah1i1ig/websocket
2025-12-19 01:04:30.238 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 366e63501cd546a2bffcf6a07526ae4b
2025-12-19 01:04:30.292 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=4ah1i1ig]
2025-12-19 01:04:30.333 [http-nio-8080-exec-4] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:04:30.334 [http-nio-8080-exec-4] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=366e63501cd546a2bffcf6a07526ae4b session=4ah1i1ig
2025-12-19 01:04:30.336 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:04:30.337 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:04:30.337 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:04:30.337 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 4ah1i1ig
2025-12-19 01:04:30.338 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 366e63501cd546a2bffcf6a07526ae4b
2025-12-19 01:04:30.338 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:04:30.338 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:04:30.341 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=366e63501cd546a2bffcf6a07526ae4b session=4ah1i1ig
2025-12-19 01:04:30.346 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[366e63501cd546a2bffcf6a07526ae4b]}
2025-12-19 01:04:32.368 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:04:32.370 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:04:32.377 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:04:32.378 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/063/w5jodm3n/websocket
2025-12-19 01:04:32.379 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 1495acb3623248e79dd46f2f7f4eabf9
2025-12-19 01:04:32.381 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=w5jodm3n]
2025-12-19 01:04:32.384 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:04:32.385 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=1495acb3623248e79dd46f2f7f4eabf9 session=w5jodm3n
2025-12-19 01:04:32.385 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:04:32.385 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:04:32.386 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:04:32.386 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: w5jodm3n
2025-12-19 01:04:32.386 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 1495acb3623248e79dd46f2f7f4eabf9
2025-12-19 01:04:32.386 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:04:32.387 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:04:32.389 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=1495acb3623248e79dd46f2f7f4eabf9 session=w5jodm3n
2025-12-19 01:04:32.390 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[1495acb3623248e79dd46f2f7f4eabf9]}
2025-12-19 01:04:34.428 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:04:34.429 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=w5jodm3n
2025-12-19 01:04:34.429 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:04:34.429 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:04:34.430 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:04:34.430 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: w5jodm3n
2025-12-19 01:04:34.430 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 1495acb3623248e79dd46f2f7f4eabf9
2025-12-19 01:04:34.430 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:04:34.430 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:04:34.432 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=w5jodm3n
2025-12-19 01:04:34.433 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userw5jodm3n]
2025-12-19 01:04:34.434 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userw5jodm3n subscriptionId=sub-0 session=w5jodm3n user=1495acb3623248e79dd46f2f7f4eabf9 payload=byte[0]
2025-12-19 01:04:35.184 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:04:37.977 [http-nio-8080-exec-10] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:04:37.979 [http-nio-8080-exec-10] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=4ah1i1ig
2025-12-19 01:04:37.979 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:04:37.979 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:04:37.979 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:04:37.980 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 4ah1i1ig
2025-12-19 01:04:37.980 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 366e63501cd546a2bffcf6a07526ae4b
2025-12-19 01:04:37.980 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:04:37.981 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:04:37.981 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:04:37.981 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 48, 52, 58, 51, 55, 34, 44, 34, 105, 100, 34, 58, 34, 49, 52, 57, 53, 97, 99, 98, 51, 54, 50, 51, 50, 52, 56, 101, 55, 57, 100, 100, 52, 54, 102, 50, 102, 55, 102, 52, 101, 97, 98, 102, 57, 34, 125]
2025-12-19 01:04:37.981 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@649a7078, simpUser=366e63501cd546a2bffcf6a07526ae4b, simpSessionId=4ah1i1ig, simpDestination=/ws/privateMessage}
2025-12-19 01:04:37.982 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:04:37","id":"1495acb3623248e79dd46f2f7f4eabf9"}
2025-12-19 01:04:37.982 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:04:37.982 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:04:37.982 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:04:37.982 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:04:37.983 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:04:37.985 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:04:37.985 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@649a7078, simpUser=366e63501cd546a2bffcf6a07526ae4b, simpSessionId=4ah1i1ig, simpDestination=/ws/privateMessage}
2025-12-19 01:04:40.210 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:04:45.230 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:04:50.153 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:04:50.155 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=4ah1i1ig
2025-12-19 01:04:50.156 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:04:50.158 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:04:50.159 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:04:50.159 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:04:50.160 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=w5jodm3n
2025-12-19 01:04:50.160 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 4ah1i1ig
2025-12-19 01:04:50.161 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:04:50.161 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 366e63501cd546a2bffcf6a07526ae4b
2025-12-19 01:04:50.162 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:04:50.162 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:04:50.163 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:04:50.162 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:04:50.163 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: w5jodm3n
2025-12-19 01:04:50.164 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 1495acb3623248e79dd46f2f7f4eabf9
2025-12-19 01:04:50.164 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:04:50.165 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:04:50.165 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=4ah1i1ig
2025-12-19 01:04:50.165 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=4ah1i1ig] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:04:50.166 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=w5jodm3n
2025-12-19 01:04:50.166 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 4ah1i1ig
2025-12-19 01:04:50.166 [clientOutboundChannel-3] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP ERROR, headers={message=[Session closed.]}
2025-12-19 01:04:50.166 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=w5jodm3n] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:04:50.167 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:04:50.168 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session w5jodm3n
2025-12-19 01:04:50.168 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:04:50.168 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:04:50.169 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:04:50.169 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:04:50.169 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 4ah1i1ig
2025-12-19 01:04:50.169 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@58c62da0, simpUser=1495acb3623248e79dd46f2f7f4eabf9, simpSessionId=w5jodm3n}], simpUser=1495acb3623248e79dd46f2f7f4eabf9, simpSessionId=w5jodm3n}]
2025-12-19 01:04:50.169 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:04:50.169 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 366e63501cd546a2bffcf6a07526ae4b
2025-12-19 01:04:50.169 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: w5jodm3n
2025-12-19 01:04:50.169 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:04:50.170 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 1495acb3623248e79dd46f2f7f4eabf9
2025-12-19 01:04:50.170 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:04:50.170 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:04:50.170 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:04:50.172 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=4ah1i1ig
2025-12-19 01:04:50.173 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=w5jodm3n
2025-12-19 01:04:50.173 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=366e63501cd546a2bffcf6a07526ae4b, simpSessionId=4ah1i1ig}], simpUser=366e63501cd546a2bffcf6a07526ae4b, simpSessionId=4ah1i1ig}]
2025-12-19 01:04:50.173 [clientOutboundChannel-3] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session 4ah1i1ig
java.lang.IllegalStateException: Cannot send a message when session is closed
	at org.springframework.util.Assert.state(Assert.java:76)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:168)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 01:04:50.174 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=1495acb3623248e79dd46f2f7f4eabf9, simpSessionId=w5jodm3n}], simpUser=1495acb3623248e79dd46f2f7f4eabf9, simpSessionId=w5jodm3n}]
2025-12-19 01:04:50.258 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:04:55.243 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [w5jodm3n, 4ah1i1ig]
2025-12-19 01:04:55.283 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:00.307 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:05.328 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:10.345 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:15.364 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:20.378 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:23.293 [MessageBroker-2] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 11]
2025-12-19 01:05:25.408 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:30.431 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:35.450 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:40.465 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:45.480 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:50.492 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:05:55.497 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:00.518 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:05.531 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:10.542 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:15.551 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:20.560 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:25.577 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:30.580 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:35.592 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:40.602 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:45.612 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:06:50.629 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:07:26.743 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 51712 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 01:07:26.754 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 01:07:26.757 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 01:07:27.498 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 01:07:27.502 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 01:07:27.544 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 22 ms. Found 0 Redis repository interfaces.
2025-12-19 01:07:28.738 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 01:07:28.763 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 01:07:28.764 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 01:07:28.764 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 01:07:28.968 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 01:07:28.970 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2120 ms
2025-12-19 01:07:30.193 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 01:07:30.268 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@14bee915, started on Fri Dec 19 01:07:26 GMT+08:00 2025
2025-12-19 01:07:30.382 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 01:07:30.390 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 01:07:30.391 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 01:07:30.398 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 01:07:30.464 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 01:07:30.762 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 01:07:31.438 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 01:07:31.468 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 01:07:31.471 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 01:07:31.471 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[ws/]]
2025-12-19 01:07:31.471 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 01:07:31.471 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]
2025-12-19 01:07:31.472 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]
2025-12-19 01:07:31.472 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]]
2025-12-19 01:07:31.473 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 01:07:31.473 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:07:31.473 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:07:32.013 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:07:35.681 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:07:35.682 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:07:35.682 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-12-19 01:07:36.477 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:07:36.540 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@52b32b70 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 60321]
2025-12-19 01:07:36.618 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 11.068 seconds (JVM running for 11.817)
2025-12-19 01:07:37.028 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:07:41.038 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:07:41.040 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:07:41.051 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:07:41.051 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/718/fosiixqv/websocket
2025-12-19 01:07:41.058 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 2f4871dcefb548abac44c4055137bb25
2025-12-19 01:07:41.092 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=fosiixqv]
2025-12-19 01:07:41.114 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:07:41.115 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=2f4871dcefb548abac44c4055137bb25 session=fosiixqv
2025-12-19 01:07:41.115 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:07:41.116 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:07:41.116 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:07:41.116 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: fosiixqv
2025-12-19 01:07:41.117 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2f4871dcefb548abac44c4055137bb25
2025-12-19 01:07:41.117 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:07:41.117 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:07:41.118 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=2f4871dcefb548abac44c4055137bb25 session=fosiixqv
2025-12-19 01:07:41.123 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[2f4871dcefb548abac44c4055137bb25]}
2025-12-19 01:07:42.041 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:07:43.151 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:07:43.152 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:07:43.158 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:07:43.159 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/439/dauycxog/websocket
2025-12-19 01:07:43.159 [http-nio-8080-exec-7] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 6bc537c909a8426987cb434f175d52e1
2025-12-19 01:07:43.161 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=dauycxog]
2025-12-19 01:07:43.163 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:07:43.163 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=6bc537c909a8426987cb434f175d52e1 session=dauycxog
2025-12-19 01:07:43.163 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:07:43.163 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:07:43.163 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:07:43.163 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: dauycxog
2025-12-19 01:07:43.164 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6bc537c909a8426987cb434f175d52e1
2025-12-19 01:07:43.164 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:07:43.164 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:07:43.164 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=6bc537c909a8426987cb434f175d52e1 session=dauycxog
2025-12-19 01:07:43.165 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[6bc537c909a8426987cb434f175d52e1]}
2025-12-19 01:07:45.184 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:07:45.185 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=dauycxog
2025-12-19 01:07:45.186 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:07:45.186 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:07:45.187 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:07:45.187 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: dauycxog
2025-12-19 01:07:45.188 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6bc537c909a8426987cb434f175d52e1
2025-12-19 01:07:45.188 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:07:45.188 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:07:45.190 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=dauycxog
2025-12-19 01:07:45.191 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userdauycxog]
2025-12-19 01:07:45.192 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userdauycxog subscriptionId=sub-0 session=dauycxog user=6bc537c909a8426987cb434f175d52e1 payload=byte[0]
2025-12-19 01:07:47.057 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:07:48.741 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:07:48.741 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=fosiixqv
2025-12-19 01:07:48.742 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:07:48.742 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:07:48.742 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:07:48.742 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: fosiixqv
2025-12-19 01:07:48.742 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2f4871dcefb548abac44c4055137bb25
2025-12-19 01:07:48.742 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:07:48.743 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:07:48.743 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:07:48.743 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 48, 55, 58, 52, 56, 34, 44, 34, 105, 100, 34, 58, 34, 54, 98, 99, 53, 51, 55, 99, 57, 48, 57, 97, 56, 52, 50, 54, 57, 56, 55, 99, 98, 52, 51, 52, 102, 49, 55, 53, 100, 53, 50, 101, 49, 34, 125]
2025-12-19 01:07:48.744 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@40cd6990, simpUser=2f4871dcefb548abac44c4055137bb25, simpSessionId=fosiixqv, simpDestination=/ws/privateMessage}
2025-12-19 01:07:48.744 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:07:48","id":"6bc537c909a8426987cb434f175d52e1"}
2025-12-19 01:07:48.744 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:07:48.744 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:07:48.744 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:07:48.744 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:07:48.744 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:07:48.744 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:07:48.744 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@40cd6990, simpUser=2f4871dcefb548abac44c4055137bb25, simpSessionId=fosiixqv, simpDestination=/ws/privateMessage}
2025-12-19 01:07:52.081 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:07:57.100 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:01.024 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:08:01.025 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=fosiixqv
2025-12-19 01:08:01.025 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:08:01.025 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:08:01.025 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:08:01.026 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=dauycxog
2025-12-19 01:08:01.026 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:08:01.026 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:08:01.026 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: fosiixqv
2025-12-19 01:08:01.027 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:08:01.027 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2f4871dcefb548abac44c4055137bb25
2025-12-19 01:08:01.027 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:08:01.027 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:08:01.028 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: dauycxog
2025-12-19 01:08:01.028 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:08:01.028 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6bc537c909a8426987cb434f175d52e1
2025-12-19 01:08:01.028 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:08:01.028 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:08:01.028 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=fosiixqv
2025-12-19 01:08:01.028 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=fosiixqv] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:08:01.029 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=dauycxog
2025-12-19 01:08:01.029 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session fosiixqv
2025-12-19 01:08:01.029 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=dauycxog] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:08:01.029 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session dauycxog
2025-12-19 01:08:01.030 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@58c62da0, simpUser=2f4871dcefb548abac44c4055137bb25, simpSessionId=fosiixqv}], simpUser=2f4871dcefb548abac44c4055137bb25, simpSessionId=fosiixqv}]
2025-12-19 01:08:01.030 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:08:01.030 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:08:01.030 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:08:01.030 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:08:01.030 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:08:01.030 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@1c0554c2, simpUser=6bc537c909a8426987cb434f175d52e1, simpSessionId=dauycxog}], simpUser=6bc537c909a8426987cb434f175d52e1, simpSessionId=dauycxog}]
2025-12-19 01:08:01.030 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:08:01.030 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: fosiixqv
2025-12-19 01:08:01.031 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: dauycxog
2025-12-19 01:08:01.031 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2f4871dcefb548abac44c4055137bb25
2025-12-19 01:08:01.031 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6bc537c909a8426987cb434f175d52e1
2025-12-19 01:08:01.031 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:08:01.031 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:08:01.031 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:08:01.031 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:08:01.032 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=fosiixqv
2025-12-19 01:08:01.032 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=dauycxog
2025-12-19 01:08:01.032 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=2f4871dcefb548abac44c4055137bb25, simpSessionId=fosiixqv}], simpUser=2f4871dcefb548abac44c4055137bb25, simpSessionId=fosiixqv}]
2025-12-19 01:08:01.033 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=6bc537c909a8426987cb434f175d52e1, simpSessionId=dauycxog}], simpUser=6bc537c909a8426987cb434f175d52e1, simpSessionId=dauycxog}]
2025-12-19 01:08:02.128 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:06.063 [MessageBroker-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [fosiixqv, dauycxog]
2025-12-19 01:08:07.144 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:12.166 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:17.178 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:22.201 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:27.213 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:30.230 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 10]
2025-12-19 01:08:32.232 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:37.243 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:42.268 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:47.289 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:52.307 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:08:57.325 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:09:02.331 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:09:07.351 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:09:12.371 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:09:17.377 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:09:22.390 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:09:49.007 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 26908 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 01:09:49.018 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 01:09:49.021 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 01:09:49.781 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 01:09:49.784 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 01:09:49.808 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 11 ms. Found 0 Redis repository interfaces.
2025-12-19 01:09:50.286 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 01:09:50.295 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 01:09:50.295 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 01:09:50.296 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 01:09:50.363 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 01:09:50.363 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1258 ms
2025-12-19 01:09:51.162 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 01:09:51.226 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@14bee915, started on Fri Dec 19 01:09:49 GMT+08:00 2025
2025-12-19 01:09:51.305 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 01:09:51.309 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 01:09:51.311 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 01:09:51.319 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 01:09:51.359 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 01:09:51.582 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 01:09:52.161 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 01:09:52.190 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 01:09:52.191 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 01:09:52.192 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 01:09:52.192 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 01:09:52.193 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]
2025-12-19 01:09:52.193 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]
2025-12-19 01:09:52.194 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]]
2025-12-19 01:09:52.194 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 01:09:52.194 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:09:52.194 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:09:52.710 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:09:53.357 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:09:53.358 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:09:53.359 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 01:09:57.205 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:09:57.297 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@52b32b70 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 60001]
2025-12-19 01:09:57.431 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 9.047 seconds (JVM running for 9.4)
2025-12-19 01:09:57.738 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:09:58.712 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:09:58.715 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:09:58.726 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:09:58.727 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/083/rbxz1jf0/websocket
2025-12-19 01:09:58.731 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: d959719e9627473a8f5b28cb2bbe0545
2025-12-19 01:09:58.779 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=rbxz1jf0]
2025-12-19 01:09:58.810 [http-nio-8080-exec-4] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:09:58.811 [http-nio-8080-exec-4] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=d959719e9627473a8f5b28cb2bbe0545 session=rbxz1jf0
2025-12-19 01:09:58.813 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:09:58.814 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:09:58.814 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:09:58.814 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: rbxz1jf0
2025-12-19 01:09:58.815 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d959719e9627473a8f5b28cb2bbe0545
2025-12-19 01:09:58.815 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:09:58.815 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:09:58.818 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=d959719e9627473a8f5b28cb2bbe0545 session=rbxz1jf0
2025-12-19 01:09:58.823 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[d959719e9627473a8f5b28cb2bbe0545]}
2025-12-19 01:10:00.851 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:10:00.853 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:10:00.859 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:10:00.859 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/669/h5211qzo/websocket
2025-12-19 01:10:00.860 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 9841d87ed9aa4920bed23699ffdfee05
2025-12-19 01:10:00.863 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=h5211qzo]
2025-12-19 01:10:00.865 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:10:00.866 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=9841d87ed9aa4920bed23699ffdfee05 session=h5211qzo
2025-12-19 01:10:00.866 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:00.866 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:10:00.867 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:10:00.867 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: h5211qzo
2025-12-19 01:10:00.867 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 9841d87ed9aa4920bed23699ffdfee05
2025-12-19 01:10:00.868 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:00.868 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:10:00.869 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=9841d87ed9aa4920bed23699ffdfee05 session=h5211qzo
2025-12-19 01:10:00.870 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[9841d87ed9aa4920bed23699ffdfee05]}
2025-12-19 01:10:02.762 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:10:02.891 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:10:02.891 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=h5211qzo
2025-12-19 01:10:02.891 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:02.891 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:10:02.892 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:10:02.892 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: h5211qzo
2025-12-19 01:10:02.892 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 9841d87ed9aa4920bed23699ffdfee05
2025-12-19 01:10:02.893 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:02.893 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:10:02.894 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=h5211qzo
2025-12-19 01:10:02.895 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userh5211qzo]
2025-12-19 01:10:02.896 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userh5211qzo subscriptionId=sub-0 session=h5211qzo user=9841d87ed9aa4920bed23699ffdfee05 payload=byte[0]
2025-12-19 01:10:06.459 [http-nio-8080-exec-10] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:10:06.459 [http-nio-8080-exec-10] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=rbxz1jf0
2025-12-19 01:10:06.459 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:06.460 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:10:06.460 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:10:06.460 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: rbxz1jf0
2025-12-19 01:10:06.461 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d959719e9627473a8f5b28cb2bbe0545
2025-12-19 01:10:06.462 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:06.463 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:10:06.463 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:10:06.463 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 49, 48, 58, 48, 54, 34, 44, 34, 105, 100, 34, 58, 34, 57, 56, 52, 49, 100, 56, 55, 101, 100, 57, 97, 97, 52, 57, 50, 48, 98, 101, 100, 50, 51, 54, 57, 57, 102, 102, 100, 102, 101, 101, 48, 53, 34, 125]
2025-12-19 01:10:06.463 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@308f000e, simpUser=d959719e9627473a8f5b28cb2bbe0545, simpSessionId=rbxz1jf0, simpDestination=/ws/privateMessage}
2025-12-19 01:10:06.464 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:10:06","id":"9841d87ed9aa4920bed23699ffdfee05"}
2025-12-19 01:10:06.464 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:10:06.464 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:10:06.465 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:10:06.465 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:06.465 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:10:06.466 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:10:06.467 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@308f000e, simpUser=d959719e9627473a8f5b28cb2bbe0545, simpSessionId=rbxz1jf0, simpDestination=/ws/privateMessage}
2025-12-19 01:10:06.468 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=rbxz1jf0, lookupDestination='/privateMessage'
2025-12-19 01:10:06.472 [clientInboundChannel-10] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 01:10:06.472 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 01:10:06.545 [clientInboundChannel-10] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [d959719e9627473a8f5b28cb2bbe0545, Message(content=測試私信 - 上午1:10:06, recipient=null, id=9841d87ed9aa4920bed23699ffdfee05)]
2025-12-19 01:10:06.546 [clientInboundChannel-10] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 01:10:06.546 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 01:10:06.547 [clientInboundChannel-10] INFO  c.h.s.MessageController - 收到私信請求，發送者: d959719e9627473a8f5b28cb2bbe0545
2025-12-19 01:10:06.548 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息物件: Message(content=測試私信 - 上午1:10:06, recipient=null, id=9841d87ed9aa4920bed23699ffdfee05)
2025-12-19 01:10:06.553 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 01:10:06.553 [clientInboundChannel-10] INFO  c.h.s.MessageController - 發送者ID: d959719e9627473a8f5b28cb2bbe0545
2025-12-19 01:10:06.553 [clientInboundChannel-10] INFO  c.h.s.MessageController - 接收者ID: 9841d87ed9aa4920bed23699ffdfee05
2025-12-19 01:10:06.554 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息內容: 測試私信 - 上午1:10:06
2025-12-19 01:10:06.554 [clientInboundChannel-10] INFO  c.h.s.MessageController - 目標路徑: /user/9841d87ed9aa4920bed23699ffdfee05/topic/privateMessage
2025-12-19 01:10:06.573 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/9841d87ed9aa4920bed23699ffdfee05/topic/privateMessage session=null payload={"content":"用戶：d959719e9627473a8f5b28cb2bbe0545發送的信息：測試私...(truncated)
2025-12-19 01:10:06.578 [clientInboundChannel-10] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/9841d87ed9aa4920bed23699ffdfee05/topic/privateMessage -> [/topic/privateMessage-userh5211qzo]
2025-12-19 01:10:06.578 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-userh5211qzo session=null payload={"content":"用戶：d959719e9627473a8f5b28cb2bbe0545發送的信息：測試私...(truncated)
2025-12-19 01:10:06.578 [clientInboundChannel-10] INFO  c.h.s.MessageController - 私信已發送到目標用戶: 9841d87ed9aa4920bed23699ffdfee05
2025-12-19 01:10:06.579 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 01:10:07.778 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:10:12.806 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:10:17.817 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:10:18.630 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:10:18.631 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:10:18.631 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=rbxz1jf0
2025-12-19 01:10:18.631 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=h5211qzo
2025-12-19 01:10:18.631 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:18.632 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:18.632 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:10:18.632 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:10:18.632 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:10:18.633 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: rbxz1jf0
2025-12-19 01:10:18.633 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:10:18.633 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d959719e9627473a8f5b28cb2bbe0545
2025-12-19 01:10:18.633 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: h5211qzo
2025-12-19 01:10:18.635 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:18.635 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 9841d87ed9aa4920bed23699ffdfee05
2025-12-19 01:10:18.636 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:10:18.636 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:18.636 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:10:18.637 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=rbxz1jf0
2025-12-19 01:10:18.637 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=h5211qzo
2025-12-19 01:10:18.638 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=h5211qzo] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:10:18.638 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=rbxz1jf0] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:10:18.638 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session h5211qzo
2025-12-19 01:10:18.638 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session rbxz1jf0
2025-12-19 01:10:18.638 [clientOutboundChannel-3] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP ERROR, headers={message=[Session closed.]}
2025-12-19 01:10:18.639 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@4429cdcb, simpUser=9841d87ed9aa4920bed23699ffdfee05, simpSessionId=h5211qzo}], simpUser=9841d87ed9aa4920bed23699ffdfee05, simpSessionId=h5211qzo}]
2025-12-19 01:10:18.639 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:18.639 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:18.639 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:10:18.639 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:10:18.640 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:10:18.640 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:10:18.640 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: h5211qzo
2025-12-19 01:10:18.640 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: rbxz1jf0
2025-12-19 01:10:18.640 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 9841d87ed9aa4920bed23699ffdfee05
2025-12-19 01:10:18.640 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d959719e9627473a8f5b28cb2bbe0545
2025-12-19 01:10:18.640 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:18.640 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:18.640 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:10:18.641 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:10:18.641 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=h5211qzo
2025-12-19 01:10:18.641 [clientInboundChannel-22] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=rbxz1jf0
2025-12-19 01:10:18.641 [clientOutboundChannel-3] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session rbxz1jf0
java.lang.IllegalStateException: Cannot send a message when session is closed
	at org.springframework.util.Assert.state(Assert.java:76)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:168)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 01:10:18.642 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=9841d87ed9aa4920bed23699ffdfee05, simpSessionId=h5211qzo}], simpUser=9841d87ed9aa4920bed23699ffdfee05, simpSessionId=h5211qzo}]
2025-12-19 01:10:18.642 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=d959719e9627473a8f5b28cb2bbe0545, simpSessionId=rbxz1jf0}], simpUser=d959719e9627473a8f5b28cb2bbe0545, simpSessionId=rbxz1jf0}]
2025-12-19 01:10:22.845 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:10:23.729 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [h5211qzo, rbxz1jf0]
2025-12-19 01:10:25.794 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:10:25.795 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766077825790
2025-12-19 01:10:25.811 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:10:25.830 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/827/xvixiatc/websocket
2025-12-19 01:10:25.835 [http-nio-8080-exec-5] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 2b1aac609a2044418bd077841f320bd2
2025-12-19 01:10:25.851 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=xvixiatc]
2025-12-19 01:10:25.857 [http-nio-8080-exec-6] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 01:10:25.858 [http-nio-8080-exec-6] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=2b1aac609a2044418bd077841f320bd2 session=xvixiatc
2025-12-19 01:10:25.859 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:25.859 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:10:25.860 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:10:25.861 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: xvixiatc
2025-12-19 01:10:25.861 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2b1aac609a2044418bd077841f320bd2
2025-12-19 01:10:25.861 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:25.862 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:10:25.862 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=2b1aac609a2044418bd077841f320bd2 session=xvixiatc
2025-12-19 01:10:25.863 [clientOutboundChannel-7] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[2b1aac609a2044418bd077841f320bd2]}
2025-12-19 01:10:25.867 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 01:10:25.867 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=xvixiatc
2025-12-19 01:10:25.868 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:25.869 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:10:25.869 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 01:10:25.870 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: xvixiatc
2025-12-19 01:10:25.870 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2b1aac609a2044418bd077841f320bd2
2025-12-19 01:10:25.870 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:25.871 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:10:25.872 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=xvixiatc
2025-12-19 01:10:25.873 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:10:25.873 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=xvixiatc
2025-12-19 01:10:25.873 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:25.874 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:10:25.874 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:10:25.874 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: xvixiatc
2025-12-19 01:10:25.874 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2b1aac609a2044418bd077841f320bd2
2025-12-19 01:10:25.874 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:25.874 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:10:25.876 [clientInboundChannel-1] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userxvixiatc]
2025-12-19 01:10:25.877 [clientInboundChannel-32] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=xvixiatc
2025-12-19 01:10:25.877 [clientInboundChannel-1] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userxvixiatc subscriptionId=sub-1 session=xvixiatc user=2b1aac609a2044418bd077841f320bd2 payload=byte[0]
2025-12-19 01:10:27.469 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=xvixiatc] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:10:27.470 [http-nio-8080-exec-9] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session xvixiatc
2025-12-19 01:10:27.471 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:27.471 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:10:27.472 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:10:27.472 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: xvixiatc
2025-12-19 01:10:27.473 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2b1aac609a2044418bd077841f320bd2
2025-12-19 01:10:27.474 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:27.474 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:10:27.475 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=xvixiatc
2025-12-19 01:10:27.476 [clientOutboundChannel-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=2b1aac609a2044418bd077841f320bd2, simpSessionId=xvixiatc}], simpUser=2b1aac609a2044418bd077841f320bd2, simpSessionId=xvixiatc}]
2025-12-19 01:10:27.525 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:10:27.526 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766077827518
2025-12-19 01:10:27.541 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:10:27.542 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/592/reuc4jsa/websocket
2025-12-19 01:10:27.543 [http-nio-8080-exec-1] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: f649ec68a8064e95be538150754f4b6f
2025-12-19 01:10:27.547 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=reuc4jsa]
2025-12-19 01:10:27.551 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 01:10:27.551 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=f649ec68a8064e95be538150754f4b6f session=reuc4jsa
2025-12-19 01:10:27.551 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:27.551 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:10:27.551 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:10:27.552 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: reuc4jsa
2025-12-19 01:10:27.553 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f649ec68a8064e95be538150754f4b6f
2025-12-19 01:10:27.553 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:27.553 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:10:27.554 [clientInboundChannel-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=f649ec68a8064e95be538150754f4b6f session=reuc4jsa
2025-12-19 01:10:27.556 [clientOutboundChannel-9] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[f649ec68a8064e95be538150754f4b6f]}
2025-12-19 01:10:27.560 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 01:10:27.560 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=reuc4jsa
2025-12-19 01:10:27.561 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:27.561 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:10:27.561 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 01:10:27.562 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: reuc4jsa
2025-12-19 01:10:27.562 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f649ec68a8064e95be538150754f4b6f
2025-12-19 01:10:27.562 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:27.563 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:10:27.563 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=reuc4jsa
2025-12-19 01:10:27.563 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:10:27.563 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=reuc4jsa
2025-12-19 01:10:27.563 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:27.563 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:10:27.564 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:10:27.564 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: reuc4jsa
2025-12-19 01:10:27.564 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f649ec68a8064e95be538150754f4b6f
2025-12-19 01:10:27.568 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:27.569 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:10:27.570 [clientInboundChannel-12] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=reuc4jsa
2025-12-19 01:10:27.570 [clientInboundChannel-10] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userreuc4jsa]
2025-12-19 01:10:27.570 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userreuc4jsa subscriptionId=sub-1 session=reuc4jsa user=f649ec68a8064e95be538150754f4b6f payload=byte[0]
2025-12-19 01:10:27.863 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:10:30.219 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:10:30.220 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766077830215
2025-12-19 01:10:30.230 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:10:30.231 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/923/ugrhshlv/websocket
2025-12-19 01:10:30.232 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 5e4f973a177a4a83b995d19b940bb237
2025-12-19 01:10:30.236 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ugrhshlv]
2025-12-19 01:10:30.245 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 01:10:30.247 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=5e4f973a177a4a83b995d19b940bb237 session=ugrhshlv
2025-12-19 01:10:30.247 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:30.247 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:10:30.247 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:10:30.248 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: ugrhshlv
2025-12-19 01:10:30.248 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 5e4f973a177a4a83b995d19b940bb237
2025-12-19 01:10:30.248 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:30.248 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:10:30.248 [clientInboundChannel-16] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=5e4f973a177a4a83b995d19b940bb237 session=ugrhshlv
2025-12-19 01:10:30.250 [clientOutboundChannel-10] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[5e4f973a177a4a83b995d19b940bb237]}
2025-12-19 01:10:30.254 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 01:10:30.255 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=ugrhshlv
2025-12-19 01:10:30.255 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:30.256 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:10:30.256 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 01:10:30.256 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: ugrhshlv
2025-12-19 01:10:30.256 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 5e4f973a177a4a83b995d19b940bb237
2025-12-19 01:10:30.257 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:30.258 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:10:30.258 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=ugrhshlv
2025-12-19 01:10:30.258 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:10:30.259 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=ugrhshlv
2025-12-19 01:10:30.259 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:30.259 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:10:30.259 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:10:30.259 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: ugrhshlv
2025-12-19 01:10:30.259 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 5e4f973a177a4a83b995d19b940bb237
2025-12-19 01:10:30.259 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:30.261 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:10:30.261 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=ugrhshlv
2025-12-19 01:10:30.261 [clientInboundChannel-23] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userugrhshlv]
2025-12-19 01:10:30.261 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userugrhshlv subscriptionId=sub-1 session=ugrhshlv user=5e4f973a177a4a83b995d19b940bb237 payload=byte[0]
2025-12-19 01:10:32.888 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:10:33.730 [MessageBroker-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [xvixiatc]
2025-12-19 01:10:37.906 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:10:42.921 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:10:47.940 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:10:48.114 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[57]} session=null
2025-12-19 01:10:48.115 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=reuc4jsa
2025-12-19 01:10:48.116 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:10:48.117 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:10:48.117 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:10:48.118 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: reuc4jsa
2025-12-19 01:10:48.118 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: f649ec68a8064e95be538150754f4b6f
2025-12-19 01:10:48.118 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:48.119 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:10:48.119 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:10:48.119 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, 97, 97, 97, 34, 44, 34, 105, 100, 34, 58, 34, 53, 101, 52, 102, 57, 55, 51, 97, 49, 55, 55, 97, 52, 97, 56, 51, 98, 57, 57, 53, 100, 49, 57, 98, 57, 52, 48, 98, 98, 50, 51, 55, 34, 125]
2025-12-19 01:10:48.119 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[57]}, simpSessionAttributes={}, simpHeartbeat=[J@1035fbae, simpUser=f649ec68a8064e95be538150754f4b6f, simpSessionId=reuc4jsa, simpDestination=/ws/privateMessage}
2025-12-19 01:10:48.120 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"aaa","id":"5e4f973a177a4a83b995d19b940bb237"}
2025-12-19 01:10:48.120 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:10:48.121 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:10:48.121 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:10:48.122 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:10:48.122 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:10:48.122 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:10:48.122 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[57]}, simpSessionAttributes={}, simpHeartbeat=[J@1035fbae, simpUser=f649ec68a8064e95be538150754f4b6f, simpSessionId=reuc4jsa, simpDestination=/ws/privateMessage}
2025-12-19 01:10:48.122 [clientInboundChannel-21] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=reuc4jsa, lookupDestination='/privateMessage'
2025-12-19 01:10:48.122 [clientInboundChannel-21] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 01:10:48.122 [clientInboundChannel-21] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 01:10:48.123 [clientInboundChannel-21] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [f649ec68a8064e95be538150754f4b6f, Message(content=aaa, recipient=null, id=5e4f973a177a4a83b995d19b940bb237)]
2025-12-19 01:10:48.123 [clientInboundChannel-21] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 01:10:48.123 [clientInboundChannel-21] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 01:10:48.123 [clientInboundChannel-21] INFO  c.h.s.MessageController - 收到私信請求，發送者: f649ec68a8064e95be538150754f4b6f
2025-12-19 01:10:48.123 [clientInboundChannel-21] INFO  c.h.s.MessageController - 訊息物件: Message(content=aaa, recipient=null, id=5e4f973a177a4a83b995d19b940bb237)
2025-12-19 01:10:48.123 [clientInboundChannel-21] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 01:10:48.123 [clientInboundChannel-21] INFO  c.h.s.MessageController - 發送者ID: f649ec68a8064e95be538150754f4b6f
2025-12-19 01:10:48.123 [clientInboundChannel-21] INFO  c.h.s.MessageController - 接收者ID: 5e4f973a177a4a83b995d19b940bb237
2025-12-19 01:10:48.124 [clientInboundChannel-21] INFO  c.h.s.MessageController - 訊息內容: aaa
2025-12-19 01:10:48.124 [clientInboundChannel-21] INFO  c.h.s.MessageController - 目標路徑: /user/5e4f973a177a4a83b995d19b940bb237/topic/privateMessage
2025-12-19 01:10:48.124 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/5e4f973a177a4a83b995d19b940bb237/topic/privateMessage session=null payload={"content":"用戶：f649ec68a8064e95be538150754f4b6f發送的信息：aaa"}
2025-12-19 01:10:48.124 [clientInboundChannel-21] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/5e4f973a177a4a83b995d19b940bb237/topic/privateMessage -> [/topic/privateMessage-userugrhshlv]
2025-12-19 01:10:48.124 [clientInboundChannel-21] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-userugrhshlv session=null payload={"content":"用戶：f649ec68a8064e95be538150754f4b6f發送的信息：aaa"}
2025-12-19 01:10:48.124 [clientInboundChannel-21] INFO  c.h.s.MessageController - 私信已發送到目標用戶: 5e4f973a177a4a83b995d19b940bb237
2025-12-19 01:10:48.125 [clientInboundChannel-21] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 01:10:51.187 [MessageBroker-2] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[2 current WS(2)-HttpStream(0)-HttpPoll(0), 5 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(5)-CONNECTED(5)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 32, active threads = 0, queued tasks = 0, completed tasks = 57], outboundChannel[pool size = 10, active threads = 0, queued tasks = 0, completed tasks = 10], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 3, completed tasks = 11]
2025-12-19 01:10:52.967 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:11:19.746 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 42324 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 01:11:19.760 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 01:11:19.762 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 01:11:20.456 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 01:11:20.464 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 01:11:20.499 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 14 ms. Found 0 Redis repository interfaces.
2025-12-19 01:11:21.172 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 01:11:21.186 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 01:11:21.187 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 01:11:21.189 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 01:11:21.287 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 01:11:21.291 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1445 ms
2025-12-19 01:11:22.946 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 01:11:23.097 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@14bee915, started on Fri Dec 19 01:11:19 GMT+08:00 2025
2025-12-19 01:11:23.227 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 01:11:23.234 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 01:11:23.235 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 01:11:23.244 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 01:11:23.313 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 01:11:24.046 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 01:11:25.656 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 01:11:25.841 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 01:11:25.861 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 01:11:25.874 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 01:11:25.883 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 01:11:25.888 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]
2025-12-19 01:11:25.893 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]
2025-12-19 01:11:25.903 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@5ef2cbe6]]
2025-12-19 01:11:25.911 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 01:11:25.923 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:11:25.929 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:11:26.087 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:11:26.087 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:11:26.089 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 01:11:26.330 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2a8dd942
2025-12-19 01:11:26.355 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766077886319
2025-12-19 01:11:26.386 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2a8dd942
2025-12-19 01:11:26.405 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/729/1zcpxecl/websocket
2025-12-19 01:11:26.425 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 7426795b96dc496fa603dc2f13e07760
2025-12-19 01:11:26.572 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=1zcpxecl]
2025-12-19 01:11:26.678 [http-nio-8080-exec-4] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 01:11:26.684 [http-nio-8080-exec-4] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=7426795b96dc496fa603dc2f13e07760 session=1zcpxecl
2025-12-19 01:11:26.693 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:26.700 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:11:26.705 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:11:26.710 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 1zcpxecl
2025-12-19 01:11:26.712 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 7426795b96dc496fa603dc2f13e07760
2025-12-19 01:11:26.724 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:26.730 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:11:26.740 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=7426795b96dc496fa603dc2f13e07760 session=1zcpxecl
2025-12-19 01:11:26.749 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[7426795b96dc496fa603dc2f13e07760]}
2025-12-19 01:11:26.770 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 01:11:26.776 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=1zcpxecl
2025-12-19 01:11:26.780 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:26.788 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:11:26.792 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 01:11:26.797 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 1zcpxecl
2025-12-19 01:11:26.803 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 7426795b96dc496fa603dc2f13e07760
2025-12-19 01:11:26.809 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:26.814 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:11:26.831 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:11:26.835 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=1zcpxecl
2025-12-19 01:11:26.835 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=1zcpxecl
2025-12-19 01:11:26.842 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:26.845 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:11:26.847 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:11:26.853 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 1zcpxecl
2025-12-19 01:11:26.856 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 7426795b96dc496fa603dc2f13e07760
2025-12-19 01:11:26.860 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:26.866 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:11:26.882 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=1zcpxecl
2025-12-19 01:11:26.888 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-user1zcpxecl]
2025-12-19 01:11:26.891 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-user1zcpxecl subscriptionId=sub-1 session=1zcpxecl user=7426795b96dc496fa603dc2f13e07760 payload=byte[0]
2025-12-19 01:11:27.459 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:11:30.242 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2a8dd942
2025-12-19 01:11:30.244 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766077890216
2025-12-19 01:11:30.261 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2a8dd942
2025-12-19 01:11:30.264 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/069/bw0vbz2m/websocket
2025-12-19 01:11:30.264 [http-nio-8080-exec-8] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 18a217ad1bc14d7288ce9020106a9b41
2025-12-19 01:11:30.275 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=bw0vbz2m]
2025-12-19 01:11:30.297 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 01:11:30.301 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=18a217ad1bc14d7288ce9020106a9b41 session=bw0vbz2m
2025-12-19 01:11:30.305 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:30.309 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:11:30.310 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:11:30.310 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: bw0vbz2m
2025-12-19 01:11:30.311 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 18a217ad1bc14d7288ce9020106a9b41
2025-12-19 01:11:30.311 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:30.311 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:11:30.313 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=18a217ad1bc14d7288ce9020106a9b41 session=bw0vbz2m
2025-12-19 01:11:30.314 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[18a217ad1bc14d7288ce9020106a9b41]}
2025-12-19 01:11:30.341 [http-nio-8080-exec-10] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 01:11:30.342 [http-nio-8080-exec-10] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=bw0vbz2m
2025-12-19 01:11:30.343 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:30.345 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:11:30.347 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 01:11:30.354 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: bw0vbz2m
2025-12-19 01:11:30.356 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 18a217ad1bc14d7288ce9020106a9b41
2025-12-19 01:11:30.357 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:30.359 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:11:30.364 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=bw0vbz2m
2025-12-19 01:11:30.371 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:11:30.371 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=bw0vbz2m
2025-12-19 01:11:30.372 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:30.373 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:11:30.373 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:11:30.373 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: bw0vbz2m
2025-12-19 01:11:30.373 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 18a217ad1bc14d7288ce9020106a9b41
2025-12-19 01:11:30.374 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:30.374 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:11:30.375 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=bw0vbz2m
2025-12-19 01:11:30.375 [clientInboundChannel-18] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userbw0vbz2m]
2025-12-19 01:11:30.376 [clientInboundChannel-18] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userbw0vbz2m subscriptionId=sub-1 session=bw0vbz2m user=18a217ad1bc14d7288ce9020106a9b41 payload=byte[0]
2025-12-19 01:11:30.957 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:11:31.102 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#6403a4a5:0/SimpleConnection@52b32b70 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 55690]
2025-12-19 01:11:31.547 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 12.501 seconds (JVM running for 13.076)
2025-12-19 01:11:32.481 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:11:35.914 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2a8dd942
2025-12-19 01:11:35.916 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:11:35.928 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2a8dd942
2025-12-19 01:11:35.929 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/116/f5c2rruo/websocket
2025-12-19 01:11:35.929 [http-nio-8080-exec-5] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 91af7f55d7f448f88c2d8c6557ad8d99
2025-12-19 01:11:35.933 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=f5c2rruo]
2025-12-19 01:11:35.939 [http-nio-8080-exec-6] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:11:35.940 [http-nio-8080-exec-6] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=91af7f55d7f448f88c2d8c6557ad8d99 session=f5c2rruo
2025-12-19 01:11:35.940 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:35.941 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:11:35.941 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:11:35.941 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: f5c2rruo
2025-12-19 01:11:35.942 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 91af7f55d7f448f88c2d8c6557ad8d99
2025-12-19 01:11:35.942 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:35.942 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:11:35.944 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=91af7f55d7f448f88c2d8c6557ad8d99 session=f5c2rruo
2025-12-19 01:11:35.945 [clientOutboundChannel-3] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[91af7f55d7f448f88c2d8c6557ad8d99]}
2025-12-19 01:11:37.502 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:11:37.971 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2a8dd942
2025-12-19 01:11:37.972 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:11:37.976 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@2a8dd942
2025-12-19 01:11:37.977 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/710/jbx5nxzu/websocket
2025-12-19 01:11:37.978 [http-nio-8080-exec-8] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: c760011808e3429791c431edc76b70e0
2025-12-19 01:11:37.983 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=jbx5nxzu]
2025-12-19 01:11:37.986 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:11:37.986 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=c760011808e3429791c431edc76b70e0 session=jbx5nxzu
2025-12-19 01:11:37.986 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:37.986 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:11:37.987 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:11:37.987 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: jbx5nxzu
2025-12-19 01:11:37.988 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: c760011808e3429791c431edc76b70e0
2025-12-19 01:11:37.988 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:37.988 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:11:37.989 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=c760011808e3429791c431edc76b70e0 session=jbx5nxzu
2025-12-19 01:11:37.990 [clientOutboundChannel-4] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[c760011808e3429791c431edc76b70e0]}
2025-12-19 01:11:40.015 [http-nio-8080-exec-10] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:11:40.016 [http-nio-8080-exec-10] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=jbx5nxzu
2025-12-19 01:11:40.017 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:40.018 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:11:40.018 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:11:40.018 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: jbx5nxzu
2025-12-19 01:11:40.019 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: c760011808e3429791c431edc76b70e0
2025-12-19 01:11:40.019 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:40.019 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:11:40.020 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=jbx5nxzu
2025-12-19 01:11:40.021 [clientInboundChannel-27] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userjbx5nxzu]
2025-12-19 01:11:40.021 [clientInboundChannel-27] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userjbx5nxzu subscriptionId=sub-0 session=jbx5nxzu user=c760011808e3429791c431edc76b70e0 payload=byte[0]
2025-12-19 01:11:42.525 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:11:43.599 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:11:43.603 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=f5c2rruo
2025-12-19 01:11:43.606 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:43.609 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:11:43.612 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:11:43.619 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: f5c2rruo
2025-12-19 01:11:43.623 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 91af7f55d7f448f88c2d8c6557ad8d99
2025-12-19 01:11:43.626 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:43.632 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:11:43.637 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:11:43.641 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 49, 49, 58, 52, 51, 34, 44, 34, 105, 100, 34, 58, 34, 99, 55, 54, 48, 48, 49, 49, 56, 48, 56, 101, 51, 52, 50, 57, 55, 57, 49, 99, 52, 51, 49, 101, 100, 99, 55, 54, 98, 55, 48, 101, 48, 34, 125]
2025-12-19 01:11:43.644 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@3d0075cb, simpUser=91af7f55d7f448f88c2d8c6557ad8d99, simpSessionId=f5c2rruo, simpDestination=/ws/privateMessage}
2025-12-19 01:11:43.649 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:11:43","id":"c760011808e3429791c431edc76b70e0"}
2025-12-19 01:11:43.655 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:11:43.659 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:11:43.664 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:11:43.671 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:43.677 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:11:43.678 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:11:43.687 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@3d0075cb, simpUser=91af7f55d7f448f88c2d8c6557ad8d99, simpSessionId=f5c2rruo, simpDestination=/ws/privateMessage}
2025-12-19 01:11:43.703 [clientInboundChannel-28] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=f5c2rruo, lookupDestination='/privateMessage'
2025-12-19 01:11:43.709 [clientInboundChannel-28] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 01:11:43.711 [clientInboundChannel-28] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 01:11:43.844 [clientInboundChannel-28] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [91af7f55d7f448f88c2d8c6557ad8d99, Message(content=測試私信 - 上午1:11:43, recipient=null, id=c760011808e3429791c431edc76b70e0)]
2025-12-19 01:11:43.846 [clientInboundChannel-28] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 01:11:43.846 [clientInboundChannel-28] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 01:11:43.847 [clientInboundChannel-28] INFO  c.h.s.MessageController - 收到私信請求，發送者: 91af7f55d7f448f88c2d8c6557ad8d99
2025-12-19 01:11:43.849 [clientInboundChannel-28] INFO  c.h.s.MessageController - 訊息物件: Message(content=測試私信 - 上午1:11:43, recipient=null, id=c760011808e3429791c431edc76b70e0)
2025-12-19 01:11:43.855 [clientInboundChannel-28] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 01:11:43.856 [clientInboundChannel-28] INFO  c.h.s.MessageController - 發送者ID: 91af7f55d7f448f88c2d8c6557ad8d99
2025-12-19 01:11:43.856 [clientInboundChannel-28] INFO  c.h.s.MessageController - 接收者ID: c760011808e3429791c431edc76b70e0
2025-12-19 01:11:43.856 [clientInboundChannel-28] INFO  c.h.s.MessageController - 訊息內容: 測試私信 - 上午1:11:43
2025-12-19 01:11:43.857 [clientInboundChannel-28] INFO  c.h.s.MessageController - 目標路徑: /user/c760011808e3429791c431edc76b70e0/topic/privateMessage
2025-12-19 01:11:43.876 [clientInboundChannel-28] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/c760011808e3429791c431edc76b70e0/topic/privateMessage session=null payload={"content":"用戶：91af7f55d7f448f88c2d8c6557ad8d99發送的信息：測試私...(truncated)
2025-12-19 01:11:43.879 [clientInboundChannel-28] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/c760011808e3429791c431edc76b70e0/topic/privateMessage -> [/topic/privateMessage-userjbx5nxzu]
2025-12-19 01:11:43.879 [clientInboundChannel-28] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-userjbx5nxzu session=null payload={"content":"用戶：91af7f55d7f448f88c2d8c6557ad8d99發送的信息：測試私...(truncated)
2025-12-19 01:11:43.880 [clientInboundChannel-28] INFO  c.h.s.MessageController - 私信已發送到目標用戶: c760011808e3429791c431edc76b70e0
2025-12-19 01:11:43.880 [clientInboundChannel-28] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 01:11:47.543 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:11:52.556 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:11:55.291 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/message], content-length=[18]} session=null
2025-12-19 01:11:55.292 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/message session=1zcpxecl
2025-12-19 01:11:55.293 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:55.293 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:11:55.293 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/message
2025-12-19 01:11:55.294 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 1zcpxecl
2025-12-19 01:11:55.294 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 7426795b96dc496fa603dc2f13e07760
2025-12-19 01:11:55.294 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:55.296 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:11:55.296 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:11:55.296 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, 116, 101, 115, 116, 34, 125]
2025-12-19 01:11:55.297 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/message], content-length=[18]}, simpSessionAttributes={}, simpHeartbeat=[J@6d8ba8f2, simpUser=7426795b96dc496fa603dc2f13e07760, simpSessionId=1zcpxecl, simpDestination=/ws/message}
2025-12-19 01:11:55.297 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"test"}
2025-12-19 01:11:55.300 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/message
2025-12-19 01:11:55.301 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /message
2025-12-19 01:11:55.302 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/message")
2025-12-19 01:11:55.302 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:55.302 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:11:55.302 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:11:55.302 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/message], content-length=[18]}, simpSessionAttributes={}, simpHeartbeat=[J@6d8ba8f2, simpUser=7426795b96dc496fa603dc2f13e07760, simpSessionId=1zcpxecl, simpDestination=/ws/message}
2025-12-19 01:11:55.305 [clientInboundChannel-31] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/message session=1zcpxecl, lookupDestination='/message'
2025-12-19 01:11:55.305 [clientInboundChannel-31] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/message]}]
2025-12-19 01:11:55.306 [clientInboundChannel-31] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#message[1 args]
2025-12-19 01:11:55.306 [clientInboundChannel-31] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [Message(content=test, recipient=null, id=null)]
2025-12-19 01:11:55.307 [clientInboundChannel-31] INFO  c.h.s.MessageController - === 公共訊息接收 ===
2025-12-19 01:11:55.307 [clientInboundChannel-31] INFO  c.h.s.MessageController - 訊息內容: test
2025-12-19 01:11:55.307 [clientInboundChannel-31] INFO  c.h.s.MessageController - 發布到 Redis /topic/chat 頻道
2025-12-19 01:11:55.331 [clientInboundChannel-31] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle RedisConnectionFailureException
2025-12-19 01:11:55.337 [clientInboundChannel-31] ERROR o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Unhandled exception from message handler method
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is org.springframework.data.redis.connection.PoolException: Could not get a resource from the pool; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to localhost/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.RedisTemplate.convertAndSend(RedisTemplate.java:847)
	at com.hejz.springbootstomp.RedisMessagePublisher.publish(RedisMessagePublisher.java:88)
	at com.hejz.springbootstomp.RedisMessagePublisher.publish(RedisMessagePublisher.java:124)
	at com.hejz.springbootstomp.MessageController.message(MessageController.java:87)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMatch(AbstractMethodMessageHandler.java:569)
	at org.springframework.messaging.simp.annotation.support.SimpAnnotationMethodMessageHandler.handleMatch(SimpAnnotationMethodMessageHandler.java:511)
	at org.springframework.messaging.simp.annotation.support.SimpAnnotationMethodMessageHandler.handleMatch(SimpAnnotationMethodMessageHandler.java:94)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMessageInternal(AbstractMethodMessageHandler.java:524)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMessage(AbstractMethodMessageHandler.java:458)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.springframework.data.redis.connection.PoolException: Could not get a resource from the pool; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to localhost/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.getConnection(LettucePoolingConnectionProvider.java:109)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 28 common frames omitted
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to localhost/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.lambda$null$0(LettucePoolingConnectionProvider.java:97)
	at io.lettuce.core.support.ConnectionPoolSupport$RedisPooledObjectFactory.create(ConnectionPoolSupport.java:211)
	at io.lettuce.core.support.ConnectionPoolSupport$RedisPooledObjectFactory.create(ConnectionPoolSupport.java:201)
	at org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:70)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:571)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:298)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:223)
	at io.lettuce.core.support.ConnectionPoolSupport$1.borrowObject(ConnectionPoolSupport.java:122)
	at io.lettuce.core.support.ConnectionPoolSupport$1.borrowObject(ConnectionPoolSupport.java:117)
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.getConnection(LettucePoolingConnectionProvider.java:103)
	... 29 common frames omitted
Caused by: io.lettuce.core.RedisCommandExecutionException: NOAUTH HELLO must be called with the client already authenticated, otherwise the HELLO <proto> AUTH <user> <pass> option can be used to authenticate the client and select the RESP protocol version at the same time
	at io.lettuce.core.internal.ExceptionFactory.createExecutionException(ExceptionFactory.java:137)
	at io.lettuce.core.internal.ExceptionFactory.createExecutionException(ExceptionFactory.java:110)
	at io.lettuce.core.protocol.AsyncCommand.completeResult(AsyncCommand.java:120)
	at io.lettuce.core.protocol.AsyncCommand.complete(AsyncCommand.java:111)
	at io.lettuce.core.protocol.CommandHandler.complete(CommandHandler.java:746)
	at io.lettuce.core.protocol.CommandHandler.decode(CommandHandler.java:681)
	at io.lettuce.core.protocol.CommandHandler.channelRead(CommandHandler.java:598)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:719)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:655)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:581)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-12-19 01:11:55.811 [http-nio-8080-exec-4] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:11:55.812 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:11:55.813 [http-nio-8080-exec-4] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=f5c2rruo
2025-12-19 01:11:55.813 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:55.813 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:11:55.813 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=jbx5nxzu
2025-12-19 01:11:55.813 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:11:55.813 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:55.813 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: f5c2rruo
2025-12-19 01:11:55.814 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 91af7f55d7f448f88c2d8c6557ad8d99
2025-12-19 01:11:55.813 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:11:55.816 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:55.817 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:11:55.816 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:11:55.817 [clientInboundChannel-3] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=f5c2rruo
2025-12-19 01:11:55.818 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: jbx5nxzu
2025-12-19 01:11:55.818 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: c760011808e3429791c431edc76b70e0
2025-12-19 01:11:55.818 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=f5c2rruo] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:11:55.818 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:55.818 [http-nio-8080-exec-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session f5c2rruo
2025-12-19 01:11:55.818 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:11:55.819 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:55.819 [clientInboundChannel-6] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=jbx5nxzu
2025-12-19 01:11:55.820 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@405297ef, simpUser=91af7f55d7f448f88c2d8c6557ad8d99, simpSessionId=f5c2rruo}], simpUser=91af7f55d7f448f88c2d8c6557ad8d99, simpSessionId=f5c2rruo}]
2025-12-19 01:11:55.819 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=jbx5nxzu] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:11:55.820 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:11:55.821 [http-nio-8080-exec-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session jbx5nxzu
2025-12-19 01:11:55.821 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:11:55.822 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:11:55.822 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: f5c2rruo
2025-12-19 01:11:55.822 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:11:55.822 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 91af7f55d7f448f88c2d8c6557ad8d99
2025-12-19 01:11:55.822 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@30e66b34, simpUser=c760011808e3429791c431edc76b70e0, simpSessionId=jbx5nxzu}], simpUser=c760011808e3429791c431edc76b70e0, simpSessionId=jbx5nxzu}]
2025-12-19 01:11:55.822 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:11:55.822 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:55.823 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: jbx5nxzu
2025-12-19 01:11:55.823 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: c760011808e3429791c431edc76b70e0
2025-12-19 01:11:55.823 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:11:55.823 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:11:55.824 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:11:55.824 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=f5c2rruo
2025-12-19 01:11:55.825 [clientInboundChannel-12] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=jbx5nxzu
2025-12-19 01:11:55.826 [clientOutboundChannel-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=91af7f55d7f448f88c2d8c6557ad8d99, simpSessionId=f5c2rruo}], simpUser=91af7f55d7f448f88c2d8c6557ad8d99, simpSessionId=f5c2rruo}]
2025-12-19 01:11:55.827 [clientOutboundChannel-8] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=c760011808e3429791c431edc76b70e0, simpSessionId=jbx5nxzu}], simpUser=c760011808e3429791c431edc76b70e0, simpSessionId=jbx5nxzu}]
2025-12-19 01:11:57.582 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:01.412 [MessageBroker-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [f5c2rruo, jbx5nxzu]
2025-12-19 01:12:02.651 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:07.664 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:12.674 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:17.693 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:22.706 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:22.989 [MessageBroker-16] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[2 current WS(2)-HttpStream(0)-HttpPoll(0), 4 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(4)-CONNECTED(4)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 32, active threads = 0, queued tasks = 0, completed tasks = 45], outboundChannel[pool size = 8, active threads = 0, queued tasks = 0, completed tasks = 8], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 3, completed tasks = 16]
2025-12-19 01:12:27.727 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:32.745 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:37.758 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:42.767 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:47.772 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:52.777 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:12:57.791 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:13:02.801 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:13:07.818 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:13:12.836 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:13:17.842 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:13:22.853 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:13:27.870 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:13:32.885 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:13:54.904 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 61312 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 01:13:54.914 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 01:13:54.915 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 01:13:56.054 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 01:13:56.060 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 01:13:56.099 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 17 ms. Found 0 Redis repository interfaces.
2025-12-19 01:13:56.785 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 01:13:56.810 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 01:13:56.811 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 01:13:56.817 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 01:13:56.946 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 01:13:56.947 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1916 ms
2025-12-19 01:13:58.490 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 01:13:58.535 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 01:13:55 GMT+08:00 2025
2025-12-19 01:13:58.608 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 01:13:58.611 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 01:13:58.612 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 01:13:58.621 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 01:13:58.665 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 01:13:58.856 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 01:13:59.443 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 01:13:59.484 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 01:13:59.486 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 01:13:59.487 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 01:13:59.487 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 01:13:59.489 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 01:13:59.489 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 01:13:59.489 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 01:13:59.490 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 01:13:59.490 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:13:59.490 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:14:00.391 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:01.784 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:14:01.784 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:14:01.785 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 01:14:04.498 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:14:04.542 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 50199]
2025-12-19 01:14:04.597 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 10.556 seconds (JVM running for 11.148)
2025-12-19 01:14:05.404 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:07.189 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:14:07.191 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:14:07.204 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:14:07.205 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/605/jsca4pee/websocket
2025-12-19 01:14:07.208 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: b941c43727924a6ca1127e543fae1ca8
2025-12-19 01:14:07.245 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=jsca4pee]
2025-12-19 01:14:07.275 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:14:07.276 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=b941c43727924a6ca1127e543fae1ca8 session=jsca4pee
2025-12-19 01:14:07.278 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:14:07.278 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:14:07.279 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:14:07.279 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: jsca4pee
2025-12-19 01:14:07.280 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: b941c43727924a6ca1127e543fae1ca8
2025-12-19 01:14:07.280 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:14:07.280 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:14:07.283 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=b941c43727924a6ca1127e543fae1ca8 session=jsca4pee
2025-12-19 01:14:07.287 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[b941c43727924a6ca1127e543fae1ca8]}
2025-12-19 01:14:09.318 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:14:09.319 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:14:09.323 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:14:09.323 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/236/hohhkpxy/websocket
2025-12-19 01:14:09.323 [http-nio-8080-exec-7] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 8bc14b6545c84bbfbd88f3968bd69a49
2025-12-19 01:14:09.326 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=hohhkpxy]
2025-12-19 01:14:09.328 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:14:09.328 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=8bc14b6545c84bbfbd88f3968bd69a49 session=hohhkpxy
2025-12-19 01:14:09.328 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:14:09.329 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:14:09.329 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:14:09.329 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: hohhkpxy
2025-12-19 01:14:09.330 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 8bc14b6545c84bbfbd88f3968bd69a49
2025-12-19 01:14:09.331 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:14:09.331 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:14:09.331 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=8bc14b6545c84bbfbd88f3968bd69a49 session=hohhkpxy
2025-12-19 01:14:09.332 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[8bc14b6545c84bbfbd88f3968bd69a49]}
2025-12-19 01:14:10.419 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:11.357 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:14:11.358 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=hohhkpxy
2025-12-19 01:14:11.358 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:14:11.358 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:14:11.358 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:14:11.359 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: hohhkpxy
2025-12-19 01:14:11.359 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 8bc14b6545c84bbfbd88f3968bd69a49
2025-12-19 01:14:11.360 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:14:11.360 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:14:11.361 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=hohhkpxy
2025-12-19 01:14:11.362 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userhohhkpxy]
2025-12-19 01:14:11.362 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userhohhkpxy subscriptionId=sub-0 session=hohhkpxy user=8bc14b6545c84bbfbd88f3968bd69a49 payload=byte[0]
2025-12-19 01:14:14.914 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:14:14.914 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=jsca4pee
2025-12-19 01:14:14.916 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:14:14.917 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:14:14.917 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:14:14.917 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: jsca4pee
2025-12-19 01:14:14.917 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: b941c43727924a6ca1127e543fae1ca8
2025-12-19 01:14:14.918 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:14:14.918 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:14:14.918 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:14:14.918 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 49, 52, 58, 49, 52, 34, 44, 34, 105, 100, 34, 58, 34, 56, 98, 99, 49, 52, 98, 54, 53, 52, 53, 99, 56, 52, 98, 98, 102, 98, 100, 56, 56, 102, 51, 57, 54, 56, 98, 100, 54, 57, 97, 52, 57, 34, 125]
2025-12-19 01:14:14.919 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@2418dbef, simpUser=b941c43727924a6ca1127e543fae1ca8, simpSessionId=jsca4pee, simpDestination=/ws/privateMessage}
2025-12-19 01:14:14.919 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:14:14","id":"8bc14b6545c84bbfbd88f3968bd69a49"}
2025-12-19 01:14:14.919 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:14:14.919 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:14:14.919 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:14:14.919 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:14:14.920 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:14:14.920 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:14:14.920 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@2418dbef, simpUser=b941c43727924a6ca1127e543fae1ca8, simpSessionId=jsca4pee, simpDestination=/ws/privateMessage}
2025-12-19 01:14:14.921 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=jsca4pee, lookupDestination='/privateMessage'
2025-12-19 01:14:14.921 [clientInboundChannel-10] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 01:14:14.922 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 01:14:14.951 [clientInboundChannel-10] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [b941c43727924a6ca1127e543fae1ca8, Message(content=測試私信 - 上午1:14:14, recipient=null, id=8bc14b6545c84bbfbd88f3968bd69a49)]
2025-12-19 01:14:14.951 [clientInboundChannel-10] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 01:14:14.952 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 01:14:14.952 [clientInboundChannel-10] INFO  c.h.s.MessageController - 收到私信請求，發送者: b941c43727924a6ca1127e543fae1ca8
2025-12-19 01:14:14.952 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息物件: Message(content=測試私信 - 上午1:14:14, recipient=null, id=8bc14b6545c84bbfbd88f3968bd69a49)
2025-12-19 01:14:14.953 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 01:14:14.953 [clientInboundChannel-10] INFO  c.h.s.MessageController - 發送者ID: b941c43727924a6ca1127e543fae1ca8
2025-12-19 01:14:14.953 [clientInboundChannel-10] INFO  c.h.s.MessageController - 接收者ID: 8bc14b6545c84bbfbd88f3968bd69a49
2025-12-19 01:14:14.954 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息內容: 測試私信 - 上午1:14:14
2025-12-19 01:14:14.954 [clientInboundChannel-10] INFO  c.h.s.MessageController - 目標路徑: /user/8bc14b6545c84bbfbd88f3968bd69a49/topic/privateMessage
2025-12-19 01:14:14.961 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/8bc14b6545c84bbfbd88f3968bd69a49/topic/privateMessage session=null payload={"content":"用戶：b941c43727924a6ca1127e543fae1ca8發送的信息：測試私...(truncated)
2025-12-19 01:14:14.965 [clientInboundChannel-10] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/8bc14b6545c84bbfbd88f3968bd69a49/topic/privateMessage -> [/topic/privateMessage-userhohhkpxy]
2025-12-19 01:14:14.966 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-userhohhkpxy session=null payload={"content":"用戶：b941c43727924a6ca1127e543fae1ca8發送的信息：測試私...(truncated)
2025-12-19 01:14:14.966 [clientInboundChannel-10] INFO  c.h.s.MessageController - 私信已發送到目標用戶: 8bc14b6545c84bbfbd88f3968bd69a49
2025-12-19 01:14:14.966 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 01:14:15.442 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:20.456 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:25.476 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:27.139 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:14:27.139 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=jsca4pee
2025-12-19 01:14:27.140 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:14:27.140 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:14:27.141 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:14:27.141 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:14:27.141 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=hohhkpxy
2025-12-19 01:14:27.141 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: jsca4pee
2025-12-19 01:14:27.141 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:14:27.142 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: b941c43727924a6ca1127e543fae1ca8
2025-12-19 01:14:27.142 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:14:27.142 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:14:27.142 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:14:27.143 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:14:27.143 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: hohhkpxy
2025-12-19 01:14:27.143 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 8bc14b6545c84bbfbd88f3968bd69a49
2025-12-19 01:14:27.143 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:14:27.143 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:14:27.144 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=jsca4pee] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:14:27.144 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=jsca4pee
2025-12-19 01:14:27.144 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session jsca4pee
2025-12-19 01:14:27.144 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=hohhkpxy
2025-12-19 01:14:27.145 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:14:27.145 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=hohhkpxy] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:14:27.145 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:14:27.145 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@3174dda4, simpUser=b941c43727924a6ca1127e543fae1ca8, simpSessionId=jsca4pee}], simpUser=b941c43727924a6ca1127e543fae1ca8, simpSessionId=jsca4pee}]
2025-12-19 01:14:27.145 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session hohhkpxy
2025-12-19 01:14:27.145 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:14:27.146 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:14:27.146 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@4708a880, simpUser=8bc14b6545c84bbfbd88f3968bd69a49, simpSessionId=hohhkpxy}], simpUser=8bc14b6545c84bbfbd88f3968bd69a49, simpSessionId=hohhkpxy}]
2025-12-19 01:14:27.146 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: jsca4pee
2025-12-19 01:14:27.146 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:14:27.147 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: b941c43727924a6ca1127e543fae1ca8
2025-12-19 01:14:27.147 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:14:27.147 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:14:27.148 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: hohhkpxy
2025-12-19 01:14:27.148 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:14:27.148 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 8bc14b6545c84bbfbd88f3968bd69a49
2025-12-19 01:14:27.149 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:14:27.149 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:14:27.149 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=jsca4pee
2025-12-19 01:14:27.150 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=hohhkpxy
2025-12-19 01:14:27.151 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=b941c43727924a6ca1127e543fae1ca8, simpSessionId=jsca4pee}], simpUser=b941c43727924a6ca1127e543fae1ca8, simpSessionId=jsca4pee}]
2025-12-19 01:14:27.152 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=8bc14b6545c84bbfbd88f3968bd69a49, simpSessionId=hohhkpxy}], simpUser=8bc14b6545c84bbfbd88f3968bd69a49, simpSessionId=hohhkpxy}]
2025-12-19 01:14:30.493 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:32.207 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [jsca4pee, hohhkpxy]
2025-12-19 01:14:35.513 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:40.522 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:45.538 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:50.558 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:55.576 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:14:58.505 [MessageBroker-11] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 11]
2025-12-19 01:15:00.590 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:05.605 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:10.622 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:15.641 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:20.658 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:25.669 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:30.684 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:35.699 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:40.709 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:45.726 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:50.740 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:15:55.748 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:00.762 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:05.775 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:10.783 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:15.788 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:20.795 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:25.816 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:30.830 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:35.849 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:40.860 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:45.877 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:50.890 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:16:55.904 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:17:00.922 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:17:40.840 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 47260 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 01:17:40.855 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 01:17:40.856 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 01:17:41.666 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 01:17:41.669 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 01:17:41.697 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2025-12-19 01:17:42.269 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 01:17:42.285 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 01:17:42.286 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 01:17:42.287 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 01:17:42.433 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 01:17:42.434 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1489 ms
2025-12-19 01:17:43.573 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 01:17:43.636 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 01:17:40 GMT+08:00 2025
2025-12-19 01:17:43.714 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 01:17:43.718 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 01:17:43.719 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 01:17:43.724 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 01:17:43.764 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 01:17:43.934 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 01:17:44.629 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 01:17:44.667 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 01:17:44.669 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 01:17:44.669 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 01:17:44.670 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 01:17:44.670 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 01:17:44.670 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 01:17:44.671 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 01:17:44.671 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 01:17:44.671 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:17:44.672 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:17:45.075 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:17:45.076 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:17:45.078 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 01:17:45.653 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:17:49.689 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:17:49.886 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 52285]
2025-12-19 01:17:50.072 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 9.967 seconds (JVM running for 10.477)
2025-12-19 01:17:50.712 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:17:50.783 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:17:50.849 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:17:50.867 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:17:50.931 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/770/4hdlajlu/websocket
2025-12-19 01:17:50.991 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 2c0c697952444b19b90979e8b5fbeacb
2025-12-19 01:17:51.145 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=4hdlajlu]
2025-12-19 01:17:51.249 [http-nio-8080-exec-4] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:17:51.250 [http-nio-8080-exec-4] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=2c0c697952444b19b90979e8b5fbeacb session=4hdlajlu
2025-12-19 01:17:51.256 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:17:51.257 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:17:51.258 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:17:51.258 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 4hdlajlu
2025-12-19 01:17:51.258 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2c0c697952444b19b90979e8b5fbeacb
2025-12-19 01:17:51.259 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:17:51.260 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:17:51.263 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=2c0c697952444b19b90979e8b5fbeacb session=4hdlajlu
2025-12-19 01:17:51.271 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[2c0c697952444b19b90979e8b5fbeacb]}
2025-12-19 01:17:53.298 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:17:53.300 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:17:53.306 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:17:53.307 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/153/x0e2xwqx/websocket
2025-12-19 01:17:53.307 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 39304acf89e4429783956b9b01058365
2025-12-19 01:17:53.311 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=x0e2xwqx]
2025-12-19 01:17:53.314 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:17:53.314 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=39304acf89e4429783956b9b01058365 session=x0e2xwqx
2025-12-19 01:17:53.315 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:17:53.315 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:17:53.315 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:17:53.316 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: x0e2xwqx
2025-12-19 01:17:53.316 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 39304acf89e4429783956b9b01058365
2025-12-19 01:17:53.316 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:17:53.316 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:17:53.317 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=39304acf89e4429783956b9b01058365 session=x0e2xwqx
2025-12-19 01:17:53.318 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[39304acf89e4429783956b9b01058365]}
2025-12-19 01:17:55.340 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:17:55.341 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=x0e2xwqx
2025-12-19 01:17:55.342 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:17:55.342 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:17:55.342 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:17:55.342 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: x0e2xwqx
2025-12-19 01:17:55.342 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 39304acf89e4429783956b9b01058365
2025-12-19 01:17:55.343 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:17:55.344 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:17:55.345 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=x0e2xwqx
2025-12-19 01:17:55.347 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userx0e2xwqx]
2025-12-19 01:17:55.348 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userx0e2xwqx subscriptionId=sub-0 session=x0e2xwqx user=39304acf89e4429783956b9b01058365 payload=byte[0]
2025-12-19 01:17:55.878 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:17:58.908 [http-nio-8080-exec-10] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:17:58.911 [http-nio-8080-exec-10] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=4hdlajlu
2025-12-19 01:17:58.911 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:17:58.913 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:17:58.913 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:17:58.914 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 4hdlajlu
2025-12-19 01:17:58.915 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2c0c697952444b19b90979e8b5fbeacb
2025-12-19 01:17:58.916 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:17:58.916 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:17:58.916 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:17:58.916 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 49, 55, 58, 53, 56, 34, 44, 34, 105, 100, 34, 58, 34, 51, 57, 51, 48, 52, 97, 99, 102, 56, 57, 101, 52, 52, 50, 57, 55, 56, 51, 57, 53, 54, 98, 57, 98, 48, 49, 48, 53, 56, 51, 54, 53, 34, 125]
2025-12-19 01:17:58.918 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@308f000e, simpUser=2c0c697952444b19b90979e8b5fbeacb, simpSessionId=4hdlajlu, simpDestination=/ws/privateMessage}
2025-12-19 01:17:58.918 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:17:58","id":"39304acf89e4429783956b9b01058365"}
2025-12-19 01:17:58.918 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:17:58.918 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:17:58.918 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:17:58.919 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:17:58.920 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:17:58.920 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:17:58.921 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@308f000e, simpUser=2c0c697952444b19b90979e8b5fbeacb, simpSessionId=4hdlajlu, simpDestination=/ws/privateMessage}
2025-12-19 01:17:58.923 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=4hdlajlu, lookupDestination='/privateMessage'
2025-12-19 01:17:58.927 [clientInboundChannel-10] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 01:17:58.928 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 01:17:59.026 [clientInboundChannel-10] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [2c0c697952444b19b90979e8b5fbeacb, Message(content=測試私信 - 上午1:17:58, recipient=null, id=39304acf89e4429783956b9b01058365)]
2025-12-19 01:17:59.027 [clientInboundChannel-10] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 01:17:59.028 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 01:17:59.028 [clientInboundChannel-10] INFO  c.h.s.MessageController - 收到私信請求，發送者: 2c0c697952444b19b90979e8b5fbeacb
2025-12-19 01:17:59.029 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息物件: Message(content=測試私信 - 上午1:17:58, recipient=null, id=39304acf89e4429783956b9b01058365)
2025-12-19 01:17:59.033 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 01:17:59.033 [clientInboundChannel-10] INFO  c.h.s.MessageController - 發送者ID: 2c0c697952444b19b90979e8b5fbeacb
2025-12-19 01:17:59.033 [clientInboundChannel-10] INFO  c.h.s.MessageController - 接收者ID: 39304acf89e4429783956b9b01058365
2025-12-19 01:17:59.033 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息內容: 測試私信 - 上午1:17:58
2025-12-19 01:17:59.033 [clientInboundChannel-10] INFO  c.h.s.MessageController - 目標路徑: /user/39304acf89e4429783956b9b01058365/topic/privateMessage
2025-12-19 01:17:59.057 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/39304acf89e4429783956b9b01058365/topic/privateMessage session=null payload={"content":"用戶：2c0c697952444b19b90979e8b5fbeacb發送的信息：測試私...(truncated)
2025-12-19 01:17:59.063 [clientInboundChannel-10] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/39304acf89e4429783956b9b01058365/topic/privateMessage -> [/topic/privateMessage-userx0e2xwqx]
2025-12-19 01:17:59.063 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-userx0e2xwqx session=null payload={"content":"用戶：2c0c697952444b19b90979e8b5fbeacb發送的信息：測試私...(truncated)
2025-12-19 01:17:59.063 [clientInboundChannel-10] INFO  c.h.s.MessageController - 私信已發送到目標用戶: 39304acf89e4429783956b9b01058365
2025-12-19 01:17:59.064 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 01:18:00.904 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:18:05.919 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:18:10.938 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:18:11.120 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:18:11.121 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:18:11.121 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=4hdlajlu
2025-12-19 01:18:11.121 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=x0e2xwqx
2025-12-19 01:18:11.121 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:18:11.121 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:18:11.121 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:18:11.122 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:18:11.122 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:18:11.122 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:18:11.122 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 4hdlajlu
2025-12-19 01:18:11.123 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: x0e2xwqx
2025-12-19 01:18:11.123 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2c0c697952444b19b90979e8b5fbeacb
2025-12-19 01:18:11.123 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 39304acf89e4429783956b9b01058365
2025-12-19 01:18:11.123 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:18:11.123 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:18:11.123 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:18:11.124 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:18:11.126 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=4hdlajlu
2025-12-19 01:18:11.127 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=x0e2xwqx
2025-12-19 01:18:11.128 [clientOutboundChannel-3] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP ERROR, headers={message=[Session closed.]}
2025-12-19 01:18:11.129 [clientOutboundChannel-4] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP ERROR, headers={message=[Session closed.]}
2025-12-19 01:18:11.128 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=4hdlajlu]
java.net.SocketException: Connection reset
	at java.base/sun.nio.ch.SocketChannelImpl.throwConnectionReset(SocketChannelImpl.java:394)
	at java.base/sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:426)
	at org.apache.tomcat.util.net.NioChannel.read(NioChannel.java:160)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.fillReadBuffer(NioEndpoint.java:1316)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper.read(NioEndpoint.java:1206)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:75)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:183)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:162)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:157)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:59)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:895)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1722)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 01:18:11.132 [clientOutboundChannel-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=4hdlajlu]
java.io.IOException: java.io.IOException: Connection reset by peer
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:327)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:262)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:816)
	at org.apache.tomcat.websocket.WsSession.doClose(WsSession.java:704)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:325)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:254)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:227)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:49)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:215)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:106)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:224)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:326)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:213)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:170)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.io.IOException: Connection reset by peer
	at java.base/sun.nio.ch.SocketDispatcher.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:58)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:217)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:153)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:563)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:147)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1614)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:1061)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1480)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1406)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1377)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:93)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:512)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	... 18 common frames omitted
2025-12-19 01:18:11.132 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - Transport error in WebSocketServerSockJsSession[id=x0e2xwqx]
java.io.IOException: java.io.IOException: Connection reset by peer
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:327)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:262)
	at org.apache.tomcat.websocket.WsSession.sendCloseMessage(WsSession.java:816)
	at org.apache.tomcat.websocket.WsSession.onClose(WsSession.java:739)
	at org.apache.tomcat.websocket.WsFrameBase.processDataControl(WsFrameBase.java:367)
	at org.apache.tomcat.websocket.WsFrameBase.processData(WsFrameBase.java:296)
	at org.apache.tomcat.websocket.WsFrameBase.processInputBuffer(WsFrameBase.java:133)
	at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:85)
	at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:183)
	at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:162)
	at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:157)
	at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:60)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:59)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:895)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1722)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.io.IOException: Connection reset by peer
	at java.base/sun.nio.ch.SocketDispatcher.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:58)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:217)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:153)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:563)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:147)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1614)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:1061)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1480)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1406)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1377)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:93)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:512)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	... 19 common frames omitted
2025-12-19 01:18:11.133 [clientOutboundChannel-4] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Terminating connection after failure to send message to client
java.lang.IllegalStateException: Message will not be sent because the WebSocket session has been closed
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:442)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:254)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:227)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:49)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:215)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:106)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:224)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:326)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:213)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:170)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 01:18:11.135 [clientOutboundChannel-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=4hdlajlu] closed with CloseStatus[code=1006, reason=Connection reset by peer]
2025-12-19 01:18:11.135 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=x0e2xwqx] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:18:11.135 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 4hdlajlu
2025-12-19 01:18:11.136 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session x0e2xwqx
2025-12-19 01:18:11.136 [clientOutboundChannel-4] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session x0e2xwqx
org.springframework.web.socket.sockjs.SockJsTransportFailureException: Failed to write SockJsFrame content='a["ERROR\nmessage:Session closed.\ncontent-length:0\n\n\u0000"]'; nested exception is java.lang.IllegalStateException: Message will not be sent because the WebSocket session has been closed
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:343)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:213)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:170)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.lang.IllegalStateException: Message will not be sent because the WebSocket session has been closed
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:442)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:254)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:227)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:49)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:215)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:106)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:224)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:326)
	... 11 common frames omitted
2025-12-19 01:18:11.137 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:18:11.137 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:18:11.137 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:18:11.137 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:18:11.138 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:18:11.138 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:18:11.138 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: x0e2xwqx
2025-12-19 01:18:11.138 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 4hdlajlu
2025-12-19 01:18:11.138 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 39304acf89e4429783956b9b01058365
2025-12-19 01:18:11.139 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 2c0c697952444b19b90979e8b5fbeacb
2025-12-19 01:18:11.139 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:18:11.139 [clientOutboundChannel-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:18:11.139 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:18:11.139 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:18:11.139 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=4hdlajlu
2025-12-19 01:18:11.140 [clientOutboundChannel-3] DEBUG o.s.w.s.s.t.s.WebSocketServerSockJsSession - Terminating connection after failure to send message to client
java.io.IOException: java.io.IOException: Connection reset by peer
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:327)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:254)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:227)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:49)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:215)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:106)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:224)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:326)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:213)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:170)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.io.IOException: Connection reset by peer
	at java.base/sun.nio.ch.SocketDispatcher.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:58)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:217)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:153)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:563)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:147)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1614)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:1061)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1480)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1406)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1377)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:93)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:512)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	... 18 common frames omitted
2025-12-19 01:18:11.140 [clientOutboundChannel-3] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session 4hdlajlu
org.springframework.web.socket.sockjs.SockJsTransportFailureException: Failed to write SockJsFrame content='a["ERROR\nmessage:Session closed.\ncontent-length:0\n\n\u0000"]'; nested exception is java.io.IOException: java.io.IOException: Connection reset by peer
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:343)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.sendMessageInternal(WebSocketServerSockJsSession.java:213)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:170)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: java.io.IOException: java.io.IOException: Connection reset by peer
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:327)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:254)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendPartialString(WsRemoteEndpointImplBase.java:227)
	at org.apache.tomcat.websocket.WsRemoteEndpointBasic.sendText(WsRemoteEndpointBasic.java:49)
	at org.springframework.web.socket.adapter.standard.StandardWebSocketSession.sendTextMessage(StandardWebSocketSession.java:215)
	at org.springframework.web.socket.adapter.AbstractWebSocketSession.sendMessage(AbstractWebSocketSession.java:106)
	at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.writeFrameInternal(WebSocketServerSockJsSession.java:224)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.writeFrame(AbstractSockJsSession.java:326)
	... 11 common frames omitted
Caused by: java.io.IOException: Connection reset by peer
	at java.base/sun.nio.ch.SocketDispatcher.writev0(Native Method)
	at java.base/sun.nio.ch.SocketDispatcher.writev(SocketDispatcher.java:58)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:217)
	at java.base/sun.nio.ch.IOUtil.write(IOUtil.java:153)
	at java.base/sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:563)
	at org.apache.tomcat.util.net.NioChannel.write(NioChannel.java:147)
	at org.apache.tomcat.util.net.NioEndpoint$NioSocketWrapper$NioOperationState.run(NioEndpoint.java:1614)
	at org.apache.tomcat.util.net.SocketWrapperBase$OperationState.start(SocketWrapperBase.java:1061)
	at org.apache.tomcat.util.net.SocketWrapperBase.vectoredOperation(SocketWrapperBase.java:1480)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1406)
	at org.apache.tomcat.util.net.SocketWrapperBase.write(SocketWrapperBase.java:1377)
	at org.apache.tomcat.websocket.server.WsRemoteEndpointImplServer.doWrite(WsRemoteEndpointImplServer.java:93)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.writeMessagePart(WsRemoteEndpointImplBase.java:512)
	at org.apache.tomcat.websocket.WsRemoteEndpointImplBase.sendMessageBlock(WsRemoteEndpointImplBase.java:314)
	... 18 common frames omitted
2025-12-19 01:18:11.141 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=x0e2xwqx
2025-12-19 01:18:11.141 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=2c0c697952444b19b90979e8b5fbeacb, simpSessionId=4hdlajlu}], simpUser=2c0c697952444b19b90979e8b5fbeacb, simpSessionId=4hdlajlu}]
2025-12-19 01:18:11.141 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=39304acf89e4429783956b9b01058365, simpSessionId=x0e2xwqx}], simpUser=39304acf89e4429783956b9b01058365, simpSessionId=x0e2xwqx}]
2025-12-19 01:18:15.973 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:18:20.980 [MessageBroker-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [x0e2xwqx, 4hdlajlu]
2025-12-19 01:18:20.988 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:18:26.001 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:18:31.028 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:18:36.099 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:18:41.149 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:18:43.609 [MessageBroker-5] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 3 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 11]
2025-12-19 01:18:46.184 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:18:51.206 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:20:23.897 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 63956 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 01:20:23.908 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 01:20:23.909 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 01:20:25.197 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 01:20:25.205 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 01:20:25.278 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 32 ms. Found 0 Redis repository interfaces.
2025-12-19 01:20:26.013 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 01:20:26.022 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 01:20:26.023 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 01:20:26.024 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 01:20:26.103 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 01:20:26.103 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2107 ms
2025-12-19 01:20:26.685 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 01:20:26.722 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 01:20:23 GMT+08:00 2025
2025-12-19 01:20:26.766 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 01:20:26.768 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 01:20:26.768 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 01:20:26.772 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 01:20:26.795 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 01:20:26.897 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 01:20:27.231 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 01:20:27.253 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 01:20:27.254 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 01:20:27.254 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 01:20:27.255 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 01:20:27.255 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]
2025-12-19 01:20:27.255 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]
2025-12-19 01:20:27.255 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@1a2724d3]]
2025-12-19 01:20:27.256 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 01:20:27.256 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:20:27.256 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:20:27.601 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:20:32.266 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:20:32.316 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#61b65d54:0/SimpleConnection@16b76858 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 50192]
2025-12-19 01:20:32.367 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 9.37 seconds (JVM running for 10.059)
2025-12-19 01:20:32.616 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:20:34.849 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:20:34.850 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:20:34.852 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-12-19 01:20:37.635 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:20:40.211 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 01:20:40.214 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:20:40.231 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 01:20:40.233 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/144/wy4qqm53/websocket
2025-12-19 01:20:40.239 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 26fb2d5095b34fd1b73a70d60ddb0210
2025-12-19 01:20:40.305 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=wy4qqm53]
2025-12-19 01:20:40.336 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:20:40.336 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=26fb2d5095b34fd1b73a70d60ddb0210 session=wy4qqm53
2025-12-19 01:20:40.338 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:20:40.339 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:20:40.339 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:20:40.340 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: wy4qqm53
2025-12-19 01:20:40.341 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 26fb2d5095b34fd1b73a70d60ddb0210
2025-12-19 01:20:40.341 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:20:40.342 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:20:40.345 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=26fb2d5095b34fd1b73a70d60ddb0210 session=wy4qqm53
2025-12-19 01:20:40.353 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[26fb2d5095b34fd1b73a70d60ddb0210]}
2025-12-19 01:20:42.378 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 01:20:42.379 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:20:42.384 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@67acfde9
2025-12-19 01:20:42.384 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/405/wywypgbo/websocket
2025-12-19 01:20:42.385 [http-nio-8080-exec-7] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: a011a2ba594e4ea7b493c7327bc1742b
2025-12-19 01:20:42.387 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=wywypgbo]
2025-12-19 01:20:42.389 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:20:42.389 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=a011a2ba594e4ea7b493c7327bc1742b session=wywypgbo
2025-12-19 01:20:42.390 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:20:42.391 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:20:42.392 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:20:42.394 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: wywypgbo
2025-12-19 01:20:42.395 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: a011a2ba594e4ea7b493c7327bc1742b
2025-12-19 01:20:42.396 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:20:42.396 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:20:42.397 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=a011a2ba594e4ea7b493c7327bc1742b session=wywypgbo
2025-12-19 01:20:42.398 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[a011a2ba594e4ea7b493c7327bc1742b]}
2025-12-19 01:20:42.650 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:20:44.441 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:20:44.446 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=wywypgbo
2025-12-19 01:20:44.450 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:20:44.452 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:20:44.452 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:20:44.452 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: wywypgbo
2025-12-19 01:20:44.453 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: a011a2ba594e4ea7b493c7327bc1742b
2025-12-19 01:20:44.453 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:20:44.454 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:20:44.456 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=wywypgbo
2025-12-19 01:20:44.459 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userwywypgbo]
2025-12-19 01:20:44.460 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userwywypgbo subscriptionId=sub-0 session=wywypgbo user=a011a2ba594e4ea7b493c7327bc1742b payload=byte[0]
2025-12-19 01:20:47.659 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:20:48.009 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:20:48.011 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=wy4qqm53
2025-12-19 01:20:48.011 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:20:48.012 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:20:48.012 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:20:48.013 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: wy4qqm53
2025-12-19 01:20:48.013 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 26fb2d5095b34fd1b73a70d60ddb0210
2025-12-19 01:20:48.013 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:20:48.014 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:20:48.014 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:20:48.015 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 50, 48, 58, 52, 55, 34, 44, 34, 105, 100, 34, 58, 34, 97, 48, 49, 49, 97, 50, 98, 97, 53, 57, 52, 101, 52, 101, 97, 55, 98, 52, 57, 51, 99, 55, 51, 50, 55, 98, 99, 49, 55, 52, 50, 98, 34, 125]
2025-12-19 01:20:48.015 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@208a866e, simpUser=26fb2d5095b34fd1b73a70d60ddb0210, simpSessionId=wy4qqm53, simpDestination=/ws/privateMessage}
2025-12-19 01:20:48.016 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:20:47","id":"a011a2ba594e4ea7b493c7327bc1742b"}
2025-12-19 01:20:48.016 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:20:48.016 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:20:48.016 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:20:48.017 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:20:48.017 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:20:48.017 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:20:48.018 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@208a866e, simpUser=26fb2d5095b34fd1b73a70d60ddb0210, simpSessionId=wy4qqm53, simpDestination=/ws/privateMessage}
2025-12-19 01:20:48.019 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=wy4qqm53, lookupDestination='/privateMessage'
2025-12-19 01:20:48.020 [clientInboundChannel-10] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 01:20:48.020 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 01:20:48.056 [clientInboundChannel-10] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [26fb2d5095b34fd1b73a70d60ddb0210, Message(content=測試私信 - 上午1:20:47, recipient=null, id=a011a2ba594e4ea7b493c7327bc1742b)]
2025-12-19 01:20:48.057 [clientInboundChannel-10] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 01:20:48.058 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 01:20:48.058 [clientInboundChannel-10] INFO  c.h.s.MessageController - 收到私信請求，發送者: 26fb2d5095b34fd1b73a70d60ddb0210
2025-12-19 01:20:48.059 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息物件: Message(content=測試私信 - 上午1:20:47, recipient=null, id=a011a2ba594e4ea7b493c7327bc1742b)
2025-12-19 01:20:48.061 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 01:20:48.061 [clientInboundChannel-10] INFO  c.h.s.MessageController - 發送者ID: 26fb2d5095b34fd1b73a70d60ddb0210
2025-12-19 01:20:48.061 [clientInboundChannel-10] INFO  c.h.s.MessageController - 接收者ID: a011a2ba594e4ea7b493c7327bc1742b
2025-12-19 01:20:48.062 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息內容: 測試私信 - 上午1:20:47
2025-12-19 01:20:48.062 [clientInboundChannel-10] INFO  c.h.s.MessageController - 目標路徑: /user/a011a2ba594e4ea7b493c7327bc1742b/topic/privateMessage
2025-12-19 01:20:48.071 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/a011a2ba594e4ea7b493c7327bc1742b/topic/privateMessage session=null payload={"content":"用戶：26fb2d5095b34fd1b73a70d60ddb0210發送的信息：測試私...(truncated)
2025-12-19 01:20:48.074 [clientInboundChannel-10] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/a011a2ba594e4ea7b493c7327bc1742b/topic/privateMessage -> [/topic/privateMessage-userwywypgbo]
2025-12-19 01:20:48.074 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-userwywypgbo session=null payload={"content":"用戶：26fb2d5095b34fd1b73a70d60ddb0210發送的信息：測試私...(truncated)
2025-12-19 01:20:48.075 [clientInboundChannel-10] INFO  c.h.s.MessageController - 私信已發送到目標用戶: a011a2ba594e4ea7b493c7327bc1742b
2025-12-19 01:20:48.075 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 01:20:52.680 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:20:57.687 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:00.186 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:21:00.187 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:21:00.187 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=wy4qqm53
2025-12-19 01:21:00.188 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=wywypgbo
2025-12-19 01:21:00.188 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:21:00.188 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:21:00.188 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:21:00.189 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:21:00.189 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:21:00.189 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:21:00.189 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: wy4qqm53
2025-12-19 01:21:00.190 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: wywypgbo
2025-12-19 01:21:00.190 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 26fb2d5095b34fd1b73a70d60ddb0210
2025-12-19 01:21:00.190 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: a011a2ba594e4ea7b493c7327bc1742b
2025-12-19 01:21:00.190 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:21:00.190 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:21:00.191 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:21:00.191 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:21:00.192 [clientInboundChannel-15] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=wy4qqm53
2025-12-19 01:21:00.192 [clientInboundChannel-16] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=wywypgbo
2025-12-19 01:21:00.194 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=wy4qqm53] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:21:00.194 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=wywypgbo] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:21:00.194 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session wywypgbo
2025-12-19 01:21:00.194 [clientOutboundChannel-3] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP ERROR, headers={message=[Session closed.]}
2025-12-19 01:21:00.194 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session wy4qqm53
2025-12-19 01:21:00.195 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:21:00.195 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:21:00.195 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:21:00.195 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:21:00.195 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:21:00.196 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: wy4qqm53
2025-12-19 01:21:00.196 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:21:00.196 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@473cfea1, simpUser=a011a2ba594e4ea7b493c7327bc1742b, simpSessionId=wywypgbo}], simpUser=a011a2ba594e4ea7b493c7327bc1742b, simpSessionId=wywypgbo}]
2025-12-19 01:21:00.196 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 26fb2d5095b34fd1b73a70d60ddb0210
2025-12-19 01:21:00.196 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: wywypgbo
2025-12-19 01:21:00.196 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:21:00.196 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: a011a2ba594e4ea7b493c7327bc1742b
2025-12-19 01:21:00.196 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:21:00.196 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:21:00.196 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:21:00.197 [clientOutboundChannel-3] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session wy4qqm53
java.lang.IllegalStateException: Cannot send a message when session is closed
	at org.springframework.util.Assert.state(Assert.java:76)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:168)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 01:21:00.197 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=wy4qqm53
2025-12-19 01:21:00.197 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=wywypgbo
2025-12-19 01:21:00.198 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=26fb2d5095b34fd1b73a70d60ddb0210, simpSessionId=wy4qqm53}], simpUser=26fb2d5095b34fd1b73a70d60ddb0210, simpSessionId=wy4qqm53}]
2025-12-19 01:21:00.198 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=a011a2ba594e4ea7b493c7327bc1742b, simpSessionId=wywypgbo}], simpUser=a011a2ba594e4ea7b493c7327bc1742b, simpSessionId=wywypgbo}]
2025-12-19 01:21:02.697 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:05.235 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [wywypgbo, wy4qqm53]
2025-12-19 01:21:07.716 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:12.724 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:17.741 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:22.765 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:26.702 [MessageBroker-8] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 1, queued tasks = 1, completed tasks = 10]
2025-12-19 01:21:27.773 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:32.795 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:37.802 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:42.822 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:47.837 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:52.853 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:21:57.859 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:22:02.878 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:22:07.892 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:22:12.911 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:22:17.921 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:22:22.929 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:22:27.936 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:22:32.945 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:22:37.949 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:22:42.965 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:22:55.198 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 62932 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 01:22:55.206 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 01:22:55.206 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 01:22:55.741 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 01:22:55.744 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 01:22:55.763 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 10 ms. Found 0 Redis repository interfaces.
2025-12-19 01:22:56.179 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 01:22:56.186 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 01:22:56.187 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 01:22:56.187 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 01:22:56.252 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 01:22:56.252 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 986 ms
2025-12-19 01:22:56.777 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 01:22:56.816 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 01:22:55 GMT+08:00 2025
2025-12-19 01:22:56.864 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
	{[MESSAGE],[/message]}: message(Message)
2025-12-19 01:22:56.867 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 01:22:56.867 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 01:22:56.872 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 01:22:56.899 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 01:22:57.028 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 01:22:57.558 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 01:22:57.595 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 01:22:57.598 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 01:22:57.599 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 01:22:57.599 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 01:22:57.599 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 01:22:57.600 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 01:22:57.600 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 01:22:57.601 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 01:22:57.601 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:22:57.601 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:22:58.123 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:02.612 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:23:02.660 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 62870]
2025-12-19 01:23:02.717 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.928 seconds (JVM running for 8.24)
2025-12-19 01:23:03.146 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:08.169 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:11.032 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:23:11.032 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:23:11.033 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-12-19 01:23:13.192 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:16.279 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:23:16.281 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:23:16.290 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:23:16.291 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/224/nak1tgrc/websocket
2025-12-19 01:23:16.297 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: dfc1b51c2c1d4ab587d448882e6d4691
2025-12-19 01:23:16.331 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=nak1tgrc]
2025-12-19 01:23:16.351 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:23:16.352 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=dfc1b51c2c1d4ab587d448882e6d4691 session=nak1tgrc
2025-12-19 01:23:16.354 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:23:16.355 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:23:16.355 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:23:16.355 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: nak1tgrc
2025-12-19 01:23:16.356 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: dfc1b51c2c1d4ab587d448882e6d4691
2025-12-19 01:23:16.356 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:23:16.356 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:23:16.359 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=dfc1b51c2c1d4ab587d448882e6d4691 session=nak1tgrc
2025-12-19 01:23:16.363 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[dfc1b51c2c1d4ab587d448882e6d4691]}
2025-12-19 01:23:18.214 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:18.397 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:23:18.398 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:23:18.401 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 01:23:18.402 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/975/efrv2q1x/websocket
2025-12-19 01:23:18.402 [http-nio-8080-exec-7] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 93bd863f33994c5cb47ca389317ffe4b
2025-12-19 01:23:18.405 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=efrv2q1x]
2025-12-19 01:23:18.408 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:23:18.408 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=93bd863f33994c5cb47ca389317ffe4b session=efrv2q1x
2025-12-19 01:23:18.409 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:23:18.409 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:23:18.409 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:23:18.410 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: efrv2q1x
2025-12-19 01:23:18.410 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 93bd863f33994c5cb47ca389317ffe4b
2025-12-19 01:23:18.410 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:23:18.410 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:23:18.411 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=93bd863f33994c5cb47ca389317ffe4b session=efrv2q1x
2025-12-19 01:23:18.412 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[93bd863f33994c5cb47ca389317ffe4b]}
2025-12-19 01:23:20.439 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:23:20.439 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=efrv2q1x
2025-12-19 01:23:20.440 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:23:20.440 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:23:20.441 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:23:20.441 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: efrv2q1x
2025-12-19 01:23:20.441 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 93bd863f33994c5cb47ca389317ffe4b
2025-12-19 01:23:20.442 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:23:20.442 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:23:20.443 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=efrv2q1x
2025-12-19 01:23:20.444 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userefrv2q1x]
2025-12-19 01:23:20.445 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userefrv2q1x subscriptionId=sub-0 session=efrv2q1x user=93bd863f33994c5cb47ca389317ffe4b payload=byte[0]
2025-12-19 01:23:23.226 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:23.984 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:23:23.984 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=nak1tgrc
2025-12-19 01:23:23.985 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:23:23.985 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:23:23.985 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:23:23.985 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: nak1tgrc
2025-12-19 01:23:23.985 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: dfc1b51c2c1d4ab587d448882e6d4691
2025-12-19 01:23:23.985 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:23:23.986 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:23:23.986 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:23:23.986 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 50, 51, 58, 50, 51, 34, 44, 34, 105, 100, 34, 58, 34, 57, 51, 98, 100, 56, 54, 51, 102, 51, 51, 57, 57, 52, 99, 53, 99, 98, 52, 55, 99, 97, 51, 56, 57, 51, 49, 55, 102, 102, 101, 52, 98, 34, 125]
2025-12-19 01:23:23.987 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@ceb72e6, simpUser=dfc1b51c2c1d4ab587d448882e6d4691, simpSessionId=nak1tgrc, simpDestination=/ws/privateMessage}
2025-12-19 01:23:23.987 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:23:23","id":"93bd863f33994c5cb47ca389317ffe4b"}
2025-12-19 01:23:23.987 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:23:23.987 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:23:23.987 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:23:23.988 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:23:23.988 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:23:23.989 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:23:23.989 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@ceb72e6, simpUser=dfc1b51c2c1d4ab587d448882e6d4691, simpSessionId=nak1tgrc, simpDestination=/ws/privateMessage}
2025-12-19 01:23:23.991 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=nak1tgrc, lookupDestination='/privateMessage'
2025-12-19 01:23:23.993 [clientInboundChannel-10] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 01:23:23.994 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 01:23:24.022 [clientInboundChannel-10] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [dfc1b51c2c1d4ab587d448882e6d4691, Message(content=測試私信 - 上午1:23:23, recipient=null, id=93bd863f33994c5cb47ca389317ffe4b)]
2025-12-19 01:23:24.023 [clientInboundChannel-10] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 01:23:24.024 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 01:23:24.024 [clientInboundChannel-10] INFO  c.h.s.MessageController - 收到私信請求，發送者: dfc1b51c2c1d4ab587d448882e6d4691
2025-12-19 01:23:24.024 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息物件: Message(content=測試私信 - 上午1:23:23, recipient=null, id=93bd863f33994c5cb47ca389317ffe4b)
2025-12-19 01:23:24.027 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 01:23:24.028 [clientInboundChannel-10] INFO  c.h.s.MessageController - 發送者ID: dfc1b51c2c1d4ab587d448882e6d4691
2025-12-19 01:23:24.028 [clientInboundChannel-10] INFO  c.h.s.MessageController - 接收者ID: 93bd863f33994c5cb47ca389317ffe4b
2025-12-19 01:23:24.028 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息內容: 測試私信 - 上午1:23:23
2025-12-19 01:23:24.028 [clientInboundChannel-10] INFO  c.h.s.MessageController - 目標路徑: /user/93bd863f33994c5cb47ca389317ffe4b/topic/privateMessage
2025-12-19 01:23:24.035 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/93bd863f33994c5cb47ca389317ffe4b/topic/privateMessage session=null payload={"content":"用戶：dfc1b51c2c1d4ab587d448882e6d4691發送的信息：測試私...(truncated)
2025-12-19 01:23:24.036 [clientInboundChannel-10] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/93bd863f33994c5cb47ca389317ffe4b/topic/privateMessage -> [/topic/privateMessage-userefrv2q1x]
2025-12-19 01:23:24.037 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-userefrv2q1x session=null payload={"content":"用戶：dfc1b51c2c1d4ab587d448882e6d4691發送的信息：測試私...(truncated)
2025-12-19 01:23:24.037 [clientInboundChannel-10] INFO  c.h.s.MessageController - 私信已發送到目標用戶: 93bd863f33994c5cb47ca389317ffe4b
2025-12-19 01:23:24.037 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 01:23:28.245 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:33.266 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:36.222 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:23:36.223 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=nak1tgrc
2025-12-19 01:23:36.223 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:23:36.224 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:23:36.224 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:23:36.224 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:23:36.225 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: nak1tgrc
2025-12-19 01:23:36.225 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=efrv2q1x
2025-12-19 01:23:36.225 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: dfc1b51c2c1d4ab587d448882e6d4691
2025-12-19 01:23:36.226 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:23:36.226 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:23:36.226 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:23:36.226 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:23:36.226 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:23:36.227 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: efrv2q1x
2025-12-19 01:23:36.227 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 93bd863f33994c5cb47ca389317ffe4b
2025-12-19 01:23:36.227 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=nak1tgrc
2025-12-19 01:23:36.227 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:23:36.227 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=nak1tgrc] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:23:36.227 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:23:36.228 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session nak1tgrc
2025-12-19 01:23:36.228 [clientOutboundChannel-3] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP ERROR, headers={message=[Session closed.]}
2025-12-19 01:23:36.228 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:23:36.228 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=efrv2q1x
2025-12-19 01:23:36.228 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:23:36.228 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=efrv2q1x] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:23:36.228 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:23:36.229 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session efrv2q1x
2025-12-19 01:23:36.229 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: nak1tgrc
2025-12-19 01:23:36.229 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:23:36.229 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: dfc1b51c2c1d4ab587d448882e6d4691
2025-12-19 01:23:36.229 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:23:36.229 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:23:36.229 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:23:36.229 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:23:36.229 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: efrv2q1x
2025-12-19 01:23:36.230 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 93bd863f33994c5cb47ca389317ffe4b
2025-12-19 01:23:36.230 [clientOutboundChannel-3] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session nak1tgrc
java.lang.IllegalStateException: Cannot send a message when session is closed
	at org.springframework.util.Assert.state(Assert.java:76)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:168)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 01:23:36.230 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:23:36.230 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@39b5c669, simpUser=93bd863f33994c5cb47ca389317ffe4b, simpSessionId=efrv2q1x}], simpUser=93bd863f33994c5cb47ca389317ffe4b, simpSessionId=efrv2q1x}]
2025-12-19 01:23:36.230 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:23:36.231 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=nak1tgrc
2025-12-19 01:23:36.231 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=efrv2q1x
2025-12-19 01:23:36.231 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=dfc1b51c2c1d4ab587d448882e6d4691, simpSessionId=nak1tgrc}], simpUser=dfc1b51c2c1d4ab587d448882e6d4691, simpSessionId=nak1tgrc}]
2025-12-19 01:23:36.231 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=93bd863f33994c5cb47ca389317ffe4b, simpSessionId=efrv2q1x}], simpUser=93bd863f33994c5cb47ca389317ffe4b, simpSessionId=efrv2q1x}]
2025-12-19 01:23:38.283 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:41.297 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [nak1tgrc, efrv2q1x]
2025-12-19 01:23:43.295 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:48.316 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:53.329 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:23:56.789 [MessageBroker-3] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 15, active threads = 1, queued tasks = 1, completed tasks = 9]
2025-12-19 01:23:58.351 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:24:03.363 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:24:08.377 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:24:13.398 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:24:18.414 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:24:23.421 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:24:28.430 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:24:33.446 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:24:38.463 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:24:43.475 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:35:08.716 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 53408 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 01:35:08.724 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 01:35:08.725 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 01:35:09.218 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 01:35:09.220 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 01:35:09.240 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-12-19 01:35:09.636 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 01:35:09.643 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 01:35:09.644 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 01:35:09.645 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 01:35:09.706 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 01:35:09.706 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 923 ms
2025-12-19 01:35:10.204 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 01:35:10.238 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 01:35:08 GMT+08:00 2025
2025-12-19 01:35:10.274 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 01:35:10.276 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 01:35:10.276 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 01:35:10.280 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 01:35:10.298 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 01:35:10.388 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 01:35:10.708 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 01:35:10.724 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 01:35:10.728 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 01:35:10.728 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 01:35:10.729 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 01:35:10.729 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 01:35:10.729 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 01:35:10.729 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 01:35:10.730 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 01:35:10.730 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:35:10.730 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 01:35:11.040 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:35:15.741 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 01:35:15.782 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#26d5a317:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 49690]
2025-12-19 01:35:15.831 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.495 seconds (JVM running for 7.801)
2025-12-19 01:35:16.057 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:35:21.070 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:35:24.251 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 01:35:24.252 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 01:35:24.252 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-12-19 01:35:26.081 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:35:29.492 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7c70aae1
2025-12-19 01:35:29.494 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:35:29.504 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7c70aae1
2025-12-19 01:35:29.506 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/365/btlwuyev/websocket
2025-12-19 01:35:29.509 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 3ebf699fe2194d64aebeb03787bd39ba
2025-12-19 01:35:29.541 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=btlwuyev]
2025-12-19 01:35:29.569 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:35:29.570 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=3ebf699fe2194d64aebeb03787bd39ba session=btlwuyev
2025-12-19 01:35:29.571 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:35:29.572 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:35:29.572 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:35:29.572 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: btlwuyev
2025-12-19 01:35:29.572 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 3ebf699fe2194d64aebeb03787bd39ba
2025-12-19 01:35:29.573 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:35:29.573 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:35:29.574 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=3ebf699fe2194d64aebeb03787bd39ba session=btlwuyev
2025-12-19 01:35:29.580 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[3ebf699fe2194d64aebeb03787bd39ba]}
2025-12-19 01:35:31.089 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:35:31.617 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7c70aae1
2025-12-19 01:35:31.617 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 01:35:31.622 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7c70aae1
2025-12-19 01:35:31.623 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/444/33yrvm0h/websocket
2025-12-19 01:35:31.623 [http-nio-8080-exec-7] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: db4097b3372f4ef9b3bf9a9522695ab4
2025-12-19 01:35:31.626 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=33yrvm0h]
2025-12-19 01:35:31.629 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 01:35:31.629 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=db4097b3372f4ef9b3bf9a9522695ab4 session=33yrvm0h
2025-12-19 01:35:31.629 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:35:31.629 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 01:35:31.630 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:35:31.631 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 33yrvm0h
2025-12-19 01:35:31.631 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: db4097b3372f4ef9b3bf9a9522695ab4
2025-12-19 01:35:31.631 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:35:31.631 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 01:35:31.633 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=db4097b3372f4ef9b3bf9a9522695ab4 session=33yrvm0h
2025-12-19 01:35:31.634 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[db4097b3372f4ef9b3bf9a9522695ab4]}
2025-12-19 01:35:33.659 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 01:35:33.660 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=33yrvm0h
2025-12-19 01:35:33.660 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:35:33.660 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 01:35:33.661 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 01:35:33.661 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 33yrvm0h
2025-12-19 01:35:33.661 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: db4097b3372f4ef9b3bf9a9522695ab4
2025-12-19 01:35:33.661 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:35:33.662 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 01:35:33.663 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=33yrvm0h
2025-12-19 01:35:33.665 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-user33yrvm0h]
2025-12-19 01:35:33.665 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-user33yrvm0h subscriptionId=sub-0 session=33yrvm0h user=db4097b3372f4ef9b3bf9a9522695ab4 payload=byte[0]
2025-12-19 01:35:36.105 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:35:37.192 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 01:35:37.192 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=btlwuyev
2025-12-19 01:35:37.193 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:35:37.193 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 01:35:37.194 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 01:35:37.194 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: btlwuyev
2025-12-19 01:35:37.194 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 3ebf699fe2194d64aebeb03787bd39ba
2025-12-19 01:35:37.194 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:35:37.194 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 01:35:37.195 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 01:35:37.195 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 49, 58, 51, 53, 58, 51, 55, 34, 44, 34, 105, 100, 34, 58, 34, 100, 98, 52, 48, 57, 55, 98, 51, 51, 55, 50, 102, 52, 101, 102, 57, 98, 51, 98, 102, 57, 97, 57, 53, 50, 50, 54, 57, 53, 97, 98, 52, 34, 125]
2025-12-19 01:35:37.195 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@58fc8aaa, simpUser=3ebf699fe2194d64aebeb03787bd39ba, simpSessionId=btlwuyev, simpDestination=/ws/privateMessage}
2025-12-19 01:35:37.195 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午1:35:37","id":"db4097b3372f4ef9b3bf9a9522695ab4"}
2025-12-19 01:35:37.197 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 01:35:37.197 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 01:35:37.197 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 01:35:37.197 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:35:37.197 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 01:35:37.198 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 01:35:37.198 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@58fc8aaa, simpUser=3ebf699fe2194d64aebeb03787bd39ba, simpSessionId=btlwuyev, simpDestination=/ws/privateMessage}
2025-12-19 01:35:37.199 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=btlwuyev, lookupDestination='/privateMessage'
2025-12-19 01:35:37.200 [clientInboundChannel-10] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 01:35:37.200 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 01:35:37.228 [clientInboundChannel-10] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [3ebf699fe2194d64aebeb03787bd39ba, Message(content=測試私信 - 上午1:35:37, recipient=null, id=db4097b3372f4ef9b3bf9a9522695ab4)]
2025-12-19 01:35:37.229 [clientInboundChannel-10] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 01:35:37.229 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 01:35:37.229 [clientInboundChannel-10] INFO  c.h.s.MessageController - 收到私信請求，發送者: 3ebf699fe2194d64aebeb03787bd39ba
2025-12-19 01:35:37.230 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息物件: Message(content=測試私信 - 上午1:35:37, recipient=null, id=db4097b3372f4ef9b3bf9a9522695ab4)
2025-12-19 01:35:37.232 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 01:35:37.232 [clientInboundChannel-10] INFO  c.h.s.MessageController - 發送者ID: 3ebf699fe2194d64aebeb03787bd39ba
2025-12-19 01:35:37.233 [clientInboundChannel-10] INFO  c.h.s.MessageController - 接收者ID: db4097b3372f4ef9b3bf9a9522695ab4
2025-12-19 01:35:37.233 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息內容: 測試私信 - 上午1:35:37
2025-12-19 01:35:37.233 [clientInboundChannel-10] INFO  c.h.s.MessageController - 目標路徑: /user/db4097b3372f4ef9b3bf9a9522695ab4/topic/privateMessage
2025-12-19 01:35:37.239 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/db4097b3372f4ef9b3bf9a9522695ab4/topic/privateMessage session=null payload={"content":"用戶：3ebf699fe2194d64aebeb03787bd39ba發送的信息：測試私...(truncated)
2025-12-19 01:35:37.241 [clientInboundChannel-10] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/db4097b3372f4ef9b3bf9a9522695ab4/topic/privateMessage -> [/topic/privateMessage-user33yrvm0h]
2025-12-19 01:35:37.241 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-user33yrvm0h session=null payload={"content":"用戶：3ebf699fe2194d64aebeb03787bd39ba發送的信息：測試私...(truncated)
2025-12-19 01:35:37.241 [clientInboundChannel-10] INFO  c.h.s.MessageController - 私信已發送到目標用戶: db4097b3372f4ef9b3bf9a9522695ab4
2025-12-19 01:35:37.241 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 01:35:41.119 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:35:46.133 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:35:49.411 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:35:49.412 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=btlwuyev
2025-12-19 01:35:49.413 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:35:49.414 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:35:49.414 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 01:35:49.414 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:35:49.414 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=33yrvm0h
2025-12-19 01:35:49.414 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: btlwuyev
2025-12-19 01:35:49.414 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:35:49.415 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:35:49.415 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 3ebf699fe2194d64aebeb03787bd39ba
2025-12-19 01:35:49.415 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:35:49.415 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:35:49.415 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:35:49.416 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 33yrvm0h
2025-12-19 01:35:49.416 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: db4097b3372f4ef9b3bf9a9522695ab4
2025-12-19 01:35:49.416 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:35:49.416 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=btlwuyev] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:35:49.417 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:35:49.417 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=btlwuyev
2025-12-19 01:35:49.417 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session btlwuyev
2025-12-19 01:35:49.417 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=33yrvm0h] closed with CloseStatus[code=1000, reason=null]
2025-12-19 01:35:49.417 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=33yrvm0h
2025-12-19 01:35:49.418 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session 33yrvm0h
2025-12-19 01:35:49.418 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:35:49.418 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:35:49.418 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 01:35:49.418 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@4429cdcb, simpUser=3ebf699fe2194d64aebeb03787bd39ba, simpSessionId=btlwuyev}], simpUser=3ebf699fe2194d64aebeb03787bd39ba, simpSessionId=btlwuyev}]
2025-12-19 01:35:49.418 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:35:49.418 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 01:35:49.418 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: btlwuyev
2025-12-19 01:35:49.418 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 01:35:49.418 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@100b7f6e, simpUser=db4097b3372f4ef9b3bf9a9522695ab4, simpSessionId=33yrvm0h}], simpUser=db4097b3372f4ef9b3bf9a9522695ab4, simpSessionId=33yrvm0h}]
2025-12-19 01:35:49.418 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 3ebf699fe2194d64aebeb03787bd39ba
2025-12-19 01:35:49.419 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 33yrvm0h
2025-12-19 01:35:49.419 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:35:49.419 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: db4097b3372f4ef9b3bf9a9522695ab4
2025-12-19 01:35:49.419 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:35:49.419 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 01:35:49.420 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 01:35:49.420 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=btlwuyev
2025-12-19 01:35:49.420 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=33yrvm0h
2025-12-19 01:35:49.420 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=3ebf699fe2194d64aebeb03787bd39ba, simpSessionId=btlwuyev}], simpUser=3ebf699fe2194d64aebeb03787bd39ba, simpSessionId=btlwuyev}]
2025-12-19 01:35:49.421 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=db4097b3372f4ef9b3bf9a9522695ab4, simpSessionId=33yrvm0h}], simpUser=db4097b3372f4ef9b3bf9a9522695ab4, simpSessionId=33yrvm0h}]
2025-12-19 01:35:51.145 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:35:54.514 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [btlwuyev, 33yrvm0h]
2025-12-19 01:35:56.166 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:01.181 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:06.201 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:10.224 [MessageBroker-8] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 15, active threads = 1, queued tasks = 1, completed tasks = 9]
2025-12-19 01:36:11.217 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:16.229 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:21.240 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:26.253 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:31.268 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:36.271 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:41.282 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:46.286 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:51.303 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:36:56.321 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:37:01.327 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:37:06.332 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:37:11.349 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:37:16.364 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:37:21.372 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:37:26.380 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 01:37:31.387 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 02:41:34.322 [MessageBroker-13] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 2, queued tasks = 0, completed tasks = 283]
2025-12-19 08:13:17.248 [MessageBroker-10] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 16, active threads = 2, queued tasks = 0, completed tasks = 938]
2025-12-19 08:18:47.676 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 40568 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 08:18:47.685 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 08:18:47.685 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 08:18:48.187 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 08:18:48.189 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 08:18:48.210 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-12-19 08:18:48.638 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 08:18:48.648 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 08:18:48.648 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 08:18:48.649 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 08:18:48.718 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 08:18:48.719 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 980 ms
2025-12-19 08:18:49.353 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 08:18:49.385 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 08:18:47 GMT+08:00 2025
2025-12-19 08:18:49.421 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 08:18:49.423 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 08:18:49.423 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 08:18:49.428 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 08:18:49.445 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 08:18:49.539 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 08:18:49.851 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 08:18:49.873 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 08:18:49.875 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 08:18:49.875 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 08:18:49.875 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 08:18:49.875 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:18:49.876 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:18:49.876 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 08:18:49.876 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 08:18:49.876 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:18:49.876 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:18:50.198 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:18:54.884 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 08:18:54.920 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#26d5a317:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 51032]
2025-12-19 08:18:54.964 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.728 seconds (JVM running for 8.092)
2025-12-19 08:18:55.217 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:00.228 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:02.872 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 08:19:02.873 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 08:19:02.874 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 08:19:05.244 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:08.201 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7c70aae1
2025-12-19 08:19:08.202 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 08:19:08.213 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7c70aae1
2025-12-19 08:19:08.214 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/611/tncxzcdv/websocket
2025-12-19 08:19:08.218 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 6c657319af024208807375023743a102
2025-12-19 08:19:08.243 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=tncxzcdv]
2025-12-19 08:19:08.262 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 08:19:08.263 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=6c657319af024208807375023743a102 session=tncxzcdv
2025-12-19 08:19:08.265 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:19:08.266 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 08:19:08.266 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:19:08.266 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: tncxzcdv
2025-12-19 08:19:08.266 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6c657319af024208807375023743a102
2025-12-19 08:19:08.266 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:19:08.266 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 08:19:08.267 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=6c657319af024208807375023743a102 session=tncxzcdv
2025-12-19 08:19:08.269 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[6c657319af024208807375023743a102]}
2025-12-19 08:19:10.262 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:10.289 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7c70aae1
2025-12-19 08:19:10.289 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 08:19:10.295 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@7c70aae1
2025-12-19 08:19:10.295 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/024/vveldaya/websocket
2025-12-19 08:19:10.296 [http-nio-8080-exec-7] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: d73305f6620d4e0193f3be3cd54663fe
2025-12-19 08:19:10.297 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=vveldaya]
2025-12-19 08:19:10.299 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 08:19:10.299 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=d73305f6620d4e0193f3be3cd54663fe session=vveldaya
2025-12-19 08:19:10.299 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:19:10.299 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 08:19:10.299 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:19:10.299 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: vveldaya
2025-12-19 08:19:10.299 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d73305f6620d4e0193f3be3cd54663fe
2025-12-19 08:19:10.299 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:19:10.299 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 08:19:10.300 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=d73305f6620d4e0193f3be3cd54663fe session=vveldaya
2025-12-19 08:19:10.300 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[d73305f6620d4e0193f3be3cd54663fe]}
2025-12-19 08:19:12.323 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 08:19:12.324 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=vveldaya
2025-12-19 08:19:12.324 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:19:12.324 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 08:19:12.325 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 08:19:12.325 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: vveldaya
2025-12-19 08:19:12.326 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d73305f6620d4e0193f3be3cd54663fe
2025-12-19 08:19:12.326 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:19:12.326 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 08:19:12.327 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=vveldaya
2025-12-19 08:19:12.327 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-uservveldaya]
2025-12-19 08:19:12.328 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-uservveldaya subscriptionId=sub-0 session=vveldaya user=d73305f6620d4e0193f3be3cd54663fe payload=byte[0]
2025-12-19 08:19:15.271 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:15.918 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 08:19:15.918 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=tncxzcdv
2025-12-19 08:19:15.918 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:19:15.918 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 08:19:15.918 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 08:19:15.918 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: tncxzcdv
2025-12-19 08:19:15.918 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6c657319af024208807375023743a102
2025-12-19 08:19:15.918 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:19:15.919 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 08:19:15.919 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 08:19:15.919 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 56, 58, 49, 57, 58, 49, 53, 34, 44, 34, 105, 100, 34, 58, 34, 100, 55, 51, 51, 48, 53, 102, 54, 54, 50, 48, 100, 52, 101, 48, 49, 57, 51, 102, 51, 98, 101, 51, 99, 100, 53, 52, 54, 54, 51, 102, 101, 34, 125]
2025-12-19 08:19:15.919 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@1f8c3056, simpUser=6c657319af024208807375023743a102, simpSessionId=tncxzcdv, simpDestination=/ws/privateMessage}
2025-12-19 08:19:15.920 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午8:19:15","id":"d73305f6620d4e0193f3be3cd54663fe"}
2025-12-19 08:19:15.920 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 08:19:15.920 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 08:19:15.920 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 08:19:15.921 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:19:15.921 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 08:19:15.921 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 08:19:15.921 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@1f8c3056, simpUser=6c657319af024208807375023743a102, simpSessionId=tncxzcdv, simpDestination=/ws/privateMessage}
2025-12-19 08:19:15.921 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=tncxzcdv, lookupDestination='/privateMessage'
2025-12-19 08:19:15.922 [clientInboundChannel-10] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 08:19:15.923 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 08:19:15.951 [clientInboundChannel-10] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [6c657319af024208807375023743a102, Message(content=測試私信 - 上午8:19:15, recipient=null, id=d73305f6620d4e0193f3be3cd54663fe)]
2025-12-19 08:19:15.952 [clientInboundChannel-10] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 08:19:15.952 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 08:19:15.953 [clientInboundChannel-10] INFO  c.h.s.MessageController - 收到私信請求，發送者: 6c657319af024208807375023743a102
2025-12-19 08:19:15.953 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息物件: Message(content=測試私信 - 上午8:19:15, recipient=null, id=d73305f6620d4e0193f3be3cd54663fe)
2025-12-19 08:19:15.954 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 08:19:15.955 [clientInboundChannel-10] INFO  c.h.s.MessageController - 發送者ID: 6c657319af024208807375023743a102
2025-12-19 08:19:15.955 [clientInboundChannel-10] INFO  c.h.s.MessageController - 接收者ID: d73305f6620d4e0193f3be3cd54663fe
2025-12-19 08:19:15.955 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息內容: 測試私信 - 上午8:19:15
2025-12-19 08:19:15.955 [clientInboundChannel-10] INFO  c.h.s.MessageController - 目標路徑: /user/d73305f6620d4e0193f3be3cd54663fe/topic/privateMessage
2025-12-19 08:19:15.963 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/d73305f6620d4e0193f3be3cd54663fe/topic/privateMessage session=null payload={"content":"用戶：6c657319af024208807375023743a102發送的信息：測試私...(truncated)
2025-12-19 08:19:15.965 [clientInboundChannel-10] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/d73305f6620d4e0193f3be3cd54663fe/topic/privateMessage -> [/topic/privateMessage-uservveldaya]
2025-12-19 08:19:15.966 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-uservveldaya session=null payload={"content":"用戶：6c657319af024208807375023743a102發送的信息：測試私...(truncated)
2025-12-19 08:19:15.966 [clientInboundChannel-10] INFO  c.h.s.MessageController - 私信已發送到目標用戶: d73305f6620d4e0193f3be3cd54663fe
2025-12-19 08:19:15.966 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 08:19:20.287 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:25.306 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:28.154 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 08:19:28.154 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=tncxzcdv
2025-12-19 08:19:28.155 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:19:28.155 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:19:28.155 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:19:28.155 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: tncxzcdv
2025-12-19 08:19:28.155 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6c657319af024208807375023743a102
2025-12-19 08:19:28.155 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:19:28.156 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:19:28.156 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 08:19:28.156 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=vveldaya
2025-12-19 08:19:28.156 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:19:28.157 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:19:28.157 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=tncxzcdv
2025-12-19 08:19:28.157 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:19:28.157 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=tncxzcdv] closed with CloseStatus[code=1000, reason=null]
2025-12-19 08:19:28.157 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: vveldaya
2025-12-19 08:19:28.158 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session tncxzcdv
2025-12-19 08:19:28.158 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d73305f6620d4e0193f3be3cd54663fe
2025-12-19 08:19:28.158 [clientOutboundChannel-3] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP ERROR, headers={message=[Session closed.]}
2025-12-19 08:19:28.158 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:19:28.158 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:19:28.158 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:19:28.159 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:19:28.159 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:19:28.159 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: tncxzcdv
2025-12-19 08:19:28.159 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 6c657319af024208807375023743a102
2025-12-19 08:19:28.159 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=vveldaya
2025-12-19 08:19:28.160 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=vveldaya] closed with CloseStatus[code=1000, reason=null]
2025-12-19 08:19:28.160 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session vveldaya
2025-12-19 08:19:28.160 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:19:28.160 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:19:28.160 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:19:28.160 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:19:28.161 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:19:28.161 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: vveldaya
2025-12-19 08:19:28.161 [clientOutboundChannel-3] DEBUG o.s.w.s.m.StompSubProtocolHandler - Failed to send WebSocket message to client in session tncxzcdv
java.lang.IllegalStateException: Cannot send a message when session is closed
	at org.springframework.util.Assert.state(Assert.java:76)
	at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:168)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.tryFlushMessageBuffer(ConcurrentWebSocketSessionDecorator.java:190)
	at org.springframework.web.socket.handler.ConcurrentWebSocketSessionDecorator.sendMessage(ConcurrentWebSocketSessionDecorator.java:163)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.sendToClient(StompSubProtocolHandler.java:494)
	at org.springframework.web.socket.messaging.StompSubProtocolHandler.handleMessageToClient(StompSubProtocolHandler.java:481)
	at org.springframework.web.socket.messaging.SubProtocolWebSocketHandler.handleMessage(SubProtocolWebSocketHandler.java:366)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
2025-12-19 08:19:28.161 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=tncxzcdv
2025-12-19 08:19:28.161 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@79a269d9, simpUser=d73305f6620d4e0193f3be3cd54663fe, simpSessionId=vveldaya}], simpUser=d73305f6620d4e0193f3be3cd54663fe, simpSessionId=vveldaya}]
2025-12-19 08:19:28.161 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: d73305f6620d4e0193f3be3cd54663fe
2025-12-19 08:19:28.162 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:19:28.162 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=6c657319af024208807375023743a102, simpSessionId=tncxzcdv}], simpUser=6c657319af024208807375023743a102, simpSessionId=tncxzcdv}]
2025-12-19 08:19:28.162 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:19:28.162 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=vveldaya
2025-12-19 08:19:28.163 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=d73305f6620d4e0193f3be3cd54663fe, simpSessionId=vveldaya}], simpUser=d73305f6620d4e0193f3be3cd54663fe, simpSessionId=vveldaya}]
2025-12-19 08:19:30.317 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:33.220 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [tncxzcdv, vveldaya]
2025-12-19 08:19:35.334 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:40.355 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:45.369 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:49.376 [MessageBroker-3] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 15, active threads = 1, queued tasks = 1, completed tasks = 9]
2025-12-19 08:19:50.389 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:19:55.402 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:20:00.417 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:20:05.433 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:20:10.451 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:00.020 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 67016 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 08:21:00.029 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 08:21:00.029 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 08:21:00.478 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 08:21:00.479 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 08:21:00.497 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-12-19 08:21:00.867 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 08:21:00.875 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 08:21:00.876 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 08:21:00.876 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 08:21:00.933 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 08:21:00.934 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 856 ms
2025-12-19 08:21:01.424 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 08:21:01.454 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 08:21:00 GMT+08:00 2025
2025-12-19 08:21:01.493 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 08:21:01.495 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 08:21:01.496 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 08:21:01.498 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 08:21:01.514 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 08:21:01.600 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 08:21:01.902 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 08:21:01.925 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 08:21:01.926 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 08:21:01.927 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 08:21:01.927 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 08:21:01.927 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:21:01.928 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:21:01.928 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 08:21:01.928 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 08:21:01.928 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:21:01.928 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:21:02.245 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:06.932 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 08:21:06.972 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 53476]
2025-12-19 08:21:07.027 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.375 seconds (JVM running for 7.706)
2025-12-19 08:21:07.265 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:12.284 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:16.288 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 08:21:16.288 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 08:21:16.289 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 08:21:17.296 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:21.511 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 08:21:21.513 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 08:21:21.521 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 08:21:21.522 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/128/v5mtmecz/websocket
2025-12-19 08:21:21.527 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 110dbc9ac1a743f98937e29068ba4f74
2025-12-19 08:21:21.554 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=v5mtmecz]
2025-12-19 08:21:21.582 [http-nio-8080-exec-4] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 08:21:21.583 [http-nio-8080-exec-4] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=110dbc9ac1a743f98937e29068ba4f74 session=v5mtmecz
2025-12-19 08:21:21.584 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:21:21.584 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 08:21:21.585 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:21:21.585 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: v5mtmecz
2025-12-19 08:21:21.585 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 110dbc9ac1a743f98937e29068ba4f74
2025-12-19 08:21:21.585 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:21:21.585 [http-nio-8080-exec-4] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 08:21:21.586 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=110dbc9ac1a743f98937e29068ba4f74 session=v5mtmecz
2025-12-19 08:21:21.589 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[110dbc9ac1a743f98937e29068ba4f74]}
2025-12-19 08:21:22.303 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:23.610 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 08:21:23.611 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 08:21:23.615 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 08:21:23.615 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/975/eomrm32a/websocket
2025-12-19 08:21:23.616 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: fb364d4f928c4578a2399cbb29c34add
2025-12-19 08:21:23.617 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=eomrm32a]
2025-12-19 08:21:23.619 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 08:21:23.619 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=fb364d4f928c4578a2399cbb29c34add session=eomrm32a
2025-12-19 08:21:23.619 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:21:23.620 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 08:21:23.620 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:21:23.620 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: eomrm32a
2025-12-19 08:21:23.620 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: fb364d4f928c4578a2399cbb29c34add
2025-12-19 08:21:23.620 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:21:23.620 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 08:21:23.621 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=fb364d4f928c4578a2399cbb29c34add session=eomrm32a
2025-12-19 08:21:23.621 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[fb364d4f928c4578a2399cbb29c34add]}
2025-12-19 08:21:25.644 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 08:21:25.645 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=eomrm32a
2025-12-19 08:21:25.645 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:21:25.645 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 08:21:25.645 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 08:21:25.645 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: eomrm32a
2025-12-19 08:21:25.646 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: fb364d4f928c4578a2399cbb29c34add
2025-12-19 08:21:25.646 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:21:25.646 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 08:21:25.646 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=eomrm32a
2025-12-19 08:21:25.647 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-usereomrm32a]
2025-12-19 08:21:25.648 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-usereomrm32a subscriptionId=sub-0 session=eomrm32a user=fb364d4f928c4578a2399cbb29c34add payload=byte[0]
2025-12-19 08:21:27.318 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:29.183 [http-nio-8080-exec-10] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 08:21:29.184 [http-nio-8080-exec-10] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=v5mtmecz
2025-12-19 08:21:29.184 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:21:29.184 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 08:21:29.185 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 08:21:29.185 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: v5mtmecz
2025-12-19 08:21:29.185 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 110dbc9ac1a743f98937e29068ba4f74
2025-12-19 08:21:29.185 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:21:29.185 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 08:21:29.186 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 08:21:29.186 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 56, 58, 50, 49, 58, 50, 57, 34, 44, 34, 105, 100, 34, 58, 34, 102, 98, 51, 54, 52, 100, 52, 102, 57, 50, 56, 99, 52, 53, 55, 56, 97, 50, 51, 57, 57, 99, 98, 98, 50, 57, 99, 51, 52, 97, 100, 100, 34, 125]
2025-12-19 08:21:29.187 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@261ad41d, simpUser=110dbc9ac1a743f98937e29068ba4f74, simpSessionId=v5mtmecz, simpDestination=/ws/privateMessage}
2025-12-19 08:21:29.187 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午8:21:29","id":"fb364d4f928c4578a2399cbb29c34add"}
2025-12-19 08:21:29.187 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 08:21:29.187 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 08:21:29.187 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 08:21:29.187 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:21:29.187 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 08:21:29.187 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 08:21:29.187 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@261ad41d, simpUser=110dbc9ac1a743f98937e29068ba4f74, simpSessionId=v5mtmecz, simpDestination=/ws/privateMessage}
2025-12-19 08:21:29.188 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=v5mtmecz, lookupDestination='/privateMessage'
2025-12-19 08:21:29.191 [clientInboundChannel-10] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 08:21:29.191 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 08:21:29.218 [clientInboundChannel-10] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [110dbc9ac1a743f98937e29068ba4f74, Message(content=測試私信 - 上午8:21:29, recipient=null, id=fb364d4f928c4578a2399cbb29c34add)]
2025-12-19 08:21:29.219 [clientInboundChannel-10] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 08:21:29.219 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 08:21:29.219 [clientInboundChannel-10] INFO  c.h.s.MessageController - 收到私信請求，發送者: 110dbc9ac1a743f98937e29068ba4f74
2025-12-19 08:21:29.219 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息物件: Message(content=測試私信 - 上午8:21:29, recipient=null, id=fb364d4f928c4578a2399cbb29c34add)
2025-12-19 08:21:29.220 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 08:21:29.222 [clientInboundChannel-10] INFO  c.h.s.MessageController - 發送者ID: 110dbc9ac1a743f98937e29068ba4f74
2025-12-19 08:21:29.222 [clientInboundChannel-10] INFO  c.h.s.MessageController - 接收者ID: fb364d4f928c4578a2399cbb29c34add
2025-12-19 08:21:29.222 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息內容: 測試私信 - 上午8:21:29
2025-12-19 08:21:29.222 [clientInboundChannel-10] INFO  c.h.s.MessageController - 目標路徑: /user/fb364d4f928c4578a2399cbb29c34add/topic/privateMessage
2025-12-19 08:21:29.229 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/fb364d4f928c4578a2399cbb29c34add/topic/privateMessage session=null payload={"content":"用戶：110dbc9ac1a743f98937e29068ba4f74發送的信息：測試私...(truncated)
2025-12-19 08:21:29.232 [clientInboundChannel-10] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/fb364d4f928c4578a2399cbb29c34add/topic/privateMessage -> [/topic/privateMessage-usereomrm32a]
2025-12-19 08:21:29.232 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-usereomrm32a session=null payload={"content":"用戶：110dbc9ac1a743f98937e29068ba4f74發送的信息：測試私...(truncated)
2025-12-19 08:21:29.232 [clientInboundChannel-10] INFO  c.h.s.MessageController - 私信已發送到目標用戶: fb364d4f928c4578a2399cbb29c34add
2025-12-19 08:21:29.232 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 08:21:32.332 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:37.342 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:41.460 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 08:21:41.461 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=v5mtmecz
2025-12-19 08:21:41.461 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:21:41.461 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 08:21:41.461 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:21:41.462 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=eomrm32a
2025-12-19 08:21:41.462 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:21:41.462 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:21:41.462 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: v5mtmecz
2025-12-19 08:21:41.462 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:21:41.462 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 110dbc9ac1a743f98937e29068ba4f74
2025-12-19 08:21:41.463 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:21:41.463 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:21:41.463 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: eomrm32a
2025-12-19 08:21:41.463 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:21:41.463 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: fb364d4f928c4578a2399cbb29c34add
2025-12-19 08:21:41.463 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:21:41.464 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:21:41.464 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=v5mtmecz
2025-12-19 08:21:41.464 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=v5mtmecz] closed with CloseStatus[code=1000, reason=null]
2025-12-19 08:21:41.464 [http-nio-8080-exec-1] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session v5mtmecz
2025-12-19 08:21:41.464 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=eomrm32a] closed with CloseStatus[code=1000, reason=null]
2025-12-19 08:21:41.464 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=eomrm32a
2025-12-19 08:21:41.465 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@48de48d2, simpUser=110dbc9ac1a743f98937e29068ba4f74, simpSessionId=v5mtmecz}], simpUser=110dbc9ac1a743f98937e29068ba4f74, simpSessionId=v5mtmecz}]
2025-12-19 08:21:41.465 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:21:41.465 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session eomrm32a
2025-12-19 08:21:41.465 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:21:41.465 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:21:41.465 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:21:41.465 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:21:41.465 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: v5mtmecz
2025-12-19 08:21:41.465 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:21:41.465 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@1c22976a, simpUser=fb364d4f928c4578a2399cbb29c34add, simpSessionId=eomrm32a}], simpUser=fb364d4f928c4578a2399cbb29c34add, simpSessionId=eomrm32a}]
2025-12-19 08:21:41.466 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 110dbc9ac1a743f98937e29068ba4f74
2025-12-19 08:21:41.466 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: eomrm32a
2025-12-19 08:21:41.466 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:21:41.466 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: fb364d4f928c4578a2399cbb29c34add
2025-12-19 08:21:41.466 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:21:41.466 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:21:41.466 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:21:41.467 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=v5mtmecz
2025-12-19 08:21:41.468 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=eomrm32a
2025-12-19 08:21:41.468 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=110dbc9ac1a743f98937e29068ba4f74, simpSessionId=v5mtmecz}], simpUser=110dbc9ac1a743f98937e29068ba4f74, simpSessionId=v5mtmecz}]
2025-12-19 08:21:41.468 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=fb364d4f928c4578a2399cbb29c34add, simpSessionId=eomrm32a}], simpUser=fb364d4f928c4578a2399cbb29c34add, simpSessionId=eomrm32a}]
2025-12-19 08:21:42.365 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:46.534 [MessageBroker-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [eomrm32a, v5mtmecz]
2025-12-19 08:21:47.382 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:52.397 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:21:57.404 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:01.448 [MessageBroker-2] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 6, active threads = 0, queued tasks = 0, completed tasks = 6], sockJsScheduler[pool size = 14, active threads = 1, queued tasks = 1, completed tasks = 8]
2025-12-19 08:22:02.418 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:07.436 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:12.451 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:17.462 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:22.474 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:27.485 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:32.498 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:37.512 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:42.528 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:47.538 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:52.543 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:22:57.560 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:02.576 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:07.593 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:12.608 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:17.622 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:22.632 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:27.637 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:32.649 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:37.666 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:42.677 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:47.679 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:52.694 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:23:57.701 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:24:02.720 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:24:07.733 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:24:12.747 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:24:17.763 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:24:22.779 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:24:27.781 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:24:32.788 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:24:37.803 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:24:42.813 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:24:53.530 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 61740 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 08:24:53.538 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 08:24:53.539 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 08:24:54.044 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 08:24:54.046 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 08:24:54.066 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2025-12-19 08:24:54.449 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 08:24:54.457 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 08:24:54.458 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 08:24:54.458 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 08:24:54.516 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 08:24:54.517 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 928 ms
2025-12-19 08:24:54.982 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 08:24:55.010 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 08:24:53 GMT+08:00 2025
2025-12-19 08:24:55.045 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 08:24:55.047 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 08:24:55.047 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 08:24:55.050 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 08:24:55.066 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 08:24:55.150 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 08:24:55.438 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 08:24:55.455 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 08:24:55.457 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 08:24:55.457 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 08:24:55.458 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 08:24:55.458 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@266da047]
2025-12-19 08:24:55.458 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@266da047]
2025-12-19 08:24:55.458 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@266da047]]
2025-12-19 08:24:55.458 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 08:24:55.459 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:24:55.459 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:24:55.750 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:00.468 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 08:25:00.506 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#5f8a02cf:0/SimpleConnection@18c820d2 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 56460]
2025-12-19 08:25:00.549 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.372 seconds (JVM running for 7.658)
2025-12-19 08:25:00.770 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:05.793 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:10.308 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 08:25:10.309 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 08:25:10.310 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 08:25:10.806 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:15.568 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@38732364
2025-12-19 08:25:15.570 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 08:25:15.579 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@38732364
2025-12-19 08:25:15.580 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/602/xac2w1xi/websocket
2025-12-19 08:25:15.582 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 0aa3d87542044e3694d338ed8c09e144
2025-12-19 08:25:15.611 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=xac2w1xi]
2025-12-19 08:25:15.630 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 08:25:15.631 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=0aa3d87542044e3694d338ed8c09e144 session=xac2w1xi
2025-12-19 08:25:15.632 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:25:15.632 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 08:25:15.633 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:25:15.633 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: xac2w1xi
2025-12-19 08:25:15.633 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0aa3d87542044e3694d338ed8c09e144
2025-12-19 08:25:15.633 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:25:15.633 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 08:25:15.634 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=0aa3d87542044e3694d338ed8c09e144 session=xac2w1xi
2025-12-19 08:25:15.637 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[0aa3d87542044e3694d338ed8c09e144]}
2025-12-19 08:25:15.814 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:17.667 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@38732364
2025-12-19 08:25:17.668 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info
2025-12-19 08:25:17.673 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@38732364
2025-12-19 08:25:17.674 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/945/icituydd/websocket
2025-12-19 08:25:17.674 [http-nio-8080-exec-7] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: e633e21b2e274fef95a81e069f8b7926
2025-12-19 08:25:17.676 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=icituydd]
2025-12-19 08:25:17.678 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[0,0]} session=null
2025-12-19 08:25:17.678 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=e633e21b2e274fef95a81e069f8b7926 session=icituydd
2025-12-19 08:25:17.678 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:25:17.678 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 08:25:17.678 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:25:17.678 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: icituydd
2025-12-19 08:25:17.678 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: e633e21b2e274fef95a81e069f8b7926
2025-12-19 08:25:17.678 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:25:17.678 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 08:25:17.679 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=e633e21b2e274fef95a81e069f8b7926 session=icituydd
2025-12-19 08:25:17.679 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[e633e21b2e274fef95a81e069f8b7926]}
2025-12-19 08:25:19.700 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/user/topic/privateMessage]} session=null
2025-12-19 08:25:19.700 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-0 session=icituydd
2025-12-19 08:25:19.701 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:25:19.701 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 08:25:19.701 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 08:25:19.701 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: icituydd
2025-12-19 08:25:19.702 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: e633e21b2e274fef95a81e069f8b7926
2025-12-19 08:25:19.702 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:25:19.702 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 08:25:19.703 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-0 session=icituydd
2025-12-19 08:25:19.704 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-usericituydd]
2025-12-19 08:25:19.704 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-usericituydd subscriptionId=sub-0 session=icituydd user=e633e21b2e274fef95a81e069f8b7926 payload=byte[0]
2025-12-19 08:25:20.831 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:23.244 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[82]} session=null
2025-12-19 08:25:23.244 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=xac2w1xi
2025-12-19 08:25:23.245 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:25:23.245 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 08:25:23.245 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 08:25:23.245 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: xac2w1xi
2025-12-19 08:25:23.245 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0aa3d87542044e3694d338ed8c09e144
2025-12-19 08:25:23.245 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:25:23.245 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 08:25:23.246 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 08:25:23.246 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, -26, -72, -84, -24, -87, -90, -25, -89, -127, -28, -65, -95, 32, 45, 32, -28, -72, -118, -27, -115, -120, 56, 58, 50, 53, 58, 50, 51, 34, 44, 34, 105, 100, 34, 58, 34, 101, 54, 51, 51, 101, 50, 49, 98, 50, 101, 50, 55, 52, 102, 101, 102, 57, 53, 97, 56, 49, 101, 48, 54, 57, 102, 56, 98, 55, 57, 50, 54, 34, 125]
2025-12-19 08:25:23.246 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@1f8c3056, simpUser=0aa3d87542044e3694d338ed8c09e144, simpSessionId=xac2w1xi, simpDestination=/ws/privateMessage}
2025-12-19 08:25:23.246 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"測試私信 - 上午8:25:23","id":"e633e21b2e274fef95a81e069f8b7926"}
2025-12-19 08:25:23.246 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 08:25:23.247 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 08:25:23.247 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 08:25:23.247 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:25:23.247 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 08:25:23.247 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 08:25:23.247 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[82]}, simpSessionAttributes={}, simpHeartbeat=[J@1f8c3056, simpUser=0aa3d87542044e3694d338ed8c09e144, simpSessionId=xac2w1xi, simpDestination=/ws/privateMessage}
2025-12-19 08:25:23.247 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=xac2w1xi, lookupDestination='/privateMessage'
2025-12-19 08:25:23.248 [clientInboundChannel-10] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 08:25:23.250 [clientInboundChannel-10] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 08:25:23.290 [clientInboundChannel-10] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [0aa3d87542044e3694d338ed8c09e144, Message(content=測試私信 - 上午8:25:23, recipient=null, id=e633e21b2e274fef95a81e069f8b7926)]
2025-12-19 08:25:23.292 [clientInboundChannel-10] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 08:25:23.292 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 08:25:23.293 [clientInboundChannel-10] INFO  c.h.s.MessageController - 收到私信請求，發送者: 0aa3d87542044e3694d338ed8c09e144
2025-12-19 08:25:23.293 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息物件: Message(content=測試私信 - 上午8:25:23, recipient=null, id=e633e21b2e274fef95a81e069f8b7926)
2025-12-19 08:25:23.297 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 08:25:23.297 [clientInboundChannel-10] INFO  c.h.s.MessageController - 發送者ID: 0aa3d87542044e3694d338ed8c09e144
2025-12-19 08:25:23.298 [clientInboundChannel-10] INFO  c.h.s.MessageController - 接收者ID: e633e21b2e274fef95a81e069f8b7926
2025-12-19 08:25:23.298 [clientInboundChannel-10] INFO  c.h.s.MessageController - 訊息內容: 測試私信 - 上午8:25:23
2025-12-19 08:25:23.299 [clientInboundChannel-10] INFO  c.h.s.MessageController - 目標路徑: /user/e633e21b2e274fef95a81e069f8b7926/topic/privateMessage
2025-12-19 08:25:23.312 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/e633e21b2e274fef95a81e069f8b7926/topic/privateMessage session=null payload={"content":"用戶：0aa3d87542044e3694d338ed8c09e144發送的信息：測試私...(truncated)
2025-12-19 08:25:23.315 [clientInboundChannel-10] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/e633e21b2e274fef95a81e069f8b7926/topic/privateMessage -> [/topic/privateMessage-usericituydd]
2025-12-19 08:25:23.316 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-usericituydd session=null payload={"content":"用戶：0aa3d87542044e3694d338ed8c09e144發送的信息：測試私...(truncated)
2025-12-19 08:25:23.317 [clientInboundChannel-10] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Broadcasting to 1 sessions.
2025-12-19 08:25:23.317 [clientInboundChannel-10] INFO  c.h.s.MessageController - 私信已發送到目標用戶: e633e21b2e274fef95a81e069f8b7926
2025-12-19 08:25:23.317 [clientInboundChannel-10] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 08:25:23.317 [clientOutboundChannel-3] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP MESSAGE, headers={destination=[/user/topic/privateMessage], content-type=[application/json], subscription=[sub-0], message-id=[icituydd-0]}
2025-12-19 08:25:25.256 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 08:25:25.257 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=xac2w1xi
2025-12-19 08:25:25.257 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:25:25.257 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:25:25.257 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:25:25.258 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: xac2w1xi
2025-12-19 08:25:25.258 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0aa3d87542044e3694d338ed8c09e144
2025-12-19 08:25:25.258 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:25:25.258 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:25:25.258 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded DISCONNECT  session=null
2025-12-19 08:25:25.258 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: DISCONNECT session=icituydd
2025-12-19 08:25:25.258 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:25:25.259 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:25:25.259 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:25:25.259 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=xac2w1xi
2025-12-19 08:25:25.259 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: icituydd
2025-12-19 08:25:25.259 [http-nio-8080-exec-2] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=xac2w1xi] closed with CloseStatus[code=1000, reason=null]
2025-12-19 08:25:25.259 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: e633e21b2e274fef95a81e069f8b7926
2025-12-19 08:25:25.259 [http-nio-8080-exec-2] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session xac2w1xi
2025-12-19 08:25:25.259 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:25:25.260 [clientOutboundChannel-4] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@1bde82b5, simpUser=0aa3d87542044e3694d338ed8c09e144, simpSessionId=xac2w1xi}], simpUser=0aa3d87542044e3694d338ed8c09e144, simpSessionId=xac2w1xi}]
2025-12-19 08:25:25.260 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:25:25.260 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:25:25.260 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:25:25.260 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:25:25.260 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: xac2w1xi
2025-12-19 08:25:25.261 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 0aa3d87542044e3694d338ed8c09e144
2025-12-19 08:25:25.261 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=icituydd
2025-12-19 08:25:25.261 [http-nio-8080-exec-3] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=icituydd] closed with CloseStatus[code=1000, reason=null]
2025-12-19 08:25:25.261 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:25:25.261 [http-nio-8080-exec-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session icituydd
2025-12-19 08:25:25.261 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:25:25.261 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 08:25:25.261 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 08:25:25.262 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 08:25:25.262 [clientOutboundChannel-5] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={}, simpHeartbeat=[J@5182324b, simpUser=e633e21b2e274fef95a81e069f8b7926, simpSessionId=icituydd}], simpUser=e633e21b2e274fef95a81e069f8b7926, simpSessionId=icituydd}]
2025-12-19 08:25:25.262 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: icituydd
2025-12-19 08:25:25.262 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=xac2w1xi
2025-12-19 08:25:25.262 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: e633e21b2e274fef95a81e069f8b7926
2025-12-19 08:25:25.262 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 08:25:25.262 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 08:25:25.263 [clientOutboundChannel-6] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=0aa3d87542044e3694d338ed8c09e144, simpSessionId=xac2w1xi}], simpUser=0aa3d87542044e3694d338ed8c09e144, simpSessionId=xac2w1xi}]
2025-12-19 08:25:25.264 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=icituydd
2025-12-19 08:25:25.264 [clientOutboundChannel-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=e633e21b2e274fef95a81e069f8b7926, simpSessionId=icituydd}], simpUser=e633e21b2e274fef95a81e069f8b7926, simpSessionId=icituydd}]
2025-12-19 08:25:25.847 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:30.594 [MessageBroker-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 2 sessions: [xac2w1xi, icituydd]
2025-12-19 08:25:30.864 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:35.877 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:40.895 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:45.906 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:50.914 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:25:55.006 [MessageBroker-8] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 2 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(2)-CONNECTED(2)-DISCONNECT(2)], stompBrokerRelay[null], inboundChannel[pool size = 24, active threads = 0, queued tasks = 0, completed tasks = 24], outboundChannel[pool size = 7, active threads = 0, queued tasks = 0, completed tasks = 7], sockJsScheduler[pool size = 15, active threads = 1, queued tasks = 1, completed tasks = 8]
2025-12-19 08:25:55.926 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:00.934 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:05.949 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:10.967 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:15.972 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:20.985 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:25.991 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:31.008 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:36.023 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:41.038 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:46.046 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:51.066 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:26:56.069 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:27:01.075 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:27:06.085 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:27:11.100 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:27:16.112 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:00.611 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 73532 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 08:44:00.622 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 08:44:00.622 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 08:44:01.274 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 08:44:01.277 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 08:44:01.296 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-12-19 08:44:01.687 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 08:44:01.694 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 08:44:01.694 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 08:44:01.694 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 08:44:01.756 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 08:44:01.756 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1046 ms
2025-12-19 08:44:02.256 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 08:44:02.286 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 08:44:00 GMT+08:00 2025
2025-12-19 08:44:02.319 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 08:44:02.321 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 08:44:02.321 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 08:44:02.324 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 08:44:02.340 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 08:44:02.424 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 08:44:02.734 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 08:44:02.752 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 08:44:02.753 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 08:44:02.754 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 08:44:02.754 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 08:44:02.754 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:44:02.754 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:44:02.754 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 08:44:02.755 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 08:44:02.755 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:44:02.755 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:44:03.070 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:07.760 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 08:44:07.796 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 61594]
2025-12-19 08:44:07.839 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.845 seconds (JVM running for 8.173)
2025-12-19 08:44:08.092 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:13.101 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:18.124 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:21.685 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 08:44:21.685 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 08:44:21.686 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 08:44:23.135 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:28.157 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:33.179 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:38.202 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:43.211 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:48.223 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:53.238 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:44:58.256 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:02.266 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-12-19 08:45:03.271 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:08.282 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:13.299 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:18.316 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:23.323 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:28.332 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:33.348 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:38.354 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:43.360 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:48.373 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:53.382 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:45:58.399 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:46:03.406 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:46:08.411 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:46:13.418 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:46:18.429 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:46:23.437 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:46:28.447 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:46:33.466 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:46:38.470 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:46:43.484 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:46:48.495 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:03.896 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 57544 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 08:47:03.903 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 08:47:03.903 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 08:47:04.392 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 08:47:04.394 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 08:47:04.412 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-12-19 08:47:04.793 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 08:47:04.800 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 08:47:04.800 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 08:47:04.801 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 08:47:04.860 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 08:47:04.860 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 899 ms
2025-12-19 08:47:05.352 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 08:47:05.383 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 08:47:03 GMT+08:00 2025
2025-12-19 08:47:05.417 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 08:47:05.419 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 08:47:05.420 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 08:47:05.422 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 08:47:05.438 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 08:47:05.528 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 08:47:05.917 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 08:47:05.936 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 08:47:05.937 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 08:47:05.938 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 08:47:05.938 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 08:47:05.938 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:47:05.938 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:47:05.938 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 08:47:05.939 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 08:47:05.939 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:47:05.939 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:47:06.257 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:10.955 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 08:47:10.992 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 64239]
2025-12-19 08:47:11.036 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.513 seconds (JVM running for 7.835)
2025-12-19 08:47:11.272 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:16.288 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:21.301 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:24.432 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 08:47:24.433 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 08:47:24.435 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-12-19 08:47:26.314 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:31.336 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:36.357 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:41.369 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:46.387 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:51.406 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:47:56.428 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:01.451 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:05.376 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-12-19 08:48:06.477 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:11.497 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:16.515 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:21.536 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:26.546 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:31.566 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:36.585 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:41.597 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:46.616 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:51.623 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:48:56.636 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:49:12.518 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 62700 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 08:49:12.524 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 08:49:12.525 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 08:49:13.019 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 08:49:13.021 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 08:49:13.044 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-12-19 08:49:13.446 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 08:49:13.454 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 08:49:13.455 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 08:49:13.456 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 08:49:13.517 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 08:49:13.517 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 939 ms
2025-12-19 08:49:14.003 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 08:49:14.033 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 08:49:12 GMT+08:00 2025
2025-12-19 08:49:14.065 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 08:49:14.068 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 08:49:14.068 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 08:49:14.072 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 08:49:14.087 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 08:49:14.189 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 08:49:14.488 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 08:49:14.507 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 08:49:14.508 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 08:49:14.509 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 08:49:14.509 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 08:49:14.509 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:49:14.510 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:49:14.510 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 08:49:14.510 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 08:49:14.510 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:49:14.510 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:49:14.817 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:49:19.514 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 08:49:19.553 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 64354]
2025-12-19 08:49:19.599 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.452 seconds (JVM running for 7.771)
2025-12-19 08:49:19.828 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:49:24.843 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:49:29.862 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:49:33.326 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 08:49:33.327 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 08:49:33.328 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 08:49:34.877 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:49:39.893 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:49:44.901 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:49:49.914 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:49:54.937 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:49:59.948 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:04.965 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:09.979 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:14.017 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-12-19 08:50:15.003 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:20.016 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:25.037 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:30.057 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:35.071 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:40.091 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:45.105 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:50.122 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:50:55.137 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:51:10.504 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 16380 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 08:51:10.513 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 08:51:10.513 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 08:51:11.046 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 08:51:11.048 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 08:51:11.067 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-12-19 08:51:11.464 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 08:51:11.472 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 08:51:11.473 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 08:51:11.474 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 08:51:11.532 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 08:51:11.532 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 959 ms
2025-12-19 08:51:12.018 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 08:51:12.049 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 08:51:10 GMT+08:00 2025
2025-12-19 08:51:12.085 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 08:51:12.087 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 08:51:12.088 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 08:51:12.092 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 08:51:12.109 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 08:51:12.200 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 08:51:12.622 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 08:51:12.640 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 08:51:12.642 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 08:51:12.642 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 08:51:12.642 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 08:51:12.643 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:51:12.643 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 08:51:12.643 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 08:51:12.643 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 08:51:12.643 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:51:12.644 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 08:51:12.943 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:51:17.651 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 08:51:17.696 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 64474]
2025-12-19 08:51:17.764 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.714 seconds (JVM running for 8.043)
2025-12-19 08:51:17.955 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:51:22.966 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:51:27.979 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:51:31.086 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 08:51:31.087 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 08:51:31.089 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 08:51:32.993 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:51:38.007 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:51:43.028 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:51:48.039 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:51:53.062 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:51:58.083 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:03.100 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:08.118 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:12.042 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-12-19 08:52:13.140 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:18.151 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:23.168 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:28.186 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:33.191 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:38.195 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:43.202 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:48.210 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:53.221 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:52:58.244 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:53:03.251 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:53:08.259 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:53:13.278 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:53:18.289 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:53:23.299 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:53:28.307 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:53:33.314 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 08:53:38.324 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 09:22:12.047 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 2, active threads = 1, queued tasks = 0, completed tasks = 1]
2025-12-19 10:43:19.467 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 104792 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 10:43:19.473 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 10:43:19.474 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 10:43:20.064 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 10:43:20.065 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 10:43:20.089 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-12-19 10:43:20.499 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 10:43:20.505 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 10:43:20.505 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 10:43:20.506 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 10:43:20.569 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 10:43:20.569 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1040 ms
2025-12-19 10:43:21.095 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 10:43:21.126 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@41ab013, started on Fri Dec 19 10:43:19 GMT+08:00 2025
2025-12-19 10:43:21.166 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 10:43:21.168 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 10:43:21.168 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 10:43:21.171 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 10:43:21.189 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 10:43:21.283 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 10:43:21.614 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 10:43:21.633 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 10:43:21.634 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 10:43:21.634 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 10:43:21.634 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 10:43:21.634 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2c6927f0]
2025-12-19 10:43:21.634 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2c6927f0]
2025-12-19 10:43:21.634 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@2c6927f0]]
2025-12-19 10:43:21.634 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 10:43:21.634 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 10:43:21.634 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 10:43:21.969 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:43:26.644 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 10:43:26.713 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#790d8fdd:0/SimpleConnection@144ee8a7 [delegate=amqp://guest@127.0.0.1:5672/, localPort= 49271]
2025-12-19 10:43:26.789 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.708 seconds (JVM running for 7.996)
2025-12-19 10:43:26.980 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:43:31.987 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:43:37.002 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:43:42.013 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:43:43.673 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 10:43:43.673 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 10:43:43.675 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-12-19 10:43:47.032 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:51:31.502 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 105136 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 10:51:31.509 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 10:51:31.509 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 10:51:32.048 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 10:51:32.051 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 10:51:32.071 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-12-19 10:51:32.509 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 10:51:32.517 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 10:51:32.519 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 10:51:32.519 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 10:51:32.584 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 10:51:32.585 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1016 ms
2025-12-19 10:51:33.168 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 10:51:33.206 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 10:51:31 GMT+08:00 2025
2025-12-19 10:51:33.262 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 10:51:33.266 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 10:51:33.267 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 10:51:33.271 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 10:51:33.289 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 10:51:33.402 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 10:51:33.796 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 10:51:33.826 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 10:51:33.829 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 10:51:33.830 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 10:51:33.831 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 10:51:33.832 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 10:51:33.832 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 10:51:33.832 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 10:51:33.833 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 10:51:33.833 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 10:51:33.833 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 10:51:34.383 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:51:38.839 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 10:51:38.896 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 54960]
2025-12-19 10:51:38.962 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.881 seconds (JVM running for 8.23)
2025-12-19 10:51:39.410 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:51:44.432 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:51:49.457 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:51:54.477 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:51:59.491 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:00.112 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 10:52:00.113 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 10:52:00.114 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 10:52:04.509 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:09.525 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:14.543 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:19.561 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:24.582 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:29.601 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:33.192 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-12-19 10:52:34.624 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:39.646 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:44.666 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:49.687 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:54.706 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:52:59.720 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:04.731 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:09.743 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:14.761 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:19.770 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:24.779 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:29.790 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:34.810 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:39.831 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:44.849 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:49.854 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:54.862 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:53:59.879 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:04.888 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:09.897 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:14.910 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:19.917 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:24.929 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:29.939 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:34.945 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:39.965 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:44.976 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:49.994 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:54:55.001 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:55:00.005 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:55:05.020 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:55:10.026 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:55:15.045 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:55:20.049 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:55:25.063 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:56:51.610 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 97252 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 10:56:51.619 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 10:56:51.619 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 10:56:52.160 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 10:56:52.163 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 10:56:52.182 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-12-19 10:56:52.596 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 10:56:52.604 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 10:56:52.605 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 10:56:52.605 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 10:56:52.668 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 10:56:52.668 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 988 ms
2025-12-19 10:56:53.218 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 10:56:53.250 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 10:56:51 GMT+08:00 2025
2025-12-19 10:56:53.294 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 10:56:53.296 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 10:56:53.297 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 10:56:53.301 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 10:56:53.319 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 10:56:53.419 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 10:56:53.768 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 10:56:53.786 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 10:56:53.789 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 10:56:53.789 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 10:56:53.789 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 10:56:53.789 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 10:56:53.790 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 10:56:53.790 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 10:56:53.790 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 10:56:53.790 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 10:56:53.791 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 10:56:54.123 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:56:58.807 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 10:56:58.900 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 58921]
2025-12-19 10:56:58.972 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.885 seconds (JVM running for 8.5)
2025-12-19 10:56:59.140 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:04.150 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:09.167 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:14.191 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:19.214 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:20.140 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 10:57:20.141 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 10:57:20.142 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 10:57:24.242 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:29.253 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:34.270 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:39.288 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:44.316 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:49.328 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:53.235 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-12-19 10:57:54.342 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:57:59.367 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:04.388 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:09.405 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:14.421 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:19.437 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:24.447 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:29.457 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:34.471 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:39.477 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:44.495 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:49.510 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:54.516 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:58:59.530 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:04.541 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:09.554 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:14.567 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:19.586 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:24.602 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:29.619 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:34.630 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:39.642 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:44.659 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:49.678 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:54.698 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 10:59:59.709 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:00:04.723 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:00:09.738 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:00:14.746 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:00:19.759 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:00:24.774 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:00:29.784 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:00:34.799 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:00:39.813 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:00:44.823 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:05:25.662 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 11:05:25.666 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766113525657
2025-12-19 11:05:25.676 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 11:05:25.684 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/284/pc5fqwax/websocket
2025-12-19 11:05:25.693 [http-nio-8080-exec-5] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 697f5e9de1394d29b93a954e0eb479ac
2025-12-19 11:05:25.756 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=pc5fqwax]
2025-12-19 11:05:25.789 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 11:05:25.790 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=697f5e9de1394d29b93a954e0eb479ac session=pc5fqwax
2025-12-19 11:05:25.792 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:05:25.792 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 11:05:25.792 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:05:25.792 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: pc5fqwax
2025-12-19 11:05:25.792 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 697f5e9de1394d29b93a954e0eb479ac
2025-12-19 11:05:25.794 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:05:25.794 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 11:05:25.795 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=697f5e9de1394d29b93a954e0eb479ac session=pc5fqwax
2025-12-19 11:05:25.800 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[697f5e9de1394d29b93a954e0eb479ac]}
2025-12-19 11:05:25.803 [http-nio-8080-exec-6] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 11:05:25.803 [http-nio-8080-exec-6] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=pc5fqwax
2025-12-19 11:05:25.803 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:05:25.803 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:05:25.803 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 11:05:25.803 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: pc5fqwax
2025-12-19 11:05:25.804 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 697f5e9de1394d29b93a954e0eb479ac
2025-12-19 11:05:25.804 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:05:25.804 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:05:25.805 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=pc5fqwax
2025-12-19 11:05:25.807 [http-nio-8080-exec-6] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 11:05:25.808 [http-nio-8080-exec-6] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=pc5fqwax
2025-12-19 11:05:25.808 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:05:25.808 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:05:25.808 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 11:05:25.809 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: pc5fqwax
2025-12-19 11:05:25.809 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 697f5e9de1394d29b93a954e0eb479ac
2025-12-19 11:05:25.809 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:05:25.809 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:05:25.810 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=pc5fqwax
2025-12-19 11:05:25.811 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userpc5fqwax]
2025-12-19 11:05:25.812 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userpc5fqwax subscriptionId=sub-1 session=pc5fqwax user=697f5e9de1394d29b93a954e0eb479ac payload=byte[0]
2025-12-19 11:05:34.547 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 11:05:34.548 [http-nio-8080-exec-3] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766113534545
2025-12-19 11:05:34.557 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 11:05:34.559 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/194/sk0ovvd4/websocket
2025-12-19 11:05:34.559 [http-nio-8080-exec-4] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 95f9b0d68a494ea0a2f31b265ee68917
2025-12-19 11:05:34.563 [http-nio-8080-exec-4] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=sk0ovvd4]
2025-12-19 11:05:34.571 [http-nio-8080-exec-5] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 11:05:34.572 [http-nio-8080-exec-5] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=95f9b0d68a494ea0a2f31b265ee68917 session=sk0ovvd4
2025-12-19 11:05:34.572 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:05:34.572 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 11:05:34.572 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:05:34.572 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: sk0ovvd4
2025-12-19 11:05:34.572 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 95f9b0d68a494ea0a2f31b265ee68917
2025-12-19 11:05:34.573 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:05:34.573 [http-nio-8080-exec-5] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 11:05:34.574 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=95f9b0d68a494ea0a2f31b265ee68917 session=sk0ovvd4
2025-12-19 11:05:34.574 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[95f9b0d68a494ea0a2f31b265ee68917]}
2025-12-19 11:05:34.578 [http-nio-8080-exec-6] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 11:05:34.578 [http-nio-8080-exec-6] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=sk0ovvd4
2025-12-19 11:05:34.578 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:05:34.578 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:05:34.579 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 11:05:34.579 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: sk0ovvd4
2025-12-19 11:05:34.579 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 95f9b0d68a494ea0a2f31b265ee68917
2025-12-19 11:05:34.579 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:05:34.579 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:05:34.580 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=sk0ovvd4
2025-12-19 11:05:34.580 [http-nio-8080-exec-6] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 11:05:34.580 [http-nio-8080-exec-6] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=sk0ovvd4
2025-12-19 11:05:34.581 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:05:34.581 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:05:34.581 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 11:05:34.581 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: sk0ovvd4
2025-12-19 11:05:34.581 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 95f9b0d68a494ea0a2f31b265ee68917
2025-12-19 11:05:34.581 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:05:34.581 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:05:34.582 [clientInboundChannel-18] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-usersk0ovvd4]
2025-12-19 11:05:34.582 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=sk0ovvd4
2025-12-19 11:05:34.583 [clientInboundChannel-18] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-usersk0ovvd4 subscriptionId=sub-1 session=sk0ovvd4 user=95f9b0d68a494ea0a2f31b265ee68917 payload=byte[0]
2025-12-19 11:05:55.217 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=sk0ovvd4] closed with CloseStatus[code=1000, reason=null]
2025-12-19 11:05:55.218 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session sk0ovvd4
2025-12-19 11:05:55.219 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:05:55.219 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 11:05:55.219 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:05:55.220 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: sk0ovvd4
2025-12-19 11:05:55.220 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 95f9b0d68a494ea0a2f31b265ee68917
2025-12-19 11:05:55.220 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:05:55.220 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 11:05:55.224 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=sk0ovvd4
2025-12-19 11:05:55.225 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=95f9b0d68a494ea0a2f31b265ee68917, simpSessionId=sk0ovvd4}], simpUser=95f9b0d68a494ea0a2f31b265ee68917, simpSessionId=sk0ovvd4}]
2025-12-19 11:05:57.059 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 11:05:57.059 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766113557055
2025-12-19 11:05:57.068 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 11:05:57.069 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/622/yiblc0ci/websocket
2025-12-19 11:05:57.070 [http-nio-8080-exec-9] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 443676b9e49549739c0f5db589dbbc3d
2025-12-19 11:05:57.075 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=yiblc0ci]
2025-12-19 11:05:57.092 [http-nio-8080-exec-10] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 11:05:57.092 [http-nio-8080-exec-10] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=443676b9e49549739c0f5db589dbbc3d session=yiblc0ci
2025-12-19 11:05:57.092 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:05:57.094 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 11:05:57.094 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:05:57.094 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: yiblc0ci
2025-12-19 11:05:57.095 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 443676b9e49549739c0f5db589dbbc3d
2025-12-19 11:05:57.095 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:05:57.095 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 11:05:57.096 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=443676b9e49549739c0f5db589dbbc3d session=yiblc0ci
2025-12-19 11:05:57.097 [clientOutboundChannel-4] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[443676b9e49549739c0f5db589dbbc3d]}
2025-12-19 11:05:57.100 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 11:05:57.101 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=yiblc0ci
2025-12-19 11:05:57.101 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:05:57.101 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:05:57.101 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 11:05:57.101 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: yiblc0ci
2025-12-19 11:05:57.101 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 443676b9e49549739c0f5db589dbbc3d
2025-12-19 11:05:57.102 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:05:57.102 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:05:57.103 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=yiblc0ci
2025-12-19 11:05:57.103 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 11:05:57.103 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=yiblc0ci
2025-12-19 11:05:57.103 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:05:57.103 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:05:57.104 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 11:05:57.104 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: yiblc0ci
2025-12-19 11:05:57.104 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 443676b9e49549739c0f5db589dbbc3d
2025-12-19 11:05:57.105 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:05:57.105 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:05:57.106 [clientInboundChannel-29] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=yiblc0ci
2025-12-19 11:05:57.106 [clientInboundChannel-30] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-useryiblc0ci]
2025-12-19 11:05:57.106 [clientInboundChannel-30] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-useryiblc0ci subscriptionId=sub-1 session=yiblc0ci user=443676b9e49549739c0f5db589dbbc3d payload=byte[0]
2025-12-19 11:06:00.687 [MessageBroker-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [sk0ovvd4]
2025-12-19 11:06:13.499 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[58]} session=null
2025-12-19 11:06:13.499 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=pc5fqwax
2025-12-19 11:06:13.499 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:06:13.499 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 11:06:13.499 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 11:06:13.500 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: pc5fqwax
2025-12-19 11:06:13.500 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 697f5e9de1394d29b93a954e0eb479ac
2025-12-19 11:06:13.500 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:06:13.500 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 11:06:13.500 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 11:06:13.500 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, 116, 101, 115, 116, 34, 44, 34, 105, 100, 34, 58, 34, 52, 52, 51, 54, 55, 54, 98, 57, 101, 52, 57, 53, 52, 57, 55, 51, 57, 99, 48, 102, 53, 100, 98, 53, 56, 57, 100, 98, 98, 99, 51, 100, 34, 125]
2025-12-19 11:06:13.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[58]}, simpSessionAttributes={}, simpHeartbeat=[J@2d6fe288, simpUser=697f5e9de1394d29b93a954e0eb479ac, simpSessionId=pc5fqwax, simpDestination=/ws/privateMessage}
2025-12-19 11:06:13.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"test","id":"443676b9e49549739c0f5db589dbbc3d"}
2025-12-19 11:06:13.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 11:06:13.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 11:06:13.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 11:06:13.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:06:13.502 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 11:06:13.503 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 11:06:13.503 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[58]}, simpSessionAttributes={}, simpHeartbeat=[J@2d6fe288, simpUser=697f5e9de1394d29b93a954e0eb479ac, simpSessionId=pc5fqwax, simpDestination=/ws/privateMessage}
2025-12-19 11:06:13.503 [clientInboundChannel-31] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=pc5fqwax, lookupDestination='/privateMessage'
2025-12-19 11:06:13.506 [clientInboundChannel-31] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 11:06:13.506 [clientInboundChannel-31] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 11:06:13.551 [clientInboundChannel-31] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [697f5e9de1394d29b93a954e0eb479ac, Message(content=test, recipient=null, id=443676b9e49549739c0f5db589dbbc3d)]
2025-12-19 11:06:13.552 [clientInboundChannel-31] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 11:06:13.552 [clientInboundChannel-31] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 11:06:13.552 [clientInboundChannel-31] INFO  c.h.s.MessageController - 收到私信請求，發送者: 697f5e9de1394d29b93a954e0eb479ac
2025-12-19 11:06:13.553 [clientInboundChannel-31] INFO  c.h.s.MessageController - 訊息物件: Message(content=test, recipient=null, id=443676b9e49549739c0f5db589dbbc3d)
2025-12-19 11:06:13.555 [clientInboundChannel-31] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 11:06:13.555 [clientInboundChannel-31] INFO  c.h.s.MessageController - 發送者ID: 697f5e9de1394d29b93a954e0eb479ac
2025-12-19 11:06:13.555 [clientInboundChannel-31] INFO  c.h.s.MessageController - 接收者ID: 443676b9e49549739c0f5db589dbbc3d
2025-12-19 11:06:13.556 [clientInboundChannel-31] INFO  c.h.s.MessageController - 訊息內容: test
2025-12-19 11:06:13.556 [clientInboundChannel-31] INFO  c.h.s.MessageController - 目標路徑: /user/443676b9e49549739c0f5db589dbbc3d/topic/privateMessage
2025-12-19 11:06:13.566 [clientInboundChannel-31] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/443676b9e49549739c0f5db589dbbc3d/topic/privateMessage session=null payload={"content":"用戶：697f5e9de1394d29b93a954e0eb479ac發送的信息：test"}
2025-12-19 11:06:13.568 [clientInboundChannel-31] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/443676b9e49549739c0f5db589dbbc3d/topic/privateMessage -> [/topic/privateMessage-useryiblc0ci]
2025-12-19 11:06:13.569 [clientInboundChannel-31] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-useryiblc0ci session=null payload={"content":"用戶：697f5e9de1394d29b93a954e0eb479ac發送的信息：test"}
2025-12-19 11:06:13.569 [clientInboundChannel-31] INFO  c.h.s.MessageController - 私信已發送到目標用戶: 443676b9e49549739c0f5db589dbbc3d
2025-12-19 11:06:13.569 [clientInboundChannel-31] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 11:06:24.703 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/message], content-length=[18]} session=null
2025-12-19 11:06:24.704 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/message session=pc5fqwax
2025-12-19 11:06:24.705 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:06:24.705 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 11:06:24.705 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/message
2025-12-19 11:06:24.706 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: pc5fqwax
2025-12-19 11:06:24.706 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 697f5e9de1394d29b93a954e0eb479ac
2025-12-19 11:06:24.706 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:06:24.707 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 11:06:24.708 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 11:06:24.708 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, 116, 101, 115, 116, 34, 125]
2025-12-19 11:06:24.708 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/message], content-length=[18]}, simpSessionAttributes={}, simpHeartbeat=[J@b9e283f, simpUser=697f5e9de1394d29b93a954e0eb479ac, simpSessionId=pc5fqwax, simpDestination=/ws/message}
2025-12-19 11:06:24.708 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"test"}
2025-12-19 11:06:24.708 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/message
2025-12-19 11:06:24.708 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /message
2025-12-19 11:06:24.708 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/message")
2025-12-19 11:06:24.709 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:06:24.709 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 11:06:24.709 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 11:06:24.709 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/message], content-length=[18]}, simpSessionAttributes={}, simpHeartbeat=[J@b9e283f, simpUser=697f5e9de1394d29b93a954e0eb479ac, simpSessionId=pc5fqwax, simpDestination=/ws/message}
2025-12-19 11:06:24.709 [clientInboundChannel-3] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/message session=pc5fqwax, lookupDestination='/message'
2025-12-19 11:06:24.709 [clientInboundChannel-3] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/message]}]
2025-12-19 11:06:24.709 [clientInboundChannel-3] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#message[1 args]
2025-12-19 11:06:24.710 [clientInboundChannel-3] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [Message(content=test, recipient=null, id=null)]
2025-12-19 11:06:24.710 [clientInboundChannel-3] INFO  c.h.s.MessageController - === 公共訊息接收 ===
2025-12-19 11:06:24.710 [clientInboundChannel-3] INFO  c.h.s.MessageController - 訊息內容: test
2025-12-19 11:06:24.710 [clientInboundChannel-3] INFO  c.h.s.MessageController - 發布到 Redis /topic/chat 頻道
2025-12-19 11:06:24.715 [clientInboundChannel-3] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle RedisConnectionFailureException
2025-12-19 11:06:24.718 [clientInboundChannel-3] ERROR o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Unhandled exception from message handler method
org.springframework.data.redis.RedisConnectionFailureException: Unable to connect to Redis; nested exception is org.springframework.data.redis.connection.PoolException: Could not get a resource from the pool; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to localhost/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.translateException(LettuceConnectionFactory.java:1689)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1597)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getNativeConnection(LettuceConnectionFactory.java:1383)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$SharedConnection.getConnection(LettuceConnectionFactory.java:1366)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getSharedConnection(LettuceConnectionFactory.java:1093)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory.getConnection(LettuceConnectionFactory.java:421)
	at org.springframework.data.redis.core.RedisConnectionUtils.fetchConnection(RedisConnectionUtils.java:193)
	at org.springframework.data.redis.core.RedisConnectionUtils.doGetConnection(RedisConnectionUtils.java:144)
	at org.springframework.data.redis.core.RedisConnectionUtils.getConnection(RedisConnectionUtils.java:105)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:210)
	at org.springframework.data.redis.core.RedisTemplate.execute(RedisTemplate.java:190)
	at org.springframework.data.redis.core.RedisTemplate.convertAndSend(RedisTemplate.java:847)
	at com.hejz.springbootstomp.RedisMessagePublisher.publish(RedisMessagePublisher.java:88)
	at com.hejz.springbootstomp.RedisMessagePublisher.publish(RedisMessagePublisher.java:124)
	at com.hejz.springbootstomp.MessageController.message(MessageController.java:87)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMatch(AbstractMethodMessageHandler.java:569)
	at org.springframework.messaging.simp.annotation.support.SimpAnnotationMethodMessageHandler.handleMatch(SimpAnnotationMethodMessageHandler.java:511)
	at org.springframework.messaging.simp.annotation.support.SimpAnnotationMethodMessageHandler.handleMatch(SimpAnnotationMethodMessageHandler.java:94)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMessageInternal(AbstractMethodMessageHandler.java:524)
	at org.springframework.messaging.handler.invocation.AbstractMethodMessageHandler.handleMessage(AbstractMethodMessageHandler.java:458)
	at org.springframework.messaging.support.ExecutorSubscribableChannel$SendTask.run(ExecutorSubscribableChannel.java:144)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.springframework.data.redis.connection.PoolException: Could not get a resource from the pool; nested exception is io.lettuce.core.RedisConnectionException: Unable to connect to localhost/<unresolved>:6379
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.getConnection(LettucePoolingConnectionProvider.java:109)
	at org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory$ExceptionTranslatingConnectionProvider.getConnection(LettuceConnectionFactory.java:1595)
	... 28 common frames omitted
Caused by: io.lettuce.core.RedisConnectionException: Unable to connect to localhost/<unresolved>:6379
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:78)
	at io.lettuce.core.RedisConnectionException.create(RedisConnectionException.java:56)
	at io.lettuce.core.AbstractRedisClient.getConnection(AbstractRedisClient.java:330)
	at io.lettuce.core.RedisClient.connect(RedisClient.java:216)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.lambda$getConnection$1(StandaloneConnectionProvider.java:115)
	at java.base/java.util.Optional.orElseGet(Optional.java:364)
	at org.springframework.data.redis.connection.lettuce.StandaloneConnectionProvider.getConnection(StandaloneConnectionProvider.java:115)
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.lambda$null$0(LettucePoolingConnectionProvider.java:97)
	at io.lettuce.core.support.ConnectionPoolSupport$RedisPooledObjectFactory.create(ConnectionPoolSupport.java:211)
	at io.lettuce.core.support.ConnectionPoolSupport$RedisPooledObjectFactory.create(ConnectionPoolSupport.java:201)
	at org.apache.commons.pool2.BasePooledObjectFactory.makeObject(BasePooledObjectFactory.java:70)
	at org.apache.commons.pool2.impl.GenericObjectPool.create(GenericObjectPool.java:571)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:298)
	at org.apache.commons.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:223)
	at io.lettuce.core.support.ConnectionPoolSupport$1.borrowObject(ConnectionPoolSupport.java:122)
	at io.lettuce.core.support.ConnectionPoolSupport$1.borrowObject(ConnectionPoolSupport.java:117)
	at org.springframework.data.redis.connection.lettuce.LettucePoolingConnectionProvider.getConnection(LettucePoolingConnectionProvider.java:103)
	... 29 common frames omitted
Caused by: io.lettuce.core.RedisCommandExecutionException: NOAUTH HELLO must be called with the client already authenticated, otherwise the HELLO <proto> AUTH <user> <pass> option can be used to authenticate the client and select the RESP protocol version at the same time
	at io.lettuce.core.internal.ExceptionFactory.createExecutionException(ExceptionFactory.java:137)
	at io.lettuce.core.internal.ExceptionFactory.createExecutionException(ExceptionFactory.java:110)
	at io.lettuce.core.protocol.AsyncCommand.completeResult(AsyncCommand.java:120)
	at io.lettuce.core.protocol.AsyncCommand.complete(AsyncCommand.java:111)
	at io.lettuce.core.protocol.CommandHandler.complete(CommandHandler.java:746)
	at io.lettuce.core.protocol.CommandHandler.decode(CommandHandler.java:681)
	at io.lettuce.core.protocol.CommandHandler.channelRead(CommandHandler.java:598)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:719)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:655)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:581)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	... 1 common frames omitted
2025-12-19 11:06:29.498 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 11:06:29.499 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766113589496
2025-12-19 11:06:29.508 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@35025a0a
2025-12-19 11:06:29.508 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/830/l5cfdlap/websocket
2025-12-19 11:06:29.509 [http-nio-8080-exec-9] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: b678b2112586444dbc5768ac4f5e4e4c
2025-12-19 11:06:29.520 [http-nio-8080-exec-9] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=l5cfdlap]
2025-12-19 11:06:29.526 [http-nio-8080-exec-10] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 11:06:29.526 [http-nio-8080-exec-10] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=b678b2112586444dbc5768ac4f5e4e4c session=l5cfdlap
2025-12-19 11:06:29.527 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:06:29.527 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 11:06:29.527 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:06:29.527 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: l5cfdlap
2025-12-19 11:06:29.527 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 用戶: b678b2112586444dbc5768ac4f5e4e4c
2025-12-19 11:06:29.528 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:06:29.528 [http-nio-8080-exec-10] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 11:06:29.529 [clientInboundChannel-34] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=b678b2112586444dbc5768ac4f5e4e4c session=l5cfdlap
2025-12-19 11:06:29.530 [clientOutboundChannel-5] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[b678b2112586444dbc5768ac4f5e4e4c]}
2025-12-19 11:06:29.532 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 11:06:29.532 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=l5cfdlap
2025-12-19 11:06:29.532 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:06:29.532 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:06:29.532 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 11:06:29.532 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: l5cfdlap
2025-12-19 11:06:29.532 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: b678b2112586444dbc5768ac4f5e4e4c
2025-12-19 11:06:29.533 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:06:29.533 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:06:29.534 [clientInboundChannel-37] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=l5cfdlap
2025-12-19 11:18:56.920 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 112704 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 11:18:56.931 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 11:18:56.931 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 11:18:57.563 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 11:18:57.566 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 11:18:57.589 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 9 ms. Found 0 Redis repository interfaces.
2025-12-19 11:18:58.260 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 11:18:58.273 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 11:18:58.274 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 11:18:58.275 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 11:18:58.388 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 11:18:58.388 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1394 ms
2025-12-19 11:18:59.034 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 11:18:59.063 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 11:18:56 GMT+08:00 2025
2025-12-19 11:18:59.100 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 11:18:59.103 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 11:18:59.103 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 11:18:59.106 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 11:18:59.129 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 11:18:59.271 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 11:18:59.767 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 11:18:59.796 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 11:18:59.799 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 11:18:59.799 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 11:18:59.799 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 11:18:59.800 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 11:18:59.800 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]
2025-12-19 11:18:59.800 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@68b7bdcb]]
2025-12-19 11:18:59.801 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 11:18:59.802 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 11:18:59.802 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 11:19:00.316 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:04.818 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 11:19:04.886 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#4a6c0f38:0/SimpleConnection@3d3930fe [delegate=amqp://guest@127.0.0.1:5672/, localPort= 58872]
2025-12-19 11:19:04.949 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 8.462 seconds (JVM running for 8.817)
2025-12-19 11:19:05.335 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:10.347 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:15.366 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:20.385 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:24.047 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 11:19:24.048 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 11:19:24.049 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 11:19:25.399 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:30.418 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:35.432 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:40.443 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:45.468 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:50.478 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:55.494 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:19:59.054 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-12-19 11:20:00.516 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:05.524 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:10.543 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:15.555 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:20.567 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:25.576 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:30.584 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:35.590 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:40.597 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:45.605 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:50.613 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:20:55.628 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:21:00.637 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:21:05.653 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:21:10.666 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:21:15.681 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:21:20.699 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:21:25.706 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:22:08.848 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 110204 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 11:22:08.855 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 11:22:08.855 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 11:22:09.451 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 11:22:09.454 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 11:22:09.475 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-12-19 11:22:09.883 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 11:22:09.892 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 11:22:09.893 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 11:22:09.893 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 11:22:09.955 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 11:22:09.956 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1035 ms
2025-12-19 11:22:10.472 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 11:22:10.503 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 11:22:08 GMT+08:00 2025
2025-12-19 11:22:10.536 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 11:22:10.538 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 11:22:10.538 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 11:22:10.543 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 11:22:10.558 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 11:22:10.647 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 11:22:10.963 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 11:22:10.983 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 11:22:10.985 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 11:22:10.985 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 11:22:10.985 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 11:22:10.985 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@726a8729]
2025-12-19 11:22:10.985 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@726a8729]
2025-12-19 11:22:10.985 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@726a8729]]
2025-12-19 11:22:10.985 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 11:22:10.985 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 11:22:10.985 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 11:22:11.450 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:22:16.000 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 11:22:16.055 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#402f8592:0/SimpleConnection@7ea3839e [delegate=amqp://guest@127.0.0.1:5672/, localPort= 53166]
2025-12-19 11:22:16.117 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.686 seconds (JVM running for 8.028)
2025-12-19 11:22:16.472 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:22:21.493 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:22:26.511 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:22:31.532 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:22:36.546 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:22:41.416 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 11:22:41.416 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 11:22:41.418 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-12-19 11:22:41.569 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:22:46.597 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:22:51.619 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:22:56.640 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:01.653 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:06.670 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:10.486 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-12-19 11:23:11.695 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:16.705 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:21.720 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:26.747 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:31.762 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:36.775 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:41.786 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:46.801 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:51.857 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:23:56.884 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:01.896 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:06.912 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:11.925 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:16.934 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:21.949 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:26.960 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:31.975 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:36.979 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:41.984 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:47.004 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:52.024 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:24:57.040 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:02.047 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:07.064 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:12.084 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:17.094 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:22.110 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:27.127 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:32.136 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:37.153 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:42.169 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:47.182 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:52.196 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:25:57.207 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:26:56.551 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 11:26:56.553 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766114816548
2025-12-19 11:26:56.563 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 11:26:56.575 [http-nio-8080-exec-6] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/647/f40mn01e/websocket
2025-12-19 11:26:56.584 [http-nio-8080-exec-6] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 19721dcf66a04ee7b1d4087fc4db8019
2025-12-19 11:26:56.636 [http-nio-8080-exec-6] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=f40mn01e]
2025-12-19 11:26:56.659 [http-nio-8080-exec-6] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 11:26:56.660 [http-nio-8080-exec-6] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=19721dcf66a04ee7b1d4087fc4db8019 session=f40mn01e
2025-12-19 11:26:56.662 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:26:56.662 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 11:26:56.662 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:26:56.662 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: f40mn01e
2025-12-19 11:26:56.662 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 19721dcf66a04ee7b1d4087fc4db8019
2025-12-19 11:26:56.663 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:26:56.663 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 11:26:56.664 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=19721dcf66a04ee7b1d4087fc4db8019 session=f40mn01e
2025-12-19 11:26:56.668 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[19721dcf66a04ee7b1d4087fc4db8019]}
2025-12-19 11:26:56.671 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 11:26:56.671 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=f40mn01e
2025-12-19 11:26:56.671 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:26:56.672 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:26:56.672 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 11:26:56.672 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: f40mn01e
2025-12-19 11:26:56.672 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 19721dcf66a04ee7b1d4087fc4db8019
2025-12-19 11:26:56.672 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:26:56.672 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:26:56.673 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=f40mn01e
2025-12-19 11:27:27.296 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 11:27:27.297 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766114847293
2025-12-19 11:27:27.312 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 11:27:27.313 [http-nio-8080-exec-1] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/716/f0oezd5z/websocket
2025-12-19 11:27:27.314 [http-nio-8080-exec-1] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 122cc01797bf4bd5958a1c7789164d02
2025-12-19 11:27:27.317 [http-nio-8080-exec-1] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=f0oezd5z]
2025-12-19 11:27:27.331 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 11:27:27.332 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=122cc01797bf4bd5958a1c7789164d02 session=f0oezd5z
2025-12-19 11:27:27.332 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:27:27.332 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 11:27:27.332 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:27:27.333 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: f0oezd5z
2025-12-19 11:27:27.333 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 122cc01797bf4bd5958a1c7789164d02
2025-12-19 11:27:27.333 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:27:27.333 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 11:27:27.334 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=122cc01797bf4bd5958a1c7789164d02 session=f0oezd5z
2025-12-19 11:27:27.336 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[122cc01797bf4bd5958a1c7789164d02]}
2025-12-19 11:27:27.340 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 11:27:27.340 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=f0oezd5z
2025-12-19 11:27:27.341 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:27:27.341 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:27:27.341 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 11:27:27.341 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: f0oezd5z
2025-12-19 11:27:27.341 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 122cc01797bf4bd5958a1c7789164d02
2025-12-19 11:27:27.342 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:27:27.342 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:27:27.343 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=f0oezd5z
2025-12-19 11:27:27.343 [http-nio-8080-exec-3] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 11:27:27.343 [http-nio-8080-exec-3] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=f0oezd5z
2025-12-19 11:27:27.343 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:27:27.343 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:27:27.344 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 11:27:27.344 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: f0oezd5z
2025-12-19 11:27:27.344 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 122cc01797bf4bd5958a1c7789164d02
2025-12-19 11:27:27.344 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:27:27.344 [http-nio-8080-exec-3] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:27:27.345 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=f0oezd5z
2025-12-19 11:27:27.346 [clientInboundChannel-15] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userf0oezd5z]
2025-12-19 11:27:27.346 [clientInboundChannel-15] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userf0oezd5z subscriptionId=sub-1 session=f0oezd5z user=122cc01797bf4bd5958a1c7789164d02 payload=byte[0]
2025-12-19 11:29:18.797 [http-nio-8080-exec-7] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - WebSocketServerSockJsSession[id=f0oezd5z] closed with CloseStatus[code=1000, reason=null]
2025-12-19 11:29:18.797 [http-nio-8080-exec-7] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - Clearing session f0oezd5z
2025-12-19 11:29:18.798 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:29:18.799 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: DISCONNECT
2025-12-19 11:29:18.799 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:29:18.800 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: f0oezd5z
2025-12-19 11:29:18.800 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 122cc01797bf4bd5958a1c7789164d02
2025-12-19 11:29:18.800 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:29:18.800 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): DISCONNECT
2025-12-19 11:29:18.803 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing DISCONNECT session=f0oezd5z
2025-12-19 11:29:18.805 [clientOutboundChannel-3] DEBUG o.s.w.s.m.SubProtocolWebSocketHandler - No session for GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT_ACK, simpDisconnectMessage=GenericMessage [payload=byte[0], headers={simpMessageType=DISCONNECT, stompCommand=DISCONNECT, simpSessionAttributes={org.springframework.messaging.simp.SimpAttributes.COMPLETED=true}, simpUser=122cc01797bf4bd5958a1c7789164d02, simpSessionId=f0oezd5z}], simpUser=122cc01797bf4bd5958a1c7789164d02, simpSessionId=f0oezd5z}]
2025-12-19 11:29:19.101 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 11:29:19.101 [http-nio-8080-exec-9] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766114959097
2025-12-19 11:29:19.114 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 11:29:19.115 [http-nio-8080-exec-10] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/355/ywapg5dx/websocket
2025-12-19 11:29:19.116 [http-nio-8080-exec-10] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: ba86f6110bc347c7b5257c8e54743e65
2025-12-19 11:29:19.121 [http-nio-8080-exec-10] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=ywapg5dx]
2025-12-19 11:29:19.129 [http-nio-8080-exec-1] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 11:29:19.129 [http-nio-8080-exec-1] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=ba86f6110bc347c7b5257c8e54743e65 session=ywapg5dx
2025-12-19 11:29:19.130 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:29:19.130 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 11:29:19.130 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:29:19.130 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: ywapg5dx
2025-12-19 11:29:19.131 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 用戶: ba86f6110bc347c7b5257c8e54743e65
2025-12-19 11:29:19.131 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:29:19.131 [http-nio-8080-exec-1] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 11:29:19.132 [clientInboundChannel-20] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=ba86f6110bc347c7b5257c8e54743e65 session=ywapg5dx
2025-12-19 11:29:19.133 [clientOutboundChannel-4] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[ba86f6110bc347c7b5257c8e54743e65]}
2025-12-19 11:29:19.151 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 11:29:19.152 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=ywapg5dx
2025-12-19 11:29:19.152 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:29:19.152 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:29:19.152 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 11:29:19.152 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: ywapg5dx
2025-12-19 11:29:19.153 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: ba86f6110bc347c7b5257c8e54743e65
2025-12-19 11:29:19.153 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:29:19.153 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:29:19.154 [clientInboundChannel-23] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=ywapg5dx
2025-12-19 11:29:19.154 [http-nio-8080-exec-2] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 11:29:19.154 [http-nio-8080-exec-2] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=ywapg5dx
2025-12-19 11:29:19.154 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:29:19.154 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:29:19.154 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 11:29:19.155 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: ywapg5dx
2025-12-19 11:29:19.155 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 用戶: ba86f6110bc347c7b5257c8e54743e65
2025-12-19 11:29:19.155 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:29:19.155 [http-nio-8080-exec-2] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:29:19.156 [clientInboundChannel-26] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=ywapg5dx
2025-12-19 11:29:19.157 [clientInboundChannel-27] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userywapg5dx]
2025-12-19 11:29:19.157 [clientInboundChannel-27] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userywapg5dx subscriptionId=sub-1 session=ywapg5dx user=ba86f6110bc347c7b5257c8e54743e65 payload=byte[0]
2025-12-19 11:29:26.589 [MessageBroker-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Closed 1 sessions: [f0oezd5z]
2025-12-19 11:31:23.647 [main] INFO  c.h.s.SpringBootStompApplication - Starting SpringBootStompApplication using Java 17.0.9 on LAPTOP-1FK1FC7K with PID 114156 (C:\spring-boot-stomp-websocket\target\classes started by 賈其翔 in C:\spring-boot-stomp-websocket)
2025-12-19 11:31:23.653 [main] DEBUG c.h.s.SpringBootStompApplication - Running with Spring Boot v2.6.1, Spring v5.3.13
2025-12-19 11:31:23.653 [main] INFO  c.h.s.SpringBootStompApplication - No active profile set, falling back to default profiles: default
2025-12-19 11:31:24.164 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode!
2025-12-19 11:31:24.166 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-19 11:31:24.183 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 8 ms. Found 0 Redis repository interfaces.
2025-12-19 11:31:24.587 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2025-12-19 11:31:24.596 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-12-19 11:31:24.597 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-12-19 11:31:24.597 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.55]
2025-12-19 11:31:24.657 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-19 11:31:24.657 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 950 ms
2025-12-19 11:31:25.412 [main] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Patterns [/our-websocket/**] in 'stompWebSocketHandlerMapping'
2025-12-19 11:31:25.446 [main] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Looking for @MessageExceptionHandler mappings: org.springframework.boot.web.servlet.context.AnnotationConfigServletWebServerApplicationContext@82ea68c, started on Fri Dec 19 11:31:23 GMT+08:00 2025
2025-12-19 11:31:25.486 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.MessageController:
	{[MESSAGE],[/message]}: message(Message)
	{[MESSAGE],[/privateMessage]}: privateMessage(Principal,Message)
2025-12-19 11:31:25.488 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.WsController:
	
2025-12-19 11:31:25.489 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	c.h.s.c.HeartbeatController:
	{[MESSAGE],[/heartbeat]}: handleHeartbeat(Principal,HeartbeatMessage)
2025-12-19 11:31:25.492 [main] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - 
	o.s.b.a.w.s.e.BasicErrorController:
	
2025-12-19 11:31:25.509 [main] INFO  c.h.s.config.RedisConfig - RedisMessageListenerContainer 已配置，將在應用程式啟動後自動連接 Redis
2025-12-19 11:31:25.606 [main] INFO  o.s.b.a.w.s.WelcomePageHandlerMapping - Adding welcome page: class path resource [static/index.html]
2025-12-19 11:31:25.923 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-12-19 11:31:25.941 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2025-12-19 11:31:25.943 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientOutboundChannel added SubProtocolWebSocketHandler[StompSubProtocolHandler[v10.stomp, v11.stomp, v12.stomp]]
2025-12-19 11:31:25.943 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added WebSocketAnnotationMethodMessageHandler[prefixes=[/ws/]]
2025-12-19 11:31:25.943 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Starting...
2025-12-19 11:31:25.944 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@726a8729]
2025-12-19 11:31:25.944 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@726a8729]
2025-12-19 11:31:25.944 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - BrokerAvailabilityEvent[available=true, SimpleBrokerMessageHandler [org.springframework.messaging.simp.broker.DefaultSubscriptionRegistry@726a8729]]
2025-12-19 11:31:25.945 [main] INFO  o.s.m.s.b.SimpleBrokerMessageHandler - Started.
2025-12-19 11:31:25.945 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - clientInboundChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 11:31:25.945 [main] DEBUG o.s.m.s.ExecutorSubscribableChannel - brokerChannel added UserDestinationMessageHandler[DefaultUserDestinationResolver[prefix=/user/]]
2025-12-19 11:31:26.263 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:31:30.961 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Attempting to connect to: [localhost:5672]
2025-12-19 11:31:31.005 [main] INFO  o.s.a.r.c.CachingConnectionFactory - Created new connection: rabbitConnectionFactory#402f8592:0/SimpleConnection@7ea3839e [delegate=amqp://guest@127.0.0.1:5672/, localPort= 65024]
2025-12-19 11:31:31.054 [main] INFO  c.h.s.SpringBootStompApplication - Started SpringBootStompApplication in 7.792 seconds (JVM running for 8.119)
2025-12-19 11:31:31.276 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:31:36.298 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:31:41.307 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:31:46.316 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:31:51.335 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:31:56.345 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:31:58.988 [http-nio-8080-exec-1] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-12-19 11:31:58.988 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-12-19 11:31:58.989 [http-nio-8080-exec-1] INFO  o.s.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-12-19 11:32:01.366 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:06.445 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:11.468 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:16.479 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:21.498 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:25.433 [MessageBroker-1] INFO  o.s.w.s.c.WebSocketMessageBrokerStats - WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)], stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], outboundChannel[pool size = 0, active threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2025-12-19 11:32:26.513 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:31.521 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:36.533 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:41.548 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:46.555 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:51.564 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:56.584 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:32:56.741 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 11:32:56.752 [http-nio-8080-exec-7] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766115176731
2025-12-19 11:32:56.768 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 11:32:56.788 [http-nio-8080-exec-8] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/181/m3is0ney/websocket
2025-12-19 11:32:56.803 [http-nio-8080-exec-8] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 67c2e5918b514065bbbf98a4dd15ff61
2025-12-19 11:32:56.905 [http-nio-8080-exec-8] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=m3is0ney]
2025-12-19 11:32:56.949 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 11:32:56.950 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=67c2e5918b514065bbbf98a4dd15ff61 session=m3is0ney
2025-12-19 11:32:56.953 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:32:56.954 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 11:32:56.954 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:32:56.954 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: m3is0ney
2025-12-19 11:32:56.955 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 67c2e5918b514065bbbf98a4dd15ff61
2025-12-19 11:32:56.955 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:32:56.955 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 11:32:56.957 [clientInboundChannel-2] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=67c2e5918b514065bbbf98a4dd15ff61 session=m3is0ney
2025-12-19 11:32:56.963 [clientOutboundChannel-1] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[67c2e5918b514065bbbf98a4dd15ff61]}
2025-12-19 11:32:56.969 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 11:32:56.970 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=m3is0ney
2025-12-19 11:32:56.970 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:32:56.971 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:32:56.971 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 11:32:56.971 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: m3is0ney
2025-12-19 11:32:56.971 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 67c2e5918b514065bbbf98a4dd15ff61
2025-12-19 11:32:56.972 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:32:56.972 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:32:56.974 [clientInboundChannel-5] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=m3is0ney
2025-12-19 11:32:56.976 [http-nio-8080-exec-9] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 11:32:56.976 [http-nio-8080-exec-9] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=m3is0ney
2025-12-19 11:32:56.977 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:32:56.977 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:32:56.977 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 11:32:56.977 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: m3is0ney
2025-12-19 11:32:56.978 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 67c2e5918b514065bbbf98a4dd15ff61
2025-12-19 11:32:56.978 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:32:56.978 [http-nio-8080-exec-9] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:32:56.980 [clientInboundChannel-8] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=m3is0ney
2025-12-19 11:32:56.981 [clientInboundChannel-9] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-userm3is0ney]
2025-12-19 11:32:56.982 [clientInboundChannel-9] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-userm3is0ney subscriptionId=sub-1 session=m3is0ney user=67c2e5918b514065bbbf98a4dd15ff61 payload=byte[0]
2025-12-19 11:33:01.592 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:06.612 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:11.616 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:16.627 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:21.644 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:26.652 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:31.671 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:36.688 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:41.695 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:46.703 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:51.708 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:33:56.723 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:01.736 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:04.828 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 11:34:04.830 [http-nio-8080-exec-4] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/info?t=1766115244805
2025-12-19 11:34:04.853 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.s.WebSocketHandlerMapping - Mapped to org.springframework.web.socket.sockjs.support.SockJsHttpRequestHandler@1f916219
2025-12-19 11:34:04.854 [http-nio-8080-exec-5] DEBUG o.s.w.s.s.t.h.DefaultSockJsService - Processing transport request: GET http://localhost:8080/our-websocket/915/30odobhk/websocket
2025-12-19 11:34:04.855 [http-nio-8080-exec-5] INFO  c.h.s.Userhandshakehandler - 登入用戶 ID: 76b3fe0b900d4841b51af801ee8e1a12
2025-12-19 11:34:04.870 [http-nio-8080-exec-5] DEBUG o.s.w.s.h.LoggingWebSocketHandlerDecorator - New WebSocketServerSockJsSession[id=30odobhk]
2025-12-19 11:34:04.874 [http-nio-8080-exec-6] TRACE o.s.m.simp.stomp.StompDecoder - Decoded CONNECT {accept-version=[1.1,1.0], heart-beat=[10000,10000]} session=null
2025-12-19 11:34:04.875 [http-nio-8080-exec-6] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: CONNECT user=76b3fe0b900d4841b51af801ee8e1a12 session=30odobhk
2025-12-19 11:34:04.875 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:34:04.876 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: CONNECT
2025-12-19 11:34:04.876 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: null
2025-12-19 11:34:04.876 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 30odobhk
2025-12-19 11:34:04.877 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 76b3fe0b900d4841b51af801ee8e1a12
2025-12-19 11:34:04.877 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:34:04.877 [http-nio-8080-exec-6] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): CONNECT
2025-12-19 11:34:04.879 [clientInboundChannel-11] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing CONNECT user=76b3fe0b900d4841b51af801ee8e1a12 session=30odobhk
2025-12-19 11:34:04.880 [clientOutboundChannel-2] TRACE o.s.m.simp.stomp.StompEncoder - Encoding STOMP CONNECTED, headers={version=[1.1], heart-beat=[0,0], user-name=[76b3fe0b900d4841b51af801ee8e1a12]}
2025-12-19 11:34:04.884 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-0], destination=[/topic/chat]} session=null
2025-12-19 11:34:04.885 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /topic/chat id=sub-0 session=30odobhk
2025-12-19 11:34:04.885 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:34:04.885 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:34:04.885 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /topic/chat
2025-12-19 11:34:04.886 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 30odobhk
2025-12-19 11:34:04.886 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 76b3fe0b900d4841b51af801ee8e1a12
2025-12-19 11:34:04.886 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:34:04.886 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:34:04.887 [clientInboundChannel-14] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /topic/chat id=sub-0 session=30odobhk
2025-12-19 11:34:04.888 [http-nio-8080-exec-7] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SUBSCRIBE {id=[sub-1], destination=[/user/topic/privateMessage]} session=null
2025-12-19 11:34:04.888 [http-nio-8080-exec-7] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SUBSCRIBE /user/topic/privateMessage id=sub-1 session=30odobhk
2025-12-19 11:34:04.888 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:34:04.889 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SUBSCRIBE
2025-12-19 11:34:04.889 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /user/topic/privateMessage
2025-12-19 11:34:04.889 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: 30odobhk
2025-12-19 11:34:04.889 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 76b3fe0b900d4841b51af801ee8e1a12
2025-12-19 11:34:04.889 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:34:04.890 [http-nio-8080-exec-7] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): SUBSCRIBE
2025-12-19 11:34:04.891 [clientInboundChannel-17] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE /user/topic/privateMessage id=sub-1 session=30odobhk
2025-12-19 11:34:04.891 [clientInboundChannel-18] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/topic/privateMessage -> [/topic/privateMessage-user30odobhk]
2025-12-19 11:34:04.891 [clientInboundChannel-18] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing SUBSCRIBE destination=/topic/privateMessage-user30odobhk subscriptionId=sub-1 session=30odobhk user=76b3fe0b900d4841b51af801ee8e1a12 payload=byte[0]
2025-12-19 11:34:06.750 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:11.765 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:16.783 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:21.801 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:25.331 [http-nio-8080-exec-8] TRACE o.s.m.simp.stomp.StompDecoder - Decoded SEND {destination=[/ws/privateMessage], content-length=[58]} session=null
2025-12-19 11:34:25.331 [http-nio-8080-exec-8] TRACE o.s.w.s.m.StompSubProtocolHandler - From client: SEND /ws/privateMessage session=m3is0ney
2025-12-19 11:34:25.332 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - === WebSocket 訊息攔截 ===
2025-12-19 11:34:25.332 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - STOMP 命令: SEND
2025-12-19 11:34:25.332 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑: /ws/privateMessage
2025-12-19 11:34:25.332 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 會話 ID: m3is0ney
2025-12-19 11:34:25.332 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 用戶: 67c2e5918b514065bbbf98a4dd15ff61
2025-12-19 11:34:25.334 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:34:25.334 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息類型 (simpMessageType): MESSAGE
2025-12-19 11:34:25.334 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容類型: [B
2025-12-19 11:34:25.334 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容: [123, 34, 99, 111, 110, 116, 101, 110, 116, 34, 58, 34, 97, 97, 97, 97, 34, 44, 34, 105, 100, 34, 58, 34, 55, 54, 98, 51, 102, 101, 48, 98, 57, 48, 48, 100, 52, 56, 52, 49, 98, 53, 49, 97, 102, 56, 48, 49, 101, 101, 56, 101, 49, 97, 49, 50, 34, 125]
2025-12-19 11:34:25.335 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息頭: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[58]}, simpSessionAttributes={}, simpHeartbeat=[J@b018ca9, simpUser=67c2e5918b514065bbbf98a4dd15ff61, simpSessionId=m3is0ney, simpDestination=/ws/privateMessage}
2025-12-19 11:34:25.335 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息內容（字串）: {"content":"aaaa","id":"76b3fe0b900d4841b51af801ee8e1a12"}
2025-12-19 11:34:25.335 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 目標路徑（用於路由）: /ws/privateMessage
2025-12-19 11:34:25.336 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 預期的 @MessageMapping 路徑: /privateMessage
2025-12-19 11:34:25.336 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 應該匹配 @MessageMapping("/privateMessage")
2025-12-19 11:34:25.336 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道類型: org.springframework.messaging.support.ExecutorSubscribableChannel
2025-12-19 11:34:25.336 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 訊息通道字符串: ExecutorSubscribableChannel[clientInboundChannel]
2025-12-19 11:34:25.336 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - ✓ 訊息已進入 clientInboundChannel
2025-12-19 11:34:25.337 [http-nio-8080-exec-8] INFO  c.h.s.config.WebSocketInterceptor - 完整訊息頭映射: {simpMessageType=MESSAGE, stompCommand=SEND, nativeHeaders={destination=[/ws/privateMessage], content-length=[58]}, simpSessionAttributes={}, simpHeartbeat=[J@b018ca9, simpUser=67c2e5918b514065bbbf98a4dd15ff61, simpSessionId=m3is0ney, simpDestination=/ws/privateMessage}
2025-12-19 11:34:25.338 [clientInboundChannel-19] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Searching methods to handle SEND /ws/privateMessage session=m3is0ney, lookupDestination='/privateMessage'
2025-12-19 11:34:25.339 [clientInboundChannel-19] TRACE o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Found 1 handler methods: [{[MESSAGE],[/privateMessage]}]
2025-12-19 11:34:25.340 [clientInboundChannel-19] DEBUG o.s.w.s.m.WebSocketAnnotationMethodMessageHandler - Invoking MessageController#privateMessage[2 args]
2025-12-19 11:34:25.379 [clientInboundChannel-19] TRACE o.s.messaging.handler.HandlerMethod - Arguments: [67c2e5918b514065bbbf98a4dd15ff61, Message(content=aaaa, recipient=null, id=76b3fe0b900d4841b51af801ee8e1a12)]
2025-12-19 11:34:25.379 [clientInboundChannel-19] ERROR c.h.s.MessageController - === 私信接收開始（ERROR 級別確保可見） ===
2025-12-19 11:34:25.380 [clientInboundChannel-19] INFO  c.h.s.MessageController - === 私信接收開始 ===
2025-12-19 11:34:25.380 [clientInboundChannel-19] INFO  c.h.s.MessageController - 收到私信請求，發送者: 67c2e5918b514065bbbf98a4dd15ff61
2025-12-19 11:34:25.381 [clientInboundChannel-19] INFO  c.h.s.MessageController - 訊息物件: Message(content=aaaa, recipient=null, id=76b3fe0b900d4841b51af801ee8e1a12)
2025-12-19 11:34:25.384 [clientInboundChannel-19] INFO  c.h.s.MessageController - === 私信發送調試 ===
2025-12-19 11:34:25.384 [clientInboundChannel-19] INFO  c.h.s.MessageController - 發送者ID: 67c2e5918b514065bbbf98a4dd15ff61
2025-12-19 11:34:25.384 [clientInboundChannel-19] INFO  c.h.s.MessageController - 接收者ID: 76b3fe0b900d4841b51af801ee8e1a12
2025-12-19 11:34:25.384 [clientInboundChannel-19] INFO  c.h.s.MessageController - 訊息內容: aaaa
2025-12-19 11:34:25.384 [clientInboundChannel-19] INFO  c.h.s.MessageController - 目標路徑: /user/76b3fe0b900d4841b51af801ee8e1a12/topic/privateMessage
2025-12-19 11:34:25.394 [clientInboundChannel-19] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/user/76b3fe0b900d4841b51af801ee8e1a12/topic/privateMessage session=null payload={"content":"用戶：67c2e5918b514065bbbf98a4dd15ff61發送的信息：aaaa"}
2025-12-19 11:34:25.398 [clientInboundChannel-19] TRACE o.s.m.s.u.UserDestinationMessageHandler - Translated /user/76b3fe0b900d4841b51af801ee8e1a12/topic/privateMessage -> [/topic/privateMessage-user30odobhk]
2025-12-19 11:34:25.399 [clientInboundChannel-19] DEBUG o.s.m.s.b.SimpleBrokerMessageHandler - Processing MESSAGE destination=/topic/privateMessage-user30odobhk session=null payload={"content":"用戶：67c2e5918b514065bbbf98a4dd15ff61發送的信息：aaaa"}
2025-12-19 11:34:25.399 [clientInboundChannel-19] INFO  c.h.s.MessageController - 私信已發送到目標用戶: 76b3fe0b900d4841b51af801ee8e1a12
2025-12-19 11:34:25.399 [clientInboundChannel-19] INFO  c.h.s.MessageController - === 私信處理完成 ===
2025-12-19 11:34:26.812 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:31.822 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:36.832 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:41.850 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:46.859 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:51.955 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:34:56.970 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:01.975 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:06.989 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:11.996 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:17.004 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:22.016 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:27.033 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:32.050 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:37.092 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:42.135 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:47.179 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:52.202 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:35:57.232 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:02.246 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:07.266 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:12.283 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:17.302 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:22.327 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:27.400 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:32.442 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:37.479 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:42.621 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:47.693 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:52.711 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:36:57.728 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:02.742 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:07.765 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:12.907 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:17.998 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:23.269 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:28.788 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:34.155 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:39.205 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:44.251 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:49.302 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:54.319 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:37:59.332 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:04.348 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:09.369 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:14.832 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:19.888 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:24.899 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:29.914 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:34.932 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:39.940 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:44.947 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:49.963 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:54.974 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:38:59.978 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:39:04.997 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:39:10.002 [pool-3-thread-2] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:39:15.019 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:39:20.029 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
2025-12-19 11:39:25.036 [pool-3-thread-1] ERROR o.s.d.r.l.RedisMessageListenerContainer - Connection failure occurred. Restarting subscription task after 5000 ms
